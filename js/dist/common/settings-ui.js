const F=!1;class P{constructor(e="unknown"){this.caller=J(e.toUpperCase(),15,".")}isDebug(){return F}warn(e){console.warn(`${this.caller}:`,e)}error(e){console.error(`${this.caller}:`,e)}}class V extends P{constructor(e){super(e)}log(e){console.log(`${this.caller}:`,e)}logEventLog(e,n,t){const r=[];for(let a=0;a<e.length;a++){const i={eventSource:this.getObjectKeyForValue(n,e[a].eventSource),eventType:this.getObjectKeyForValue(t,e[a].eventType),uId:e[a].uId,timeStamp:e[a].timeStamp};r.push(i)}this.log(r)}getObjectKeyForValue(e,n){return Object.keys(e).find(t=>e[t]===n)}}class Y extends P{constructor(e){super(e)}log(){}logEventLog(){}getObjectKeyForValue(){}}function v(e){return F===!0?new V(e):new Y(e)}function J(e,n,t){return e.length>n?e.slice(0,n):e.padEnd(n,t)}const s={keyboardShortcuts:{description:"Keyboard Shortcuts",values:[!0,!1],default:!0,valueStrings:["ON","OFF"]},masterVolume:{description:"Master Volume",values:[0,25,50,75,100],default:100,valueStrings:["0%","25%","50%","75%","100%"]},masterMute:{description:"Master Mute",values:[!0,!1],default:!1,valueStrings:["ON","OFF"]},autoPlay:{description:"Autoplay next track",values:[!0,!1],default:!0,valueStrings:["ON","OFF"]},autoCrossfade:{description:"Auto Crossfade to next track",values:[!0,!1],default:!1,valueStrings:["ON","OFF"]},autoCrossfadeLength:{description:"Auto Crossfade Length",values:[5,10,15,20,25,30],default:20,valueStrings:["5 sec","10 sec","15 sec","20 sec","25 sec","30 sec"]},autoCrossfadeCurve:{description:"Auto Crossfade Curve",values:[0,1],default:1,valueStrings:["EQUAL POWER","LINEAR"]},autoScroll:{description:"Autoscroll to next track",values:[!0,!1],default:!0,valueStrings:["ON","OFF"]},smoothScrolling:{description:"Smooth Scrolling to next track",values:[!0,!1],default:!0,valueStrings:["ON","OFF"]},autoExitFullscreen:{description:"Exit Fullscreen on next track",values:[!0,!1],default:!0,valueStrings:["ON","OFF"]},animateNowPlayingIcon:{description:"Animate Playing Track Icon",values:[!0,!1],default:!0,valueStrings:["ON","OFF"]},autoResumePlayback:{description:"Auto Resume Playback on focus",values:[!0,!1],default:!1,valueStrings:["ON","OFF"]},trackCrossfade:{description:"Track to Track Crossfade",values:[!0,!1],default:!0,valueStrings:["ON","OFF"]},trackCrossfadeLength:{description:"Track to Track Crossfade Length",values:[5,10,15,20,25,30],default:10,valueStrings:["5 sec","10 sec","15 sec","20 sec","25 sec","30 sec"]},trackCrossfadeCurve:{description:"Track to Track Crossfade Curve",values:[0,1],default:0,valueStrings:["EQUAL POWER","LINEAR"]},timeRemainingWarning:{description:"Time Remaining Warning",values:[!0,!1],default:!0,valueStrings:["ON","OFF"]},timeRemainingSeconds:{description:"Time Remaining Warning Seconds",values:[15,30,45,60],default:60,valueStrings:["15 sec","30 sec","45 sec","60 sec"]},autoExitFsOnWarning:{description:"Exit Fullscreen on Time Warning",values:[!0,!1],default:!0,valueStrings:["ON","OFF"]},keepMobileScreenOn:{description:"Keep Mobile Screen On when playing",values:[!0,!1],default:!1,valueStrings:["ON","OFF"]},trackTimesOnMobile:{description:"Show Track Times on mobile",values:[!0,!1],default:!1,valueStrings:["ON","OFF"]},trackThumbnailOnMobile:{description:"Show Track Thumbnail on mobile",values:[!0,!1],default:!0,valueStrings:["ON","OFF"]}},A={version:21,storageChangeSync:!1,user:{keyboardShortcuts:s.keyboardShortcuts.default,masterVolume:s.masterVolume.default,masterMute:s.masterMute.default,autoPlay:s.autoPlay.default,autoCrossfade:s.autoCrossfade.default,autoCrossfadeLength:s.autoCrossfadeLength.default,autoCrossfadeCurve:s.autoCrossfadeCurve.default,autoScroll:s.autoScroll.default,smoothScrolling:s.smoothScrolling.default,autoExitFullscreen:s.autoExitFullscreen.default,animateNowPlayingIcon:s.animateNowPlayingIcon.default,autoResumePlayback:s.autoResumePlayback.default,trackCrossfade:s.trackCrossfade.default,trackCrossfadeLength:s.trackCrossfadeLength.default,trackCrossfadeCurve:s.trackCrossfadeCurve.default,timeRemainingWarning:s.timeRemainingWarning.default,timeRemainingSeconds:s.timeRemainingSeconds.default,autoExitFsOnWarning:s.autoExitFsOnWarning.default,keepMobileScreenOn:s.keepMobileScreenOn.default,trackTimesOnMobile:s.trackTimesOnMobile.default,trackThumbnailOnMobile:s.trackThumbnailOnMobile.default,blurFocusBgChange:!1},priv:{continueAutoPlay:!1,showLeftArrowHint:!0,showRightArrowHint:!0,showDetailsHint:!0,showTrackImageHint:!0}},c={theme:{description:"Theme",values:["light","dark","auto"],default:"auto",valueStrings:["LIGHT","DARK","AUTO / SYSTEM"]},trackLayout:{description:"Track Layout",values:["list","2-column","3-column"],default:"3-column",valueStrings:["LIST","2 COLUMN","3 / 4 COLUMN"]},tracksPerPage:{description:"Tracks Per Page for Search &amp; Shuffle",values:[...Array(22).keys()].map(e=>e+3),default:12,valueStrings:[...Array(22).keys()].map(e=>`${e+3}`)},keyboardShortcuts:{description:"Keyboard Shortcuts",values:[!0,!1],default:!0,valueStrings:["ON","OFF"]}},x={version:6,storageChangeSync:!1,user:{theme:c.theme.default,trackLayout:c.trackLayout.default,tracksPerPage:c.tracksPerPage.default,keyboardShortcuts:c.keyboardShortcuts.default},priv:{banners:{showFrontpageIntro:!0,showPremiumIntro:!0,showPromoIntro:!0}}};const C=v("utils"),k={SITE_MIN_WIDTH_WIDE:1,SITE_MAX_WIDTH:2,SITE_MAX_WIDTH_MOBILE:3},Q=window.matchMedia(`(min-width: ${w("--site-min-width-wide")})`),X=window.matchMedia(`(max-width: ${w("--site-max-width")})`),z=window.matchMedia(`(max-width: ${w("--site-max-width-mobile")})`);function w(e){let n=getComputedStyle(document.documentElement).getPropertyValue(e);return n.length!==0?n=n.replace(/'|"/g,"").trim():C.error(`getCssPropString(${e}): Returned CSS property string is empty`),n}function Z(e){switch(e){case k.SITE_MIN_WIDTH_WIDE:return Q.matches;case k.SITE_MAX_WIDTH:return X.matches;case k.SITE_MAX_WIDTH_MOBILE:return z.matches}return!1}function M(e){const n=window.innerWidth-document.documentElement.clientWidth;document.body.style.overflow=e?"hidden":"",document.body.style.paddingRight=e?`${n}px`:"",document.getElementById("site-header").style.paddingRight=e?`${n}px`:""}const ue=(()=>{const e={id:"modal"},n=`
    <div id="${e.id}-dialog" tabindex="-1">
      <div class="${e.id}-container">
        <div class="${e.id}-header">
          <div class="${e.id}-title"></div>
          <div class="${e.id}-close-button"><span class="material-icons" title="Dismiss">close</span></div>
        </div>
        <div class="${e.id}-body"></div>
      </div>
    </div>
  `,t={overlay:null,container:null,body:null};let r=null;return{show:a};function a(o,d,u){C.log(`modal.show(): ${o}`),i(),r=u,m(d),t.container.querySelector(`.${e.id}-title`).innerHTML=o,t.overlay.classList.add("show"),t.overlay.addEventListener("keydown",b),t.overlay.focus(),M(!0)}function i(){t.container===null&&(document.body.insertAdjacentHTML("beforeend",n),t.overlay=document.getElementById(`${e.id}-dialog`),t.container=t.overlay.querySelector(`.${e.id}-container`),t.body=t.overlay.querySelector(`.${e.id}-body`),t.overlay.addEventListener("click",o=>{o.target===t.overlay&&p()}),t.overlay.addEventListener("animationend",()=>{t.overlay.classList.contains("hide")&&(t.overlay.className="",M(!1))}),t.overlay.querySelector(`.${e.id}-close-button`).addEventListener("click",p))}function m(o){let d="";o.forEach(u=>d+=`<div id="${u.id}" class="${e.id}-single-choice">${u.description}</div>`),t.body.innerHTML=d,o.forEach(u=>t.body.querySelector(`#${u.id}`).addEventListener("click",I))}function I(){p(),setTimeout(()=>r(this.id),150)}function b(o){o.stopPropagation(),o.key==="Escape"&&p()}function p(){t.overlay.removeEventListener("keydown",b),t.overlay.classList.replace("show","hide")}})(),y=(()=>{const e={id:"snackbar"},n=`
    <div id="${e.id}">
      <div class="${e.id}-container">
        <div class="${e.id}-message"></div>
        <div class="${e.id}-action-button"></div>
        <div class="${e.id}-close-button"><span class="material-icons" title="Dismiss">close</span></div>
      </div>
    </div>
  `,t={snackbar:null,actionButton:null,closeButton:null};let r=null,a=null,i=-1,m=-1;return{show:I};function I(d,u=5,_=null,$=null,j=null){C.log(`snackbar.show(): ${d} (${u} sec)`),p(),o(),t.snackbar.querySelector(`.${e.id}-message`).innerHTML=d,t.snackbar.classList.add("show"),t.actionButton.style.display="none",a=j,_!==null&&$!==null?(r=$,t.actionButton.style.display="block",t.actionButton.textContent=_,t.actionButton.addEventListener("click",b)):Z(k.SITE_MAX_WIDTH_MOBILE)?t.closeButton.style.paddingLeft="10px":t.closeButton.style.paddingLeft="20px",u!==0&&(i=setTimeout(()=>{t.snackbar.classList.add("hide"),m=setTimeout(()=>{t.snackbar.className="",a!==null&&a()},450)},u*1e3))}function b(){r(),o(!0)}function p(){t.snackbar===null&&(document.body.insertAdjacentHTML("beforeend",n),t.snackbar=document.getElementById(e.id),t.actionButton=t.snackbar.querySelector(`.${e.id}-action-button`),t.closeButton=t.snackbar.querySelector(`.${e.id}-close-button`),t.closeButton.addEventListener("click",()=>{a!==null&&a(),o(!0)}))}function o(d=!1){i!==-1&&(clearTimeout(i),i=-1),m!==-1&&(clearTimeout(m),m=-1),t.actionButton.removeEventListener("click",b),d&&t.snackbar.classList.remove("show")}})();const E=v("storage");const g={UF_PLAYBACK_SETTINGS:"UF_PLAYBACK_SETTINGS",UF_SITE_SETTINGS:"UF_SITE_SETTINGS",UF_SITE_THEME:"UF_SITE_THEME",UF_TRACK_LAYOUT:"UF_TRACK_LAYOUT",UF_TRACKS_PER_PAGE:"UF_TRACKS_PER_PAGE"};function U(e,n="/"){document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=${n}`}function L(e,n=null,t=!0){E.log(`readJson(): ${e} - ${n} - ${t}`);const r=localStorage.getItem(e);let a=null;if(r===null)return t&&n!==null&&T(e,n),n;try{a=JSON.parse(r)}catch(i){E.error(i)}return a}function T(e,n){E.log(`writeJson(): ${e} - ${n}`);try{localStorage.setItem(e,JSON.stringify(n))}catch(t){E.error(t)}}const R=v("settings");let f=null,S=null;const l={settingsContainerId:"settings-container",settingsSaveResetId:"settings-save-reset",settingsUpdatedEvent:"settingsUpdated",playbackIdPrefix:"playback",siteIdPrefix:"site"},h={settingsContainer:null},ee=`<h3>An error occurred while reading Playback and Site settings</h3>
  <p>This can be caused by several issues, but most likely it happened because of corrupt or malformed JSON data in the browsers Local Storage.</p>
  <p>Clearing all settings stored locally in the browser will probably fix the problem, click on the button below to do that.
  <b>Note:</b> All Playback and Site settings will be reset to default values.</p>
  <div class="settings-clear"><b>Clear All Settings</b></div>
  <p>If that does not work, another possible fix is to clear all cached data stored in the browser, the following links contain more information about how to do that for
  <a href="https://support.google.com/accounts/answer/32050">Chrome</a> and
  <a href="https://support.mozilla.org/en-US/kb/clear-cookies-and-site-data-firefox">Firefox</a>.</p>`;document.addEventListener("DOMContentLoaded",()=>{if(R.log("DOMContentLoaded"),h.settingsContainer=document.getElementById(l.settingsContainerId),h.settingsContainer!==null){if(document.URL.includes("?clear=true")){N();return}B(),f!==null&&S!==null?(W(f.user,s),W(S.user,c),te(),h.settingsContainer.style.opacity=1,document.querySelector(`#${l.settingsSaveResetId} .settings-save`).addEventListener("click",ne),document.querySelector(`#${l.settingsSaveResetId} .settings-reset`).addEventListener("click",se)):N()}else R.error(`Unable to getElementById() for '#${l.settingsContainerId}'`)});function N(){document.getElementById(l.settingsSaveResetId).style.display="none",h.settingsContainer.insertAdjacentHTML("afterbegin",ee),h.settingsContainer.style.opacity=1,document.querySelector(`#${l.settingsContainerId} .settings-clear`).addEventListener("click",()=>{localStorage.removeItem(g.UF_PLAYBACK_SETTINGS),localStorage.removeItem(g.UF_SITE_SETTINGS),U(g.UF_TRACKS_PER_PAGE),B(),f!==null&&S!==null?y.show("All settings have been cleared",5,"Reload",()=>{window.location.href="/settings/"},()=>{window.location.href="/settings/"}):y.show("Sorry, unable to clear all settings",5)})}function B(){f=L(g.UF_PLAYBACK_SETTINGS,A),S=L(g.UF_SITE_SETTINGS,x)}function H(){T(g.UF_PLAYBACK_SETTINGS,f),T(g.UF_SITE_SETTINGS,S),document.dispatchEvent(new Event(l.settingsUpdatedEvent))}function D(e,n){Object.keys(e).forEach(t=>{t in n&&(e[t]=n[t].default)})}function W(e,n){Object.entries(e).forEach(([t,r])=>{t in n&&(n[t].current=O(n[t],r),n[t].current===-1&&(n[t].current=O(n[t],n[t].default)))})}function G(e,n,t){Object.keys(e).forEach(r=>{if(r in n){const a=n[r].valueStrings[O(n[r],e[r])];document.getElementById(`${t}:${r}`).querySelector(".value-string").textContent=a}})}function O(e,n){return e.values.findIndex(t=>t===n)}function te(){let e=`
<h3>Playback</h3>
<table class="playback-settings">
<tbody>`;Object.entries(s).forEach(n=>e+=K(l.playbackIdPrefix,n)),e+=`
</tbody>
</table>
<h3>Site</h3>
<table class="site-settings">
<tbody>`,Object.entries(c).forEach(n=>e+=K(l.siteIdPrefix,n)),e+=`
</tbody>
</table>
`,h.settingsContainer.insertAdjacentHTML("afterbegin",e),Object.keys(s).forEach(n=>document.getElementById(`${l.playbackIdPrefix}:${n}`).addEventListener("click",re)),Object.keys(c).forEach(n=>document.getElementById(`${l.siteIdPrefix}:${n}`).addEventListener("click",ae))}function K(e,n){const t=`
<tr id="${e}:${n[0]}" class="settings-entry">
      <td class="description">${n[1].description}</td>
      <td class="value-string">${n[1].valueStrings[n[1].current]}</td>
    </tr>`;return t}function re(e){q(e,f.user,s)}function ae(e){q(e,S.user,c)}function q(e,n,t){const r=e.target.parentElement,a=r.id.split(":")[1],i=t[a];i.current=i.current+1<i.values.length?i.current+1:i.current=0,n[a]=i.values[i.current],r.querySelector(".value-string").textContent=i.valueStrings[i.current]}function ne(){H(),y.show("Settings saved successfully",3)}function se(){D(f.user,s),G(f.user,s,l.playbackIdPrefix),D(S.user,c),G(S.user,c,l.siteIdPrefix),y.show("All settings reset",5,"Undo",()=>location.reload(),()=>H())}
//# sourceMappingURL=settings-ui.js.map
