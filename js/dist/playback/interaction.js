import{a as jt,b as Hn,c as An,d as nt,e as kn,g as Ie,h as O,j as se,k as qt,l as Gt,m as K,n as A,o as In}from"../chunk.OGSLXYJH.js";function ze(e,t){let n=t.mediaUrl+" | "+t.mediaTitle;console.log(`DEBUGLOGGER.........: logErrorOnServer(): ${e} - ${n}`),gtag("event",n,{event_category:e,event_label:"Ultrafunk Client Error"})}var Oe=A("eventlogger"),d={UNKNOWN:1e3,KEYBOARD:100,MOUSE:110,YOUTUBE:1,SOUNDCLOUD:2,ULTRAFUNK:50},g={UNKNOWN:-2e3,KEY_ARROW_LEFT:80,KEY_ARROW_RIGHT:81,MOUSE_CLICK:82,STATE_ERROR:-5,STATE_UNSTARTED:-1,STATE_ENDED:0,STATE_PLAYING:1,STATE_PAUSED:2,STATE_BUFFERING:3,STATE_CUED:5,RESUME_AUTOPLAY:50,PLAYER_ERROR:60,CROSSFADE_START:70},wt={eventSource:d.UNKNOWN,eventType:g.UNKNOWN,uId:null,timeStamp:0},Re=class{constructor(t=10){this.log=[],this.maxEntries=t,this.lastPos=0,this.matchCount=0}add(t,n,a,s=Date.now()){let i=Object.create(wt);i.eventSource=t,i.eventType=n,i.uId=a,i.timeStamp=s,this.log.length<this.maxEntries?this.log.push(i):(this.log.shift(),this.log.push(i))}clear(){this.log=[]}initMatch(){this.lastPos=this.log.length-1,this.matchCount=0}matchesEvent(t,n,a,s=null){this.log[this.lastPos-t].eventSource===n&&this.log[this.lastPos-t].eventType===a&&this.log[this.lastPos-t].uId===s&&this.matchCount++}matchesDelta(t,n){this.log[this.lastPos].timeStamp-this.log[this.lastPos-t].timeStamp<=n&&this.matchCount++}isPatternMatch(t,n){return this.matchCount===t?(Oe.log(`MATCH for: ${n}`),Oe.logEventLog(this.log,d,g),!0):!1}},_e=class extends Re{constructor(t){super(t)}doubleClicked(t,n,a){return this.initMatch(),this.lastPos>=1&&(this.matchesEvent(1,t,n),this.matchesEvent(0,t,n),this.matchesDelta(1,a)),this.isPatternMatch(3,`${Oe.getObjectKeyForValue(d,t)} Double Clicked`)}},Me=class extends Re{constructor(t){super(t)}ytAutoPlayBlocked(t,n){return this.initMatch(),this.lastPos>=3&&(this.matchesEvent(3,d.ULTRAFUNK,g.RESUME_AUTOPLAY,null),this.matchesEvent(2,d.YOUTUBE,g.STATE_UNSTARTED,t),this.matchesEvent(1,d.YOUTUBE,g.STATE_BUFFERING,t),this.matchesEvent(0,d.YOUTUBE,g.STATE_UNSTARTED,t),this.matchesDelta(3,n)),this.isPatternMatch(5,"YouTube AutoPlay Blocked")}scAutoPlayBlocked(t,n){return this.initMatch(),this.lastPos>=3&&(this.matchesEvent(3,d.ULTRAFUNK,g.RESUME_AUTOPLAY,null),this.matchesEvent(2,d.SOUNDCLOUD,g.STATE_PLAYING,t),this.matchesEvent(1,d.SOUNDCLOUD,g.STATE_PAUSED,t),this.matchesEvent(0,d.SOUNDCLOUD,g.STATE_PAUSED,t),this.matchesDelta(3,n)),this.isPatternMatch(5,"SoundCloud AutoPlay Blocked")}scWidgetPlayBlocked(t,n){return this.initMatch(),this.lastPos>=2&&(this.matchesEvent(2,d.SOUNDCLOUD,g.STATE_PLAYING,t),this.matchesEvent(1,d.SOUNDCLOUD,g.STATE_PAUSED,t),this.matchesEvent(0,d.SOUNDCLOUD,g.STATE_PAUSED,t),this.matchesDelta(2,n)),this.isPatternMatch(4,"SoundCloud WidgetPlay Blocked")}scPlayDoubleTrigger(t,n){return this.initMatch(),this.lastPos>=2&&(this.matchesEvent(2,d.ULTRAFUNK,g.CROSSFADE_START,null),this.matchesEvent(1,d.SOUNDCLOUD,g.STATE_PLAYING,t),this.matchesEvent(0,d.SOUNDCLOUD,g.STATE_PLAYING,t),this.matchesDelta(1,n)),this.isPatternMatch(4,"SoundCloud Play Double Trigger")}},re=A("crossfade"),H={MIN:0,MAX:100},F={NONE:-1,AUTO:0,TRACK:1},de={NONE:-1,EQUAL_POWER:0,LINEAR:1},xe={updateCrossfadeInterval:50},Ze=(e,t)=>{let n=e,a=t,s=!1,i=-1,c=null,m=null,E=0,S=0,T=F.NONE,L=de.NONE,I=0;return{isFading(){return s},init:De,start:ve,stop:p,mute:q};function De(D,_=0,C=null){return s===!1&&Ue(C)===!0?(re.log(`init() - crossfadeType: ${re.getObjectKeyForValue(F,D)} - crossfadeCurve: ${re.getObjectKeyForValue(de,_)} - fadeInUid: ${C}`),s=!0,S=n.masterVolume,T=D,L=_,m.setVolume(0),C===null?a.nextTrack(!0):a.jumpToTrack(a.trackFromUid(C),!0,!1),{fadeOutPlayer:a.indexMap.get(c.getUid()),fadeInPlayer:a.indexMap.get(m.getUid())}):null}function ve(D){s&&c.getPosition(_=>{I=(_+xe.updateCrossfadeInterval)/1e3;let C=c.getDuration()-I,$=C-xe.updateCrossfadeInterval/1e3;T===F.AUTO?E=$:T===F.TRACK&&(E=C>n.trackCrossfadeLength?n.trackCrossfadeLength:$),re.log(`start() - fadeStartTime: ${I.toFixed(2)} sec - timeRemaining: ${C.toFixed(2)} sec - fadeLength: ${E.toFixed(2)} sec - fadeInUid: ${D}`),i=setInterval(L===de.EQUAL_POWER?Mt:xt,xe.updateCrossfadeInterval)})}function p(){re.log(`stop() - isFading: ${s}`),s&&(i!==-1&&(clearInterval(i),i=-1),c!==null&&(c.pause(),c.seekTo(0),setTimeout(()=>{c.setVolume(n.masterVolume),c=null},200)),m!==null&&setTimeout(()=>{m.setVolume(n.masterVolume),m=null},200),s=!1,E=0,S=0,T=F.NONE,L=de.NONE,I=0)}function q(D){c!==null&&c.mute(D)}function Ue(D){return c=a.current,m=D===null?a.next:a.playerFromUid(D),!!(c.getPlayable()&&m.getPlayable())}function Mt(){c.getPosition(D=>{let _=D/1e3-I,C=_>=0?_:0,$=S-S*(C/E),Ne=$>=H.MIN?$:H.MIN,Bt=Math.round(Math.sqrt(S*Ne)),Qe=Math.round(Math.sqrt(S*(S-Ne)));C>=E&&Ne<=H.MIN&&Qe>=S?p():(c.setVolume(Bt),m.setVolume(Qe))})}function xt(){c.getPosition(D=>{let _=D/1e3-I,C=Math.round(S*(_/E)),$=S-C;_>E&&$<H.MIN&&C>S?p():(c.setVolume($),m.setVolume(C))})}},J=A("mediaplayers"),Yt=/\s{1,}[–·-]\s{1,}/i,Be=class{constructor(t,n,a){this.postId=t,this.iframeId=n,this.embeddedPlayer=a,this.playable=!0,this.duration=0,this.artist=null,this.title=null,this.thumbnailSrc=null,this.thumbnail=new Image,this.thumbnail.decoding="async"}getPostId(){return this.postId}getIframeId(){return this.iframeId}getUid(){return this.iframeId}getEmbeddedPlayer(){return this.embeddedPlayer}getPlayable(){return this.playable}setPlayable(t){this.playable=t}getDuration(){return this.duration}setDuration(t){this.duration=t}getArtist(){return this.artist}setArtist(t){this.artist=t}getTitle(){return this.title}setTitle(t){this.title=t}getThumbnailSrc(){return this.thumbnailSrc}seekTo(t){this.embeddedPlayer.seekTo(t)}setVolume(t){this.embeddedPlayer.setVolume(t)}setThumbnail(t){this.thumbnailSrc=t,this.thumbnail.src=t}},we=class extends Be{constructor(t,n,a,s){super(t,n,a);this.previousPlayerState=-1,this.setThumbnail(s)}setThumbnail(t){let n=new URL(decodeURIComponent(t)),a=n.pathname.split("/embed/");a.length===2&&a[1].length===11?super.setThumbnail(`https://img.youtube.com/vi/${a[1]}/mqdefault.jpg`):J.warn(`MediaPlayer.YouTube.setThumbnail() failed for: ${this.iframeId}`)}pause(){this.embeddedPlayer.pauseVideo()}stop(){this.embeddedPlayer.stopVideo()}isPlaybackError(t){return J.log(`YouTube.play() - current playerState: ${this.embeddedPlayer.getPlayerState()} - previous playerState: ${this.previousPlayerState} - playable: ${this.playable}`),this.embeddedPlayer.getPlayerState()===-1&&this.previousPlayerState===-1&&this.playable===!0?(J.warn(`MediaPlayer.YouTube.play() - Unable to play track: ${this.getArtist()} - "${this.getTitle()}" with videoId: ${this.embeddedPlayer.getVideoData().video_id} -- No YouTube API error given!`),this.playable=!1,t(this,this.embeddedPlayer.getVideoUrl()),!0):(this.previousPlayerState=this.embeddedPlayer.getPlayerState(),!1)}play(t){this.isPlaybackError(t)===!1&&(this.playable===!0?this.embeddedPlayer.playVideo():t(this,this.embeddedPlayer.getVideoUrl()))}getVolume(t){t(this.embeddedPlayer.getVolume())}mute(t){t?this.embeddedPlayer.mute():this.embeddedPlayer.unMute()}getPosition(t){t(this.embeddedPlayer.getCurrentTime()*1e3,this.duration)}},ge=class extends Be{constructor(t,n,a,s){super(t,n,a);this.soundId=this.getSoundId(s),this.volume=H.MAX,this.muted=!1}getSoundId(t){if(t!==void 0){let n=new URL(decodeURIComponent(t)),a=n.searchParams.get("url");if(a!==null){let s=a.split("/"),i="tracks".toUpperCase();for(let c=0;c<s.length;c++)if(s[c].toUpperCase()===i)return parseInt(s[c+1])}}return J.error(`MediaPlayer.SoundCloud.getSoundId() failed for: ${this.iframeId}`),null}setThumbnail(){this.embeddedPlayer.getCurrentSound(t=>{let n=t.artwork_url!==null?t.artwork_url:t.user.avatar_url;n!=null&&super.setThumbnail(n)})}getUid(){return this.soundId}pause(){this.embeddedPlayer.pause()}play(t){this.playable===!0?this.embeddedPlayer.getCurrentSound(n=>{n.playable===!0?this.embeddedPlayer.play():t(this,n.permalink_url)}):t(this,"https://soundcloud.com")}stop(){this.pause(),super.seekTo(0)}seekTo(t){super.seekTo(t*1e3)}getVolume(t){this.embeddedPlayer.getVolume(n=>t(n))}setVolume(t){t!==0&&(this.volume=t),(this.muted===!1||t===0)&&super.setVolume(t)}mute(t){this.muted=!!t,t?this.setVolume(0):this.setVolume(this.volume)}getPosition(t){this.embeddedPlayer.getPosition(n=>t(n,this.duration))}};function et(e,t){if(t!==null&&t.length>0){let n=t.match(Yt);n!==null?(e.artist=t.slice(0,n.index),e.title=t.slice(n.index+n[0].length)):e.artist=t}}var tt=()=>{let e=null,t=null,n=null,a=[],s=new Map,i=0;return{indexMap:s,init:c,get crossfade(){return n},add:m,getPlayerIndex(){return i},setPlayerIndex(p){i=p},get current(){return a[i]},get next(){return a[i+1]},getNumTracks(){return a.length},getCurrentTrack(){return i+1},playerFromUid(p){return a[s.get(p)]},trackFromUid(p){return s.get(p)+1},isCurrent(p){return p===this.current.getUid()},uIdFromIframeId:E,stop:S,mute:T,getStatus:L,prevTrack:I,nextTrack:De,jumpToTrack:ve};function c(p,q){J.log("init()"),e=p,t=q,n=Ze(p,this)}function m(p){J.log(p),a.push(p),s.set(p.getUid(),a.length-1)}function E(p){return a.find(q=>q.iframeId===p).getUid()}function S(){this.current.stop(),n.stop()}function T(){this.current.mute(e.masterMute),n.mute(e.masterMute)}function L(){return{currentTrack:this.getCurrentTrack(),numTracks:this.getNumTracks(),artist:this.current.getArtist(),title:this.current.getTitle(),thumbnailSrc:this.current.getThumbnailSrc()}}function I(p){return i>0?(i--,t(p),!0):!1}function De(p){return i++,i<this.getNumTracks()?(t(p),!0):!1}function ve(p,q,Ue=!0){return p>0&&p<=this.getNumTracks()?(i=p-1,t(q,Ue),!0):!1}};function Ye(e,t){Hn.log(`addSettingsObserver() for property: ${e}`),e in nt===!1&&(nt[e]=[]),nt[e].push(t)}var fe=A("playback-controls"),X={},ae={progressControlsId:"progress-controls",playbackControlsId:"playback-controls",entryMetaControlsSelector:".entry-meta-controls .crossfade-control"},u={DISABLED:"state-disabled",ENABLED:"state-enabled",PLAY:"state-play",PAUSE:"state-pause"},r={progressSeek:{element:null,state:u.DISABLED,click:null},progressBar:{element:null,state:u.DISABLED},details:{element:null,state:u.DISABLED,artistElement:null,titleElement:null},thumbnail:{element:null,state:u.DISABLED,img:null},timer:{element:null,state:u.DISABLED,positionElement:null,durationElement:null,positionSeconds:-1,durationSeconds:-1},prevTrack:{element:null,state:u.DISABLED},playPause:{element:null,state:u.DISABLED,iconElement:null},nextTrack:{element:null,state:u.DISABLED},shuffle:{element:null,state:u.DISABLED},mute:{element:null,state:u.DISABLED,iconElement:null},trackCrossfade:{elements:null,click:null}};function rt(e,t,n){fe.log("init()"),X=e;let a=document.getElementById(ae.progressControlsId);a!==null?(r.progressSeek.element=a.querySelector(".seek-control"),r.progressSeek.click=t,r.progressBar.element=a.querySelector(".bar-control")):fe.error(`playbackControls.init(): Unable to getElementById() for '#${ae.progressControlsId}'`);let s=document.getElementById(ae.playbackControlsId);s!==null?(r.details.element=s.querySelector(".details-control"),r.details.artistElement=r.details.element.querySelector(".details-artist"),r.details.titleElement=r.details.element.querySelector(".details-title"),r.thumbnail.element=s.querySelector(".thumbnail-control"),r.thumbnail.img=r.thumbnail.element.querySelector("img"),r.timer.element=s.querySelector(".timer-control"),r.timer.positionElement=r.timer.element.querySelector(".timer-position"),r.timer.durationElement=r.timer.element.querySelector(".timer-duration"),r.prevTrack.element=s.querySelector(".prev-control"),r.playPause.element=s.querySelector(".play-pause-control"),r.playPause.iconElement=r.playPause.element.querySelector("i"),r.nextTrack.element=s.querySelector(".next-control"),r.shuffle.element=s.querySelector(".shuffle-control"),r.mute.element=s.querySelector(".mute-control"),r.mute.iconElement=r.mute.element.querySelector("i")):fe.error(`playbackControls.init(): Unable to getElementById() for '#${ae.playbackControlsId}'`),r.trackCrossfade.elements=document.querySelectorAll(ae.entryMetaControlsSelector),r.trackCrossfade.elements.length!==0&&(r.trackCrossfade.click=n)}function ot(e,t,n,a,s){fe.log("ready()"),k(r.progressSeek,u.ENABLED),r.progressSeek.element.addEventListener("click",Vt),k(r.progressBar,u.ENABLED),k(r.details,u.ENABLED),k(r.thumbnail,u.ENABLED),k(r.timer,u.ENABLED),X.trackThumbnailOnMobile&&r.thumbnail.element.classList.add("show-on-mobile"),X.trackTimesOnMobile&&r.timer.element.classList.add("show-on-mobile"),k(r.prevTrack,u.DISABLED),r.prevTrack.element.addEventListener("click",e),k(r.playPause,u.PLAY),r.playPause.element.addEventListener("click",t),k(r.nextTrack,s>1?u.ENABLED:u.DISABLED),r.nextTrack.element.addEventListener("click",n),k(r.shuffle,u.ENABLED),k(r.mute,u.ENABLED),r.mute.element.addEventListener("click",a),at(),r.trackCrossfade.elements.length>1&&r.trackCrossfade.elements.forEach(i=>i.addEventListener("click",$t)),Ye("autoPlay",Ft),Ye("masterMute",at)}function k(e,t=u.DISABLED){K(e.element,e.state,t),e.state=t,t===u.PLAY?r.playPause.iconElement.textContent="play_circle_filled":t===u.PAUSE&&(r.playPause.iconElement.textContent="pause_circle_filled")}function st(e,t){t===0?Ve(0):Ve(e/(t*1e3))}function oe(e){Ve(e/100)}function Ve(e){r.progressBar.element.style.transform=`scaleX(${e})`}function Vt(e){if(r.timer.durationSeconds>0){let t=e.clientX/document.documentElement.clientWidth*100,n=Math.round(r.timer.durationSeconds*t/100);r.progressSeek.click(n),M()===!1&&(oe(t),me(n,r.timer.durationSeconds))}}function $e(e){r.details.artistElement.textContent=e.artist||"",r.details.titleElement.textContent=e.title||"",Kt(e.thumbnailSrc),me(-1,-1)}function Kt(e){e!==r.thumbnail.img.src&&(r.thumbnail.element.classList.add("loading"),e!==null?r.thumbnail.img.src=e:r.thumbnail.img.src="/wp-content/themes/ultrafunk/inc/img/photo_filled_grey.png",r.thumbnail.img.decode().then(()=>{r.thumbnail.element.classList.remove("loading")}))}function me(e,t){e!==-1&&r.timer.positionSeconds!==e?(r.timer.positionSeconds=e,X.autoPlay===!1&&(e=t-e),Ee(r.timer.positionElement,e)):e===-1&&r.timer.positionSeconds===-1&&(r.timer.positionElement.textContent="00:00"),t!==-1&&r.timer.durationSeconds!==t?(r.timer.durationSeconds=t,Ee(r.timer.durationElement,t)):t===-1&&r.timer.durationSeconds===-1&&(r.timer.durationElement.textContent="00:00")}function Ee(e,t){let n=new Date(t*1e3).toISOString();e.textContent=t>60*60?n.substr(11,8):n.substr(14,5)}function lt(){r.timer.positionElement.textContent="00:00",r.timer.durationElement.textContent="00:00"}function M(){return r.playPause.state===u.PAUSE}function Fe(e){lt(),$e(e),M()===!1&&e.currentTrack<=1&&k(r.prevTrack,u.DISABLED),e.currentTrack<e.numTracks&&k(r.nextTrack,u.ENABLED)}function Ke(e){k(r.playPause,u.PAUSE),k(r.prevTrack,u.ENABLED),$e(e),it(!0,e.currentTrack)}function j(){k(r.playPause,u.PLAY),it(!1)}function pe(e){e?r.playPause.element.classList.toggle("time-remaining-warning"):r.playPause.element.classList.remove("time-remaining-warning")}function ye(e){lt(),$e(e),k(r.prevTrack,u.ENABLED),e.currentTrack>=e.numTracks&&k(r.nextTrack,u.DISABLED)}function at(){r.mute.iconElement.textContent=X.masterMute?"volume_off":"volume_up"}function $t(e){if(M()){let t=e.target.closest("article").querySelector("iframe");t!==null&&r.trackCrossfade.click(t.id)}}function it(e,t=-1){r.trackCrossfade.elements.forEach((n,a)=>{t===a+1?K(n,e?u.ENABLED:u.DISABLED,e?u.DISABLED:u.ENABLED):K(n,e?u.DISABLED:u.ENABLED,e?u.ENABLED:u.DISABLED)})}function Ft(){M()===!1&&r.timer.positionSeconds!==-1&&r.timer.durationSeconds!==-1&&(Ee(r.timer.positionElement,X.autoPlay?r.timer.positionSeconds:r.timer.durationSeconds-r.timer.positionSeconds),Ee(r.timer.durationElement,r.timer.durationSeconds))}var le=A("playback-events"),G={},je={nowPlayingIconsSelector:"h2.entry-title"},Te={nowPlayingIcons:null,snackbarId:0},l={LOADING:"loading",READY:"ready",MEDIA_PLAYING:"mediaPlaying",MEDIA_PAUSED:"mediaPaused",MEDIA_ENDED:"mediaEnded",MEDIA_TIME_REMAINING:"mediaTimeRemaining",MEDIA_SHOW:"mediaShow",MEDIA_UNAVAILABLE:"mediaUnavailable",CONTINUE_AUTOPLAY:"continueAutoplay",RESUME_AUTOPLAY:"resumeAutoplay",AUTOPLAY_BLOCKED:"autoplayBlocked",PLAYBACK_BLOCKED:"playbackBlocked"},Ge={[l.LOADING]:[Wt],[l.READY]:[Ht],[l.MEDIA_PLAYING]:[Jt],[l.MEDIA_PAUSED]:[Xt],[l.MEDIA_ENDED]:[ut],[l.MEDIA_TIME_REMAINING]:[Qt],[l.MEDIA_SHOW]:[zt],[l.CONTINUE_AUTOPLAY]:[Zt],[l.RESUME_AUTOPLAY]:[en],[l.AUTOPLAY_BLOCKED]:[tn],[l.PLAYBACK_BLOCKED]:[nn],[l.MEDIA_UNAVAILABLE]:[rn]};function ct(e){le.log("init()"),G=e,Te.nowPlayingIcons=document.querySelectorAll(je.nowPlayingIconsSelector)}function he(e,t){e in Ge&&Ge[e].push(t)}function v(e,t=null,n=null){Ge[e].forEach(a=>{a({event:e,data:t,callback:n})})}function Wt(e){oe(e.data.loadingPercent)}function Ht(e){x(e),oe(0)}function Jt(e){if(x(e),qt(Te.snackbarId),e.data.numTracks>1){let t=document.querySelector(`#${e.data.postId} ${je.nowPlayingIconsSelector}`);dt(t),K(t,"playing-paused","now-playing-icon"),G.user.animateNowPlayingIcon&&t.classList.add("playing-animate")}}function Xt(e){x(e),e.data.numTracks>1&&document.querySelector(`#${e.data.postId} ${je.nowPlayingIconsSelector}`).classList.add("playing-paused")}function ut(e){x(e),oe(0),e!==null&&e.data.numTracks>1&&dt()}function Qt(){}function zt(e){x(e),ut(null),e.data.scrollToMedia&&qe.id(e.data.postId)}function Zt(e){x(e),Q(navigationVars.nextUrl,!0)}function en(e){x(e),le.log(`RESUME_AUTOPLAY: ${G.priv.continueAutoPlay}`),G.priv.continueAutoPlay&&(G.priv.continueAutoPlay=!1,e.callback.resumeAutoPlay())}function tn(e){x(e),Te.snackbarId=O("Autoplay blocked, Play to continue...",0,"play",()=>{e.data.isPlaying===!1&&e.callback.togglePlayPause()})}function nn(e){x(e),O("Unable to play track, skipping to next...",5),We(e,5)}function rn(e){x(e),an(e.data.postId)?(O("YouTube Premium track, skipping...",5,"help",()=>{window.location.href="/channel/premium/"}),We(e,5)):(O("Unable to play track, skipping to next...",5),ze("EVENT_MEDIA_UNAVAILABLE",e.data),We(e,5))}function x(e=null){le.isDebug()&&e!==null&&le.log(e)}function dt(e){Te.nowPlayingIcons.forEach(t=>{t!==e&&t.classList.remove("now-playing-icon","playing-animate","playing-paused")})}function We(e,t=5){setTimeout(()=>{e.data.currentTrack<e.data.numTracks?e.callback.skipToTrack(e.data.currentTrack+1,!0):navigationVars.nextUrl!==null&&Q(navigationVars.nextUrl,!0)},t*1e3+250)}function an(e){let t=document.getElementById(e);return t!==null?t.classList.contains("category-premium"):!1}function Q(e,t=!1){le.log(`navigateTo(): ${e} - continueAutoPlay: ${t}`),e!==null&&e.length>0&&(t&&(G.priv.continueAutoPlay=!0),window.location.href=e)}var qe=(()=>{let e=se("--site-header-down"),t=se("--site-header-down-mobile"),n=se("--site-header-up"),a=se("--site-header-up-mobile");return{id:s};function s(m){if(G.user.autoScroll){let E=Math.round(window.scrollY+document.getElementById(m).getBoundingClientRect().top),S=Math.round(window.pageYOffset),T=i(E>S);S+T+c()>E&&(T=i(!1)),window.scroll({top:E-(T+c()),left:0,behavior:G.user.smoothScrolling?"smooth":"auto"})}}function i(m){let E=Gt(jt.SITE_MAX_WIDTH_MOBILE);return m?E?t:e:E?a:n}function c(){return se("--site-content-margin-top")-1}})(),b=A("embedded-players"),B=new Me(10),ie=null,f=null,R=null,Y=null,U=null,He=0,gt=1,W={youTubeIframeIdRegEx:/youtube-uid/i,soundCloudIframeIdRegEx:/soundcloud-uid/i,entriesSelector:"article",trackTitleData:"data-entry-track-title",maxPlaybackStartDelay:3};function ft(e,t,n,a){ie=e,f=t,R=n,Y=a,on(),sn()}function mt(e){let t=0;return document.querySelectorAll("iframe").forEach(n=>{(W.youTubeIframeIdRegEx.test(n.id)||W.soundCloudIframeIdRegEx.test(n.id))&&t++}),b.log(`countPlayers(): ${t}`),He=t+3,U=e,t}function be(){return{loadingPercent:100*(gt++/He)}}function Et(){gt>=He?U(l.READY):U(l.LOADING,be())}function pn(){let e=document.querySelectorAll(W.entriesSelector);e.forEach(t=>{let n=t.id,a=t.getAttribute(W.trackTitleData),s=t.querySelectorAll("iframe");s.forEach(i=>{let c=i.id,m={};if(W.youTubeIframeIdRegEx.test(c)){let E=new YT.Player(c,{events:{onReady:ln,onStateChange:un,onError:cn}});m=new we(n,c,E,i.src)}else if(W.soundCloudIframeIdRegEx.test(c)){let E=SC.Widget(c);m=new ge(n,c,E,i.src),E.bind(SC.Widget.Events.READY,()=>{m.setThumbnail(),dn()}),E.bind(SC.Widget.Events.PLAY,gn),E.bind(SC.Widget.Events.PAUSE,fn),E.bind(SC.Widget.Events.FINISH,mn),E.bind(SC.Widget.Events.ERROR,En)}et(m,a),f.add(m)})})}function Pe(e,t){b.log("onPlayerError()"),b.log(e);let n=e instanceof ge?d.SOUNDCLOUD:d.YOUTUBE;f.isCurrent(e.getUid())===!1&&f.stop(),B.add(n,g.PLAYER_ERROR,e.getUid()),U(l.MEDIA_UNAVAILABLE,yn(e,t))}function yn(e,t){let n=e.getArtist()||"N/A",a=e.getTitle()||"N/A";return{currentTrack:f.trackFromUid(e.getUid()),numTracks:f.getNumTracks(),postId:e.getPostId(),mediaTitle:`${n} - ${a}`,mediaUrl:t}}function on(){b.log("initYouTubeAPI()"),U(l.LOADING,be());let e=document.createElement("script");e.id="youtube-iframe-api",e.src="https://www.youtube.com/iframe_api";let t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}window.onYouTubeIframeAPIReady=function(){b.log("onYouTubeIframeAPIReady()"),U(l.LOADING,be()),pn()};function ln(){b.log("onYouTubePlayerReady()"),Et()}function un(e){B.add(d.YOUTUBE,e.data,e.target.f.id);switch(e.data){case YT.PlayerState.BUFFERING:if(b.log(`onYouTubePlayerStateChange: BUFFERING (uID: ${e.target.f.id})`),f.crossfade.isFading()===!1){let t=f.playerFromUid(e.target.f.id);t.mute(ie.masterMute),t.setVolume(ie.masterVolume)}break;case YT.PlayerState.CUED:b.log(`onYouTubePlayerStateChange: CUED      (uID: ${e.target.f.id})`);break;case YT.PlayerState.PLAYING:b.log(`onYouTubePlayerStateChange: PLAYING   (uID: ${e.target.f.id})`),R.syncAll(e.target.f.id,R.STATE.PLAY),f.current.setDuration(Math.round(e.target.getDuration())),Y.start();break;case YT.PlayerState.PAUSED:b.log(`onYouTubePlayerStateChange: PAUSED    (uID: ${e.target.f.id})`),f.isCurrent(e.target.f.id)?(R.syncAll(e.target.f.id,R.STATE.PAUSE),Y.stop(!1)):f.crossfade.stop();break;case YT.PlayerState.ENDED:b.log(`onYouTubePlayerStateChange: ENDED     (uID: ${e.target.f.id})`),f.isCurrent(e.target.f.id)?(Y.stop(!0),U(l.MEDIA_ENDED)):f.crossfade.stop();break;case YT.PlayerState.UNSTARTED:b.log(`onYouTubePlayerStateChange: UNSTARTED (uID: ${e.target.f.id})`),B.ytAutoPlayBlocked(e.target.f.id,3e3)&&U(l.AUTOPLAY_BLOCKED);break;default:b.log(`onYouTubePlayerStateChange: Unknown state: ${e.data} for ${e.target.f.id}`)}}function cn(e){b.log("onYouTubePlayerError: "+e.data);let t=f.playerFromUid(e.target.f.id);t.setPlayable(!1),Pe(t,e.target.getVideoUrl())}function sn(){b.log("initSoundCloudAPI()"),U(l.LOADING,be())}function dn(){b.log("onSoundCloudPlayerEventReady()"),Et()}function gn(e){b.log(`onSoundCloudPlayerEvent: PLAY   (uID: ${e.soundId})`),B.add(d.SOUNDCLOUD,g.STATE_PLAYING,e.soundId),f.crossfade.isFading()&&f.isCurrent(e.soundId)?B.scPlayDoubleTrigger(e.soundId,W.maxPlaybackStartDelay*1e3)&&R.syncAll(e.soundId,R.STATE.PLAY):(R.syncAll(e.soundId,R.STATE.PLAY),f.current.mute(ie.masterMute),f.current.setVolume(ie.masterVolume)),f.current.getEmbeddedPlayer().getDuration(t=>{f.current.setDuration(Math.round(t/1e3)),Y.start()})}function fn(e){b.log(`onSoundCloudPlayerEvent: PAUSE  (uID: ${e.soundId})`),B.add(d.SOUNDCLOUD,g.STATE_PAUSED,e.soundId),B.scAutoPlayBlocked(e.soundId,3e3)?(Y.stop(!1),U(l.AUTOPLAY_BLOCKED)):B.scWidgetPlayBlocked(e.soundId,3e4)?(Y.stop(!1),U(l.PLAYBACK_BLOCKED,{currentTrack:f.trackFromUid(e.soundId),numTracks:f.getNumTracks()})):f.isCurrent(e.soundId)?f.current.getPosition(t=>{t>0&&(R.syncAll(e.soundId,R.STATE.PAUSE),Y.stop(!1))}):f.crossfade.stop()}function mn(e){b.log(`onSoundCloudPlayerEvent: FINISH (uID: ${e.soundId})`),f.isCurrent(e.soundId)?(Y.stop(!0),U(l.MEDIA_ENDED)):f.crossfade.stop()}function En(){this.getCurrentSound(e=>{let t=f.playerFromUid(e.id);b.log(`onSoundCloudPlayerEvent: ERROR for track: ${f.trackFromUid(e.id)}. ${t.getArtist()} - ${t.getTitle()} - [${t.getUid()} / ${t.getIframeId()}]`),t.setPlayable(!1)})}var w=A("playback"),ue=null,P={},o={},Se={updateTimerInterval:200,minTrackCrossfadeTime:5,maxBufferingDelay:3};function Tt(e){ue=B,P=e.user,ct(e),rt(P,Tn,bn),o=tt(),o.init(P,hn),ft(P,o,pt,yt)}function ht(){return mt(Pn)>0}function z(){M()?(j(),o.current.pause()):(Ke(o.getStatus()),o.current.play(Pe))}function Je(e){w.log(`prevClick() - prevTrack: ${o.getCurrentTrack()-1} - numTracks: ${o.getNumTracks()} - event: ${e!==null?e.type:"null"}`),o.getCurrentTrack()>0&&o.current.getPosition(t=>{t>3e3?(o.current.seekTo(0),yt.updateCallback(0)):(o.getCurrentTrack()>1&&o.stop(),o.prevTrack(M())&&Fe(o.getStatus()))})}function Ae(e){w.log(`nextClick() - nextTrack: ${o.getCurrentTrack()+1} - numTracks: ${o.getNumTracks()} - event: ${e!==null?e.type:"null"}`),o.getCurrentTrack()+1<=o.getNumTracks()?(o.stop(),e!==null||P.autoPlay?o.nextTrack(M())&&ye(o.getStatus()):j()):e===null&&(j(),P.autoPlay?v(l.CONTINUE_AUTOPLAY):o.stop())}function Tn(e){o.current.seekTo(e)}function Xe(){P.masterMute=!(P.masterMute===!0),o.mute()}function hn(e,t=!0){v(l.MEDIA_SHOW,{scrollToMedia:t,postId:o.current.getPostId()}),e&&o.current.play(Pe)}function bt(e,t=!0){w.log(`skipToTrack(): ${e} - ${t}`),t===!0&&M()===!1&&(ue.clear(),ue.add(d.ULTRAFUNK,g.RESUME_AUTOPLAY,null),o.jumpToTrack(e,t)&&ye(o.getStatus()))}function Sn(){w.log("resumeAutoPlay()"),ue.add(d.ULTRAFUNK,g.RESUME_AUTOPLAY,null),z()}function N(){return{isPlaying:M(),currentTrack:o.getCurrentTrack(),numTracks:o.getNumTracks(),postId:o.current.getPostId(),iframeId:o.current.getIframeId()}}function Pn(e,t=null){w.isDebug()&&e!==l.LOADING&&(w.log(`embeddedEventHandler(): ${e}`),t!==null&&w.log(t));switch(e){case l.LOADING:v(l.LOADING,t);break;case l.READY:ot(Je,z,Ae,Xe,o.getNumTracks()),v(l.READY),v(l.RESUME_AUTOPLAY,null,{resumeAutoPlay:Sn});break;case l.MEDIA_ENDED:Ae(null);break;case l.AUTOPLAY_BLOCKED:j(),v(l.AUTOPLAY_BLOCKED,N(),{togglePlayPause:z});break;case l.PLAYBACK_BLOCKED:j(),v(l.PLAYBACK_BLOCKED,t,{skipToTrack:bt});break;case l.MEDIA_UNAVAILABLE:j(),v(l.MEDIA_UNAVAILABLE,t,{skipToTrack:bt});break}}var pt=(()=>{let e={PLAY:1,PAUSE:2},t=function a(s,i){if(w.log(`playbackState.syncAll() - previousTrack: ${o.getPlayerIndex()+1} - nextTrack: ${o.indexMap.get(s)+1} - syncState: ${w.getObjectKeyForValue(e,i)}`),o.isCurrent(s))i===e.PLAY?(o.crossfade.start(s),Ke(o.getStatus()),v(l.MEDIA_PLAYING,N())):i===e.PAUSE&&(o.crossfade.stop(),j(),v(l.MEDIA_PAUSED,N()));else{let c=o.getPlayerIndex(),m=o.indexMap.get(s);o.stop(),o.setPlayerIndex(m),n(c,m),a(s,i)}};function n(a,s){s>a?ye(o.getStatus()):Fe(o.getStatus())}return{STATE:e,syncAll:t,syncControls:n}})(),yt=(()=>{let e=-1,t=0,n=!0;return document.addEventListener("visibilitychange",i),{start:a,stop:s,updateCallback:m};function a(){s(!1),e=setInterval(c,Se.updateTimerInterval)}function s(T=!1){e!==-1&&(clearInterval(e),e=-1),T&&(m(0),v(l.MEDIA_ENDED,N())),t=0,pe(!1)}function i(){n=document.visibilityState==="visible"}function c(){n&&o.current.getPosition(m)}function m(T,L=0){let I=Math.round(T/1e3);st(T,L),me(I,L),I>0&&L>0&&(E(I,L),S(I,L))}function E(T,L){if(P.autoPlay===!1&&P.timeRemainingWarning&&t!==T){let I=L-T;t=T,I<=P.timeRemainingSeconds?(pe(!0),v(l.MEDIA_TIME_REMAINING,{timeRemainingSeconds:I})):pe(!1)}}function S(T,L){P.masterMute!==!0&&P.autoPlay&&P.autoCrossfade&&(L-T===P.autoCrossfadeLength+Se.maxBufferingDelay&&(o.getCurrentTrack()+1<=o.getNumTracks()&&Pt(F.AUTO,P.autoCrossfadeCurve)))}})();function bn(e){let t=o.uIdFromIframeId(e);o.isCurrent(t)===!1&&o.current.getDuration()>0&&(w.log(`trackCrossfadeClick():
fadeOut: ${o.current.getArtist()} - "${o.current.getTitle()}" (${o.current.getUid()})
fadeIn.: ${o.playerFromUid(t).getArtist()} - "${o.playerFromUid(t).getTitle()}" (${t})`),P.masterMute!==!0&&P.autoPlay===!1&&P.trackCrossfade&&o.current.getPosition(n=>{let a=o.current.getDuration()-n/1e3;a>=Se.minTrackCrossfadeTime+Se.maxBufferingDelay&&Pt(F.TRACK,P.trackCrossfadeCurve,t)}))}function Pt(e,t,n=null){ue.add(d.ULTRAFUNK,g.CROSSFADE_START,null);let a=o.crossfade.init(e,t,n);a!==null&&pt.syncControls(a.fadeOutPlayer,a.fadeInPlayer)}var Z=A("screen-wakelock"),ke=null;function St(){return"wakeLock"in navigator&&"request"in navigator.wakeLock}async function kt(e){St()?document.visibilityState==="visible"&&(await At()!==!0&&Z.log("enable(): Screen Wake Lock request failed")):(Z.log("enable(): Screen Wake Lock is not supported"),O("Keep Screen On is not supported",5,"Turn Off",()=>e.user.keepMobileScreenOn=!1))}function It(){Z.log("stateVisible()"),St()&&ke===null&&At()}async function At(){try{return ke=await navigator.wakeLock.request("screen"),Z.log("request(): Screen Wake Lock is Enabled"),ke.addEventListener("release",()=>{Z.log("request(): Screen Wake Lock was Released"),ke=null}),!0}catch(e){Z.error(`request(): ${e.name} - ${e.message}`)}return!1}var ee=A("playback-interaction"),te=new _e(10),y={},Le=!1,Lt=!1,V={autoPlayToggleId:"footer-autoplay-toggle",crossfadeToggleId:"footer-crossfade-toggle",allowKeyboardShortcutsEvent:"allowKeyboardShortcuts",denyKeyboardShortcutsEvent:"denyKeyboardShortcuts",fullscreenTrackEvent:new Event("fullscreenTrack"),doubleClickDelay:500},h={playbackControls:{details:null,thumbnail:null,statePlaying:!1},fullscreenTarget:null,autoPlayToggle:null,crossfadeToggle:null};document.addEventListener("DOMContentLoaded",()=>{ee.log("DOMContentLoaded"),Ln(),ht()&&(Cn(),Dn(),Ct(y.user.autoPlay),Dt(y.user.autoCrossfade))});document.addEventListener("fullscreenchange",vt);document.addEventListener("webkitfullscreenchange",vt);document.addEventListener(V.allowKeyboardShortcutsEvent,()=>{y.user.keyboardShortcuts&&(Le=!0)});document.addEventListener(V.denyKeyboardShortcutsEvent,()=>{y.user.keyboardShortcuts&&(Le=!1)});window.addEventListener("blur",vn);function Ln(){ee.log("readSettings()"),y=In(kn.UF_PLAYBACK_SETTINGS,An,!0),ee.log(y)}function Cn(){ee.log("initInteraction()"),Le=y.user.keyboardShortcuts,h.playbackControls.details=document.getElementById("playback-controls").querySelector(".details-control"),h.playbackControls.thumbnail=document.getElementById("playback-controls").querySelector(".thumbnail-control"),h.autoPlayToggle=document.getElementById(V.autoPlayToggleId),h.crossfadeToggle=document.getElementById(V.crossfadeToggleId),Ie("i.nav-bar-arrow-back","click",ne,navigationVars.prevUrl),Ie("i.nav-bar-arrow-fwd","click",ne,navigationVars.nextUrl),Ie("nav.post-navigation .nav-previous a","click",ne,navigationVars.prevUrl),Ie("nav.post-navigation .nav-next a","click",ne,navigationVars.nextUrl)}function Dn(){Tt(y),he(l.READY,Un),he(l.MEDIA_ENDED,Nn),he(l.MEDIA_TIME_REMAINING,On)}document.addEventListener("keydown",e=>{if(Lt&&Le&&e.ctrlKey===!1&&e.altKey===!1){switch(e.code){case"Backquote":Ut(e);break}switch(e.key){case" ":e.preventDefault(),z();break;case"ArrowLeft":_n(e);break;case"ArrowRight":Mn(e);break;case"A":Nt(e);break;case"f":case"F":Rn(e);break;case"m":case"M":e.preventDefault(),Xe(),O(y.user.masterMute?"Volume is muted (<b>m</b> to unmute)":"Volume is unmuted (<b>m</b> to mute)",3);break;case"x":case"X":h.crossfadeToggle.classList.contains("disabled")===!1&&Ot(e);break}}});function Rn(e){e.preventDefault(),h.fullscreenTarget===null?Rt():ce()}function _n(e){e.preventDefault(),ce(),e.shiftKey===!0?ne(e,navigationVars.prevUrl):(te.add(d.KEYBOARD,g.KEY_ARROW_LEFT,null),xn(navigationVars.prevUrl,N())||Je(e))}function xn(e,t){return e!==null&&(t.currentTrack===1&&t.isPlaying===!1&&(Ce("showLeftArrowHint","<b>Tip:</b> Double click the Left Arrow key to go to the previous page"),te.doubleClicked(d.KEYBOARD,g.KEY_ARROW_LEFT,V.doubleClickDelay)))?(Q(e,!1),!0):!1}function Mn(e){e.preventDefault(),ce(),e.shiftKey===!0?ne(e,navigationVars.nextUrl):(te.add(d.KEYBOARD,g.KEY_ARROW_RIGHT,null),Bn(navigationVars.nextUrl,N())||Ae(e))}function Bn(e,t){return e!==null&&(t.currentTrack===t.numTracks&&(Ce("showRightArrowHint","<b>Tip:</b> Double click the Right Arrow key to go to the next page"),te.doubleClicked(d.KEYBOARD,g.KEY_ARROW_RIGHT,V.doubleClickDelay)))?(Q(e,t.isPlaying),!0):!1}function Ce(e,t,n=0){y.priv.tips[e]&&(O(t,n),y.priv.tips[e]=!1)}function Un(){h.playbackControls.details.addEventListener("click",_t),h.playbackControls.thumbnail.addEventListener("click",_t),h.autoPlayToggle.addEventListener("click",Nt),h.crossfadeToggle.addEventListener("click",Ot),document.addEventListener("visibilitychange",wn),y.user.keepMobileScreenOn&&kt(y),Lt=!0}function Nn(){y.user.autoExitFullscreen&&ce()}function On(e){y.user.autoExitFsOnWarning&&e.data.timeRemainingSeconds<=y.user.timeRemainingSeconds&&ce()}function vn(){setTimeout(()=>{document.activeElement instanceof HTMLIFrameElement&&setTimeout(()=>{document.activeElement.blur(),document.activeElement instanceof HTMLIFrameElement&&document.activeElement.blur()},250)},0)}function vt(){h.fullscreenTarget=document.fullscreenElement!==null?document.fullscreenElement.id:null,V.fullscreenTrackEvent.fullscreenTarget=h.fullscreenTarget,document.dispatchEvent(V.fullscreenTrackEvent)}function wn(){document.visibilityState==="visible"?(y.user.autoResumePlayback&&h.playbackControls.statePlaying&&(N().isPlaying===!1&&z()),y.user.keepMobileScreenOn&&It()):document.visibilityState==="hidden"&&(y.user.autoResumePlayback&&N().isPlaying?h.playbackControls.statePlaying=!0:h.playbackControls.statePlaying=!1)}function _t(e){Ut(e),te.add(d.MOUSE,g.MOUSE_CLICK,null),e.target.tagName.toLowerCase()==="img"?Ce("showTrackImageHint","<b>Tip:</b> Double click or double tap on the Track Thumbnail for full screen"):Ce("showDetailsHint","<b>Tip:</b> Double click or double tap on Artist &amp; Title for full screen"),te.doubleClicked(d.MOUSE,g.MOUSE_CLICK,V.doubleClickDelay)&&Rt()}function ne(e,t){e!==null&&t!==null&&(e.preventDefault(),Q(t,N().isPlaying))}function Ut(e){e.preventDefault(),qe.id(N().postId)}function Rt(){let e=document.getElementById(N().iframeId);e.requestFullscreen()}function ce(){h.fullscreenTarget!==null&&(document.exitFullscreen(),h.fullscreenTarget=null)}function Nt(e){e.preventDefault(),y.user.autoPlay=!(y.user.autoPlay===!0),O(y.user.autoPlay?"Autoplay enabled (<b>Shift</b> + <b>A</b> to disable)":"Autoplay disabled (<b>Shift</b> + <b>A</b> to enable)",5),Ct(y.user.autoPlay)}function Ct(e){ee.log(`updateAutoPlayDOM() - autoPlay: ${e}`),h.autoPlayToggle.querySelector(".autoplay-on-off").textContent=e?"ON":"OFF",e?K(document.body,"autoplay-off","autoplay-on"):K(document.body,"autoplay-on","autoplay-off"),e?h.crossfadeToggle.classList.remove("disabled"):h.crossfadeToggle.classList.add("disabled")}function Ot(e){e.preventDefault(),y.user.autoCrossfade=!(y.user.autoCrossfade===!0),O(y.user.autoCrossfade?"Auto Crossfade enabled (<b>x</b> to disable)":"Auto Crossfade disabled (<b>x</b> to enable)",5),Dt(y.user.autoCrossfade)}function Dt(e){ee.log(`updateCrossfadeDOM() - autoCrossfade: ${e}`),h.crossfadeToggle.querySelector(".crossfade-on-off").textContent=e?"ON":"OFF"}
//# sourceMappingURL=interaction.js.map
