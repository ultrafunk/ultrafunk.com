import{A as Qe,B as sa,D as Da,b as pt,c as Ga,d as V,f as We,h as Oe,k as P,m as X,n as Ke,p as ra,q as k,r as A,s as K,u as Gt,v as lt,x as Wa,y as Ra,z as Ba}from"../chunk-G2H74JZC.js";var we=k("eventlogger"),c={UNKNOWN:1e3,KEYBOARD:100,MOUSE:110,YOUTUBE:1,SOUNDCLOUD:2,ULTRAFUNK:50},d={UNKNOWN:-2e3,KEY_ARROW_LEFT:80,KEY_ARROW_RIGHT:81,MOUSE_CLICK:82,STATE_ERROR:-5,STATE_UNSTARTED:-1,STATE_ENDED:0,STATE_PLAYING:1,STATE_PAUSED:2,STATE_BUFFERING:3,STATE_CUED:5,RESUME_AUTOPLAY:50,PLAYER_ERROR:60,CROSSFADE_START:70},$t={eventSource:c.UNKNOWN,eventType:d.UNKNOWN,uId:null,timeStamp:0},_e=class{constructor(t=10){this.log=[],this.maxEntries=t,this.lastPos=0,this.matchCount=0}add(t,n,r,u=Date.now()){let E=Object.create($t);E.eventSource=t,E.eventType=n,E.uId=r,E.timeStamp=u,this.log.length<this.maxEntries?this.log.push(E):(this.log.shift(),this.log.push(E))}clear(){this.log=[]}initMatch(){this.lastPos=this.log.length-1,this.matchCount=0}matchesEvent(t,n,r,u=null){this.log[this.lastPos-t].eventSource===n&&this.log[this.lastPos-t].eventType===r&&this.log[this.lastPos-t].uId===u&&this.matchCount++}matchesDelta(t,n){this.log[this.lastPos].timeStamp-this.log[this.lastPos-t].timeStamp<=n&&this.matchCount++}isPatternMatch(t,n){return this.matchCount===t?(we.log(`MATCH for: ${n}`),we.logEventLog(this.log,c,d),!0):!1}},Me=class extends _e{constructor(t){super(t)}doubleClicked(t,n,r){return this.initMatch(),this.lastPos>=1&&(this.matchesEvent(1,t,n),this.matchesEvent(0,t,n),this.matchesDelta(1,r)),this.isPatternMatch(3,`${we.getObjectKeyForValue(c,t)} Double Clicked`)}},se=class extends _e{constructor(t){super(t)}ytAutoplayBlocked(t,n){return this.initMatch(),this.lastPos>=3&&(this.matchesEvent(3,c.ULTRAFUNK,d.RESUME_AUTOPLAY,null),this.matchesEvent(2,c.YOUTUBE,d.STATE_UNSTARTED,t),this.matchesEvent(1,c.YOUTUBE,d.STATE_BUFFERING,t),this.matchesEvent(0,c.YOUTUBE,d.STATE_UNSTARTED,t),this.matchesDelta(3,n)),this.isPatternMatch(5,"YouTube Autoplay Blocked")}scAutoplayBlocked(t,n){return this.initMatch(),this.lastPos>=3&&(this.matchesEvent(3,c.ULTRAFUNK,d.RESUME_AUTOPLAY,null),this.matchesEvent(2,c.SOUNDCLOUD,d.STATE_PLAYING,t),this.matchesEvent(1,c.SOUNDCLOUD,d.STATE_PAUSED,t),this.matchesEvent(0,c.SOUNDCLOUD,d.STATE_PAUSED,t),this.matchesDelta(3,n)),this.isPatternMatch(5,"SoundCloud Autoplay Blocked")}scWidgetPlayBlocked(t,n){return this.initMatch(),this.lastPos>=2&&(this.matchesEvent(2,c.SOUNDCLOUD,d.STATE_PLAYING,t),this.matchesEvent(1,c.SOUNDCLOUD,d.STATE_PAUSED,t),this.matchesEvent(0,c.SOUNDCLOUD,d.STATE_PAUSED,t),this.matchesDelta(2,n)),this.isPatternMatch(4,"SoundCloud WidgetPlay Blocked")}scPlayDoubleTrigger(t,n){return this.initMatch(),this.lastPos>=2&&(this.matchesEvent(2,c.ULTRAFUNK,d.CROSSFADE_START,null),this.matchesEvent(1,c.SOUNDCLOUD,d.STATE_PLAYING,t),this.matchesEvent(0,c.SOUNDCLOUD,d.STATE_PLAYING,t),this.matchesDelta(1,n)),this.isPatternMatch(4,"SoundCloud Play Double Trigger")}};var Ee=k("playback-controls"),G={},le={},ye={progressControlsId:"progress-controls",playbackControlsId:"playback-controls"},i={DISABLED:{CLASS:"state-disabled",ID:1},ENABLED:{CLASS:"state-enabled",ID:2},PLAYING:{CLASS:"state-playing",ID:3},PAUSED:{CLASS:"state-paused",ID:4}},a={progressSeek:{element:null,STATE:i.DISABLED,click:null},progressBar:{element:null,STATE:i.DISABLED},details:{element:null,STATE:i.DISABLED,artistElement:null,titleElement:null},thumbnail:{element:null,STATE:i.DISABLED,img:null},timer:{element:null,STATE:i.DISABLED,positionElement:null,durationElement:null,positionSeconds:-1,durationSeconds:-1},prevTrack:{element:null,STATE:i.DISABLED},playPause:{element:null,STATE:i.DISABLED,iconElement:null},nextTrack:{element:null,STATE:i.DISABLED},shuffle:{element:null,STATE:i.DISABLED},mute:{element:null,STATE:i.DISABLED,iconElement:null}};function pe(e,t,n){Ee.log("init()"),G=e,le=t;let r=document.getElementById(ye.progressControlsId);r!==null?(a.progressSeek.element=r.querySelector(".seek-control"),a.progressSeek.click=n,a.progressBar.element=r.querySelector(".bar-control")):Ee.error(`init(): Unable to getElementById() for '#${ye.progressControlsId}'`);let u=document.getElementById(ye.playbackControlsId);u!==null?(a.details.element=u.querySelector(".details-control"),a.details.artistElement=a.details.element.querySelector(".details-artist"),a.details.titleElement=a.details.element.querySelector(".details-title"),a.thumbnail.element=u.querySelector(".thumbnail-control"),a.thumbnail.img=a.thumbnail.element.querySelector("img"),a.timer.element=u.querySelector(".timer-control"),a.timer.positionElement=a.timer.element.querySelector(".timer-position"),a.timer.durationElement=a.timer.element.querySelector(".timer-duration"),a.prevTrack.element=u.querySelector(".prev-control"),a.playPause.element=u.querySelector(".play-pause-control"),a.playPause.iconElement=a.playPause.element.querySelector("i"),a.nextTrack.element=u.querySelector(".next-control"),a.shuffle.element=u.querySelector(".shuffle-control"),a.mute.element=u.querySelector(".mute-control"),a.mute.iconElement=a.mute.element.querySelector("i")):Ee.error(`init(): Unable to getElementById() for '#${ye.playbackControlsId}'`)}function Te(e,t,n,r){Ee.log("ready()"),b(a.progressSeek,i.ENABLED),a.progressSeek.element.addEventListener("click",Ft),b(a.progressBar,i.ENABLED),b(a.details,i.ENABLED),b(a.thumbnail,i.ENABLED),b(a.timer,i.ENABLED),G.trackThumbnailOnMobile&&a.thumbnail.element.classList.add("show-on-mobile"),G.trackTimesOnMobile&&a.timer.element.classList.add("show-on-mobile"),b(a.prevTrack,i.DISABLED),a.prevTrack.element.addEventListener("click",e),b(a.playPause,i.PAUSED),a.playPause.element.addEventListener("click",t),b(a.nextTrack,le.getNumTracks()>1?i.ENABLED:i.DISABLED),a.nextTrack.element.addEventListener("click",n),b(a.shuffle,i.ENABLED),b(a.mute,i.ENABLED),a.mute.element.addEventListener("click",r),et(),Qe("autoplay",jt),Qe("masterMute",et)}function b(e,t=t.DISABLED){A(e.element,e.STATE.CLASS,t.CLASS),e.STATE=t}function Se(e,t){Ve(t===0?0:e/(t*1e3))}function ie(e){Ve(e/100)}function Ve(e){a.progressBar.element.style.transform=`scaleX(${e})`}function Ft(e){if(a.timer.durationSeconds>0){let t=e.clientX/document.documentElement.clientWidth*100,n=Math.round(a.timer.durationSeconds*t/100);a.progressSeek.click(n),f()===!1&&(ie(t),W(n,a.timer.durationSeconds))}}function xe(e){a.details.artistElement.textContent=e.artist||"",a.details.titleElement.textContent=e.title||"",qt(e.thumbnail),W(-1,-1)}function qt(e){e.src!==a.thumbnail.img.src&&(a.thumbnail.element.classList.remove("type-default","type-youtube","type-soundcloud"),a.thumbnail.element.classList.add("loading",e.class),a.thumbnail.img.src=e.src,a.thumbnail.img.decode().then(()=>a.thumbnail.element.classList.remove("loading")))}function W(e,t){e!==-1&&a.timer.positionSeconds!==e?(a.timer.positionSeconds=e,G.autoplay===!1&&(e=t-e),ke(a.timer.positionElement,e)):e===-1&&a.timer.positionSeconds===-1&&(a.timer.positionElement.textContent="00:00"),t!==-1&&a.timer.durationSeconds!==t?(a.timer.durationSeconds=t,ke(a.timer.durationElement,t)):t===-1&&a.timer.durationSeconds===-1&&(a.timer.durationElement.textContent="00:00")}function ke(e,t){let n=new Date(t*1e3).toISOString();e.textContent=t>60*60?n.substr(11,8):n.substr(14,5)}function tt(){a.timer.positionElement.textContent="00:00",a.timer.durationElement.textContent="00:00",a.timer.positionSeconds=0,a.timer.durationSeconds=0}function f(){return a.playPause.STATE.ID===i.PLAYING.ID}function ce(){let e=le.getStatus();tt(),xe(e),f()===!1&&e.currentTrack<=1&&b(a.prevTrack,i.DISABLED),e.currentTrack<e.numTracks&&b(a.nextTrack,i.ENABLED)}function ue(){let e=le.getStatus();b(a.playPause,i.PLAYING),a.playPause.iconElement.textContent="pause_circle_filled",b(a.prevTrack,i.ENABLED),xe(e)}function U(){b(a.playPause,i.PAUSED),a.playPause.iconElement.textContent="play_circle_filled"}function be(e){e?a.playPause.element.classList.toggle("time-remaining-warning"):a.playPause.element.classList.remove("time-remaining-warning")}function H(){let e=le.getStatus();tt(),xe(e),b(a.prevTrack,i.ENABLED),e.currentTrack>=e.numTracks&&b(a.nextTrack,i.DISABLED)}function et(){a.mute.iconElement.textContent=G.masterMute?"volume_off":"volume_up"}function jt(){f()===!1&&a.timer.positionSeconds!==-1&&a.timer.durationSeconds!==-1&&(ke(a.timer.positionElement,G.autoplay?a.timer.positionSeconds:a.timer.durationSeconds-a.timer.positionSeconds),ke(a.timer.durationElement,a.timer.durationSeconds))}var de=k("playback-events"),Ae={},$e={nowPlayingIconsSelector:"h2.entry-title"},Pe={nowPlayingIcons:null,snackbarId:0},s={LOADING:"loading",READY:"ready",MEDIA_PLAYING:"mediaPlaying",MEDIA_PAUSED:"mediaPaused",MEDIA_ENDED:"mediaEnded",MEDIA_TIME_REMAINING:"mediaTimeRemaining",MEDIA_SHOW:"mediaShow",MEDIA_UNAVAILABLE:"mediaUnavailable",CONTINUE_AUTOPLAY:"continueAutoplay",RESUME_AUTOPLAY:"resumeAutoplay",AUTOPLAY_BLOCKED:"autoplayBlocked",PLAYBACK_BLOCKED:"playbackBlocked"},Fe={[s.LOADING]:[Wt],[s.READY]:[Ht],[s.MEDIA_PLAYING]:[Xt],[s.MEDIA_PAUSED]:[zt],[s.MEDIA_ENDED]:[at],[s.MEDIA_TIME_REMAINING]:[Zt],[s.MEDIA_SHOW]:[Jt],[s.CONTINUE_AUTOPLAY]:[Qt],[s.RESUME_AUTOPLAY]:[ea],[s.AUTOPLAY_BLOCKED]:[ta],[s.PLAYBACK_BLOCKED]:[aa],[s.MEDIA_UNAVAILABLE]:[na]};function nt(e){de.log("init()"),Ae=e,Pe.nowPlayingIcons=document.querySelectorAll($e.nowPlayingIconsSelector)}function x(e,t){e in Fe&&Fe[e].push(t)}function L(e,t=null,n=null){Fe[e].forEach(r=>{r({event:e,data:t,callback:n})})}function Wt(e){ie(e.data.loadingPercent)}function Ht(e){O(e),ie(0)}function Xt(e){if(O(e),Ke(Pe.snackbarId),e.data.numTracks>1){let t=document.querySelector(`#${e.data.trackId} ${$e.nowPlayingIconsSelector}`);ot(t),A(t,"playing-paused","now-playing-icon"),Ae.user.animateNowPlayingIcon&&t.classList.add("playing-animate")}}function zt(e){O(e),e.data.numTracks>1&&document.querySelector(`#${e.data.trackId} ${$e.nowPlayingIconsSelector}`).classList.add("playing-paused")}function at(e){O(e),ie(0),e!==null&&e.data.numTracks>1&&ot()}function Zt(){}function Jt(e){O(e),at(null),e.data.scrollToMedia&&je(e.data.trackId)}function Qt(e){O(e),z(navigationUrls.next,!0)}function ea(e){let t=sessionStorage.getItem(V.UF_AUTOPLAY);sessionStorage.removeItem(V.UF_AUTOPLAY),O(e),de.log(`RESUME_AUTOPLAY: ${t!==null?"true":"false"}`),t!==null&&e.callback.resumeAutoplay()}function ta(e){O(e),Pe.snackbarId=P("Autoplay blocked, Play to continue",0,"play",()=>{e.data.isPlaying===!1&&e.callback.togglePlayPause()})}function aa(e){O(e),P("Unable to play track, skipping to next",5,"Stop",()=>{},()=>qe(e))}function na(e){O(e),oa(e.data.trackId)?P("YouTube Premium track, skipping",5,"help",()=>{window.location.href="/channel/premium/"},()=>qe(e)):(P("Unable to play track, skipping to next",5,"Stop",()=>{},()=>qe(e)),Gt("EVENT_MEDIA_UNAVAILABLE",e.data))}function O(e=null){de.isDebug()&&e!==null&&de.log(e)}function ot(e){Pe.nowPlayingIcons.forEach(t=>{t!==e&&t.classList.remove("now-playing-icon","playing-animate","playing-paused")})}function qe(e){e.data.currentTrack<e.data.numTracks?e.callback.skipToTrack(e.data.currentTrack+1,!0):navigationUrls.next!==null&&z(navigationUrls.next,!0)}function oa(e){let t=document.getElementById(e);return t!==null?t.classList.contains("category-premium"):!1}function z(e,t=!1){de.log(`navigateTo(): ${e} - continueAutoplay: ${t}`),e!=null&&e.length>0&&(t&&sessionStorage.setItem(V.UF_AUTOPLAY,"true"),window.location.href=e)}function je(e){if(Ae.user.autoScroll){let t=Math.round(window.scrollY+document.getElementById(e).getBoundingClientRect().top),n=Math.round(window.pageYOffset),r=rt(t>n);n+r+st()>t&&(r=rt(!1)),window.scroll({top:t-(r+st()),left:0,behavior:Ae.user.smoothScrolling?"smooth":"auto"})}}function rt(e){return e?X("--site-header-height-down"):X("--site-header-height-up")}function st(){return X("--site-content-margin-top")-1}var T=k("embedded-players"),R=new se(10),I=null,Ge=0,it=1,ge,g,C,w,Z={trackCountData:"data-track-count",youTubeIframeIdRegEx:/youtube-uid/i,soundCloudIframeIdRegEx:/soundcloud-uid/i,entriesSelector:"single-track",artistTrackTitleData:"data-artist-track-title",maxPlaybackStartDelay:3};function ct(e){({settings:ge=null,players:g=null,playbackState:C=null,playbackTimer:w=null}=e),la(),ia()}function ut(e){let t=parseInt(document.body.getAttribute(Z.trackCountData));return T.log(`getTrackCount(): ${t}`),Ge=t+3,I=e,t}function Le(){return{loadingPercent:100*(it++/Ge)}}function dt(){it>=Ge?I(s.READY):I(s.LOADING,Le())}function pa(){document.querySelectorAll(Z.entriesSelector).forEach(t=>{let n=t.querySelector("iframe"),r={};if(Z.youTubeIframeIdRegEx.test(n.id)){let u=new YT.Player(n.id,{events:{onReady:ca,onStateChange:ua,onError:da}});r=new ra(t.id,n.id,u,n.src)}else if(Z.soundCloudIframeIdRegEx.test(n.id)){let u=SC.Widget(n.id);r=new lt(t.id,n.id,u,n.src),u.bind(SC.Widget.Events.READY,()=>{r.setThumbnail(),ga()}),u.bind(SC.Widget.Events.PLAY,ma),u.bind(SC.Widget.Events.PAUSE,fa),u.bind(SC.Widget.Events.FINISH,Ea),u.bind(SC.Widget.Events.ERROR,ya)}sa(t.getAttribute(Z.artistTrackTitleData),r),g.add(r)})}function he(e,t){T.log("onPlayerError()"),T.log(e);let n=e instanceof lt?c.SOUNDCLOUD:c.YOUTUBE;g.isCurrent(e.getUid())===!1&&g.stop(),R.add(n,d.PLAYER_ERROR,e.getUid()),I(s.MEDIA_UNAVAILABLE,Ta(e,t))}function Ta(e,t){let n=e.getArtist()||"N/A",r=e.getTitle()||"N/A";return{currentTrack:g.trackFromUid(e.getUid()),numTracks:g.getNumTracks(),trackId:e.getTrackId(),mediaTitle:`${n} - ${r}`,mediaUrl:t}}function la(){T.log("initYouTubeAPI()"),I(s.LOADING,Le()),window.onYouTubeIframeAPIReady=function(){T.log("onYouTubeIframeAPIReady()"),I(s.LOADING,Le()),pa()};let e=document.createElement("script");e.id="youtube-iframe-api",e.src="https://www.youtube.com/iframe_api";let t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}function ca(){T.log("onYouTubePlayerReady()"),dt()}function ua(e){switch(R.add(c.YOUTUBE,e.data,e.target.h.id),e.data){case YT.PlayerState.UNSTARTED:Sa(e);break;case YT.PlayerState.BUFFERING:ka(e);break;case YT.PlayerState.PLAYING:ba(e);break;case YT.PlayerState.PAUSED:Aa(e);break;case YT.PlayerState.CUED:Pa(e);break;case YT.PlayerState.ENDED:La(e);break}}function Sa(e){T.log(`onYouTubePlayerStateChange: UNSTARTED (uID: ${e.target.h.id})`),R.ytAutoplayBlocked(e.target.h.id,3e3)&&I(s.AUTOPLAY_BLOCKED)}function ka(e){if(T.log(`onYouTubePlayerStateChange: BUFFERING (uID: ${e.target.h.id})`),g.crossfade.isFading()===!1){let t=g.playerFromUid(e.target.h.id);t.mute(ge.masterMute),t.setVolume(ge.masterVolume)}}function ba(e){T.log(`onYouTubePlayerStateChange: PLAYING   (uID: ${e.target.h.id})`),C.syncAll(e.target.h.id,C.STATE.PLAY),g.current.setDuration(Math.round(e.target.getDuration())),w.start()}function Aa(e){T.log(`onYouTubePlayerStateChange: PAUSED    (uID: ${e.target.h.id})`),g.isCurrent(e.target.h.id)?(C.syncAll(e.target.h.id,C.STATE.PAUSE),w.stop(!1)):g.crossfade.stop()}function Pa(e){T.log(`onYouTubePlayerStateChange: CUED      (uID: ${e.target.h.id})`)}function La(e){T.log(`onYouTubePlayerStateChange: ENDED     (uID: ${e.target.h.id})`),g.isCurrent(e.target.h.id)?(w.stop(!0),I(s.MEDIA_ENDED)):g.crossfade.stop()}function da(e){T.log("onYouTubePlayerError: "+e.data);let t=g.playerFromUid(e.target.h.id);t.setPlayable(!1),he(t,e.target.getVideoUrl())}function ia(){T.log("initSoundCloudAPI()"),I(s.LOADING,Le())}function ga(){T.log("onSoundCloudPlayerEventReady()"),dt()}function ma(e){T.log(`onSoundCloudPlayerEvent: PLAY   (uID: ${e.soundId})`),R.add(c.SOUNDCLOUD,d.STATE_PLAYING,e.soundId),g.crossfade.isFading()&&g.isCurrent(e.soundId)?R.scPlayDoubleTrigger(e.soundId,Z.maxPlaybackStartDelay*1e3)&&C.syncAll(e.soundId,C.STATE.PLAY):(C.syncAll(e.soundId,C.STATE.PLAY),g.current.mute(ge.masterMute),g.current.setVolume(ge.masterVolume)),g.current.getEmbeddedPlayer().getDuration(t=>{g.current.setDuration(Math.round(t/1e3)),w.start()})}function fa(e){T.log(`onSoundCloudPlayerEvent: PAUSE  (uID: ${e.soundId})`),R.add(c.SOUNDCLOUD,d.STATE_PAUSED,e.soundId),R.scAutoplayBlocked(e.soundId,3e3)?(w.stop(!1),I(s.AUTOPLAY_BLOCKED)):R.scWidgetPlayBlocked(e.soundId,3e4)?(w.stop(!1),I(s.PLAYBACK_BLOCKED,{currentTrack:g.trackFromUid(e.soundId),numTracks:g.getNumTracks()})):g.isCurrent(e.soundId)?g.current.getPosition(t=>{t>0&&(C.syncAll(e.soundId,C.STATE.PAUSE),w.stop(!1))}):g.crossfade.stop()}function Ea(e){T.log(`onSoundCloudPlayerEvent: FINISH (uID: ${e.soundId})`),g.isCurrent(e.soundId)?(w.stop(!0),I(s.MEDIA_ENDED)):g.crossfade.stop()}function ya(){this.getCurrentSound(e=>{let t=g.playerFromUid(e.id);T.log(`onSoundCloudPlayerEvent: ERROR for track: ${g.trackFromUid(e.id)}. ${t.getArtist()} - ${t.getTitle()} - [${t.getUid()} / ${t.getIframeId()}]`),t.setPlayable(!1)})}var He=k("crossfade-controls"),gt={},Ie={},J={crossfadePresetSelector:".crossfade-controls .preset-control",crossfadePresetData:"data-crossfade-preset",crossfadeToSelector:".crossfade-controls .fadeto-control"},D={crossfadePreset:{elements:null},crossfadeTo:{elements:null,click:null}};function ft(e,t,n){He.log("init()"),gt=e,Ie=t,D.crossfadePreset.elements=document.querySelectorAll(J.crossfadePresetSelector),D.crossfadeTo.elements=document.querySelectorAll(J.crossfadeToSelector),D.crossfadePreset.elements.length>1&&D.crossfadeTo.elements.length>1&&(D.crossfadePreset.elements.forEach(r=>mt(r,gt.trackCrossfadeDefPreset)),D.crossfadeTo.click=n)}function yt(){He.log("ready()"),D.crossfadePreset.elements.length>1&&D.crossfadeTo.elements.length>1&&(D.crossfadePreset.elements.forEach(e=>{e.addEventListener("click",ha),A(e,i.DISABLED.CLASS,i.ENABLED.CLASS)}),D.crossfadeTo.elements.forEach(e=>e.addEventListener("click",Ia)),x(s.MEDIA_PLAYING,Et),x(s.MEDIA_PAUSED,Et))}function mt(e,t){e.setAttribute(J.crossfadePresetData,t),e.textContent=`${t+1}`,e.title=`Preset: ${We.crossfade[t].name}`}function ha(e){let t=parseInt(e.target.getAttribute(J.crossfadePresetData));t+1<We.crossfade.length?t++:t=0,mt(e.target,t)}function Ia(e){if(f()&&Ie.crossfade.isFading()===!1){let t=e.target.closest("single-track");if(t!==null){let n=t.querySelector("iframe"),r=t.querySelector(J.crossfadePresetSelector).getAttribute(J.crossfadePresetData);A(e.target.closest("div.fadeto-control"),i.ENABLED.CLASS,i.DISABLED.CLASS),D.crossfadeTo.click(Ie.uIdFromIframeId(n.id),We.crossfade[r])}}}function Et(){let e=f(),t=e?Ie.getStatus().currentTrack:-1;He.log(`updateCrossfadeToState() - playingState: ${e} - currentTrack: ${t}`),D.crossfadeTo.elements.forEach((n,r)=>{t===r+1?A(n,e?i.ENABLED.CLASS:i.DISABLED.CLASS,e?i.DISABLED.CLASS:i.ENABLED.CLASS):A(n,e?i.DISABLED.CLASS:i.ENABLED.CLASS,e?i.ENABLED.CLASS:i.DISABLED.CLASS)})}var B=k("playback"),me=null,y={},o={},De={updateTimerInterval:200,minCrossfadeToTime:5,maxBufferingDelay:3};function kt(e){me=R,y=e.user,nt(e),o=Da(),o.init(y,va),pe(y,o,Ca),ft(y,o,Na),ct({settings:y,players:o,playbackState:Tt,playbackTimer:St})}function bt(){return ut(Ua)>0}function Q(){f()?(U(),o.current.pause()):(ue(),o.current.play(he))}function Xe(e){B.log(`prevClick() - prevTrack: ${o.getCurrentTrack()-1} - numTracks: ${o.getNumTracks()} - event: ${e!==null?e.type:"null"}`),o.getCurrentTrack()>0&&o.current.getPosition(t=>{t>3e3?(o.current.seekTo(0),St.updateCallback(0)):(o.getCurrentTrack()>1&&o.stop(),o.prevTrack(f())&&ce())})}function Ce(e){B.log(`nextClick() - nextTrack: ${o.getCurrentTrack()+1} - numTracks: ${o.getNumTracks()} - event: ${e!==null?e.type:"null"}`),o.getCurrentTrack()+1<=o.getNumTracks()?(o.stop(),e!==null||y.autoplay?o.nextTrack(f())&&H():U()):e===null&&(U(),y.autoplay?L(s.CONTINUE_AUTOPLAY):o.stop())}function Ca(e){o.current.seekTo(e)}function ze(){y.masterMute=y.masterMute!==!0,o.mute()}function va(e,t=!0){L(s.MEDIA_SHOW,{scrollToMedia:t,trackId:o.current.getTrackId()}),e&&o.current.play(he)}function At(e,t=!0){B.log(`skipToTrack(): ${e} - ${t}`),t===!0&&f()===!1&&(me.clear(),me.add(c.ULTRAFUNK,d.RESUME_AUTOPLAY,null),o.jumpToTrack(e,t)&&H())}function Oa(){B.log("resumeAutoplay()"),me.add(c.ULTRAFUNK,d.RESUME_AUTOPLAY,null),Q()}function h(){return{isPlaying:f(),currentTrack:o.getCurrentTrack(),numTracks:o.getNumTracks(),trackId:o.current.getTrackId(),iframeId:o.current.getIframeId()}}function Ua(e,t=null){switch(B.isDebug()&&e!==s.LOADING&&(B.log(`embeddedEventHandler(): ${e}`),t!==null&&B.log(t)),e){case s.LOADING:L(s.LOADING,t);break;case s.READY:Te(Xe,Q,Ce,ze),yt(),L(s.READY),L(s.RESUME_AUTOPLAY,null,{resumeAutoplay:Oa});break;case s.MEDIA_ENDED:Ce(null);break;case s.AUTOPLAY_BLOCKED:U(),L(s.AUTOPLAY_BLOCKED,h(),{togglePlayPause:Q});break;case s.PLAYBACK_BLOCKED:U(),L(s.PLAYBACK_BLOCKED,t,{skipToTrack:At});break;case s.MEDIA_UNAVAILABLE:U(),L(s.MEDIA_UNAVAILABLE,t,{skipToTrack:At});break}}var Tt=(()=>{let e={PLAY:1,PAUSE:2},t=function r(u,E){if(B.log(`playbackState.syncAll() - previousTrack: ${o.getPlayerIndex()+1} - nextTrack: ${o.indexMap.get(u)+1} - syncState: ${B.getObjectKeyForValue(e,E)}`),o.isCurrent(u))E===e.PLAY?(o.crossfade.start(),ue(),L(s.MEDIA_PLAYING,h())):E===e.PAUSE&&(o.crossfade.stop(),U(),L(s.MEDIA_PAUSED,h()));else{let q=o.getPlayerIndex(),fe=o.indexMap.get(u);o.stop(),o.setPlayerIndex(fe),n(q,fe),r(u,E)}};function n(r,u){u>r?H():ce()}return{STATE:e,syncAll:t,syncControls:n}})(),St=(()=>{let e=-1,t=0,n=!0;return document.addEventListener("visibilitychange",()=>{n=document.visibilityState==="visible"}),{start:r,stop:u,updateCallback:E};function r(){u(!1),e=setInterval(()=>{n&&o.current.getPosition(E)},De.updateTimerInterval)}function u(N=!1){e!==-1&&(clearInterval(e),e=-1),N&&(E(0),L(s.MEDIA_ENDED,h())),t=0,be(!1)}function E(N,Y=0){let j=Math.round(N/1e3);Se(N,Y),W(j,Y),j>0&&Y>0&&(q(j,Y),fe(j,Y))}function q(N,Y){if(y.autoplay===!1&&y.timeRemainingWarning&&t!==N){let j=Y-N;t=N,j<=y.timeRemainingSeconds?(be(!0),L(s.MEDIA_TIME_REMAINING,{timeRemainingSeconds:j})):be(!1)}}function fe(N,Y){y.masterMute===!1&&y.autoplay&&y.autoCrossfade&&Y-N===y.autoCrossfadeLength+De.maxBufferingDelay&&o.getCurrentTrack()+1<=o.getNumTracks()&&Pt(pt.AUTO,{name:"Auto Crossfade",length:y.autoCrossfadeLength,curve:y.autoCrossfadeCurve})}})();function Na(e,t){o.isCurrent(e)===!1&&o.current.getDuration()>0&&(B.log(`crossfadeToClick():
fadeOut: ${o.current.getArtist()} - "${o.current.getTitle()}" (${o.current.getUid()})
fadeIn.: ${o.playerFromUid(e).getArtist()} - "${o.playerFromUid(e).getTitle()}" (${e})`),y.masterMute===!1&&y.autoplay===!1&&o.current.getPosition(n=>{o.current.getDuration()-n/1e3>=De.minCrossfadeToTime+De.maxBufferingDelay&&Pt(pt.TRACK,t,e)}))}function Pt(e,t,n=null){me.add(c.ULTRAFUNK,d.CROSSFADE_START,null);let r=o.crossfade.init(e,t,n);r!==null&&Tt.syncControls(r.fadeOutPlayer,r.fadeInPlayer)}var ee=k("screen-wakelock"),ve=null;function Lt(){return"wakeLock"in navigator&&"request"in navigator.wakeLock}async function It(e){Lt()?document.visibilityState==="visible"&&await ht()!==!0&&ee.log("enable(): Screen Wake Lock request failed"):(ee.log("enable(): Screen Wake Lock is not supported"),P("Keep Screen On is not supported",5,"Turn Off",()=>e.user.keepMobileScreenOn=!1))}function Dt(){ee.log("stateVisible()"),Lt()&&ve===null&&ht()}async function ht(){try{return ve=await navigator.wakeLock.request("screen"),ee.log("request(): Screen Wake Lock is Enabled"),ve.addEventListener("release",()=>{ee.log("request(): Screen Wake Lock was Released"),ve=null}),!0}catch(e){ee.error(`request(): ${e.name} - ${e.message}`)}return!1}var $=k("player-playlist"),te=new se(10),_={},S=null,Ne=null,Ct=!0,v={container:null,observer:null},l={trackId:null,element:null,snackbarId:0,autoplayValue:null};function vt(e,t){$.log("init"),_=e,Ne=t,v.container=document.getElementById("tracklist-container"),v.observer=new IntersectionObserver(Ma,{root:v.container}),K.init(),_a(),Va(),v.container.addEventListener("click",n=>{let r=n.target.closest("div.thumbnail");if(r!==null)return ae(r.closest("div.track-entry").id,!0,!0);let u=n.target.closest("div.share-playon-button");if(u!==null)return Ya(u)}),document.addEventListener("keydown",wa),document.getElementById("footer-autoplay-toggle").addEventListener("click",n=>Ne(n)),document.getElementById("playback-controls").querySelector(".details-control").addEventListener("click",Ue),document.getElementById("playback-controls").querySelector(".thumbnail-control").addEventListener("click",Ue),document.getElementById("playback-controls").querySelector(".timer-control").addEventListener("click",n=>Ne(n))}function Ya(e){let t=e.closest("div.track-entry"),n=t.getAttribute("data-artist-track-title"),r=t.getAttribute("data-track-url");Ba.show({string:n,filterString:!0,url:r})}function wa(e){if(e.repeat===!1&&e.ctrlKey===!1&&e.altKey===!1){switch(e.code){case"Backquote":e.preventDefault(),Ue(e);break}switch(e.key){case" ":e.preventDefault(),l.trackId!==null?ae(l.trackId):ae(v.container.querySelector(".track-entry.current").id);break;case"ArrowLeft":e.shiftKey===!1&&(e.preventDefault(),Ut());break;case"ArrowRight":e.shiftKey===!1&&(e.preventDefault(),Ot());break;case"A":Ne(e);break;case"f":case"F":e.preventDefault(),K.toggle(document.getElementById("youtube-player"));break;case"m":case"M":e.preventDefault(),Nt();break}}}function Ue(){let e=0;window.pageYOffset<1&&(e=X("--site-header-height")-X("--site-header-height-down")),window.scroll({top:e,left:0,behavior:_.user.smoothScrolling?"smooth":"auto"})}function Nt(){_.user.masterMute?_.user.masterMute=!1:_.user.masterMute=!0,_.user.masterMute?S.embedded.mute():S.embedded.unMute()}function _a(){if(l.trackId=v.container.querySelector(".track-entry").id,l.autoplayValue=sessionStorage.getItem(V.UF_AUTOPLAY),sessionStorage.removeItem(V.UF_AUTOPLAY),l.autoplayValue!==null){let e=l.autoplayValue.match(/^[a-zA-Z0-9-_]{11}$/);e!==null&&(l.trackId=e[0])}$.log(`setCurrentIdAndElement() - autoplayValue: ${l.autoplayValue!==null?l.autoplayValue:"N/A"} - current.trackId: ${l.trackId}`),l.element=document.getElementById(l.trackId),v.observer.observe(l.element)}function Ma(e){v.observer.unobserve(l.element),Math.ceil(e[0].intersectionRatio*100)/100!=1&&(v.container.scrollTop=l.element.offsetTop-v.container.offsetHeight+l.element.offsetHeight)}function ae(e,t=!0,n=!1){if($.log(e),e===void 0){F(!1);return}e===l.trackId?Bt():(f()&&S.embedded.stopVideo(),l.element.classList.remove("current","playing","paused"),l.trackId=e,l.element=document.getElementById(l.trackId),n===!1&&v.observer.observe(l.element),l.element.classList.add("current"),Rt(t))}function Rt(e){S.setArtistTitleThumbnail(l.element.getAttribute("data-artist-track-title"),l.trackId),e?(S.embedded.loadVideoById(l.trackId),F(!0)):(S.embedded.cueVideoById(l.trackId),F(!1))}function Bt(){f()?S.embedded.pauseVideo():S.embedded.playVideo()}function Yt(e=!1){e?ae(l.element.nextElementSibling?.id):F(!1)}function Ut(){let e=l.element.previousElementSibling?.id,t=S.embeddedPlayer.getCurrentTime();e!==void 0&&t<=5?(ae(e,f()),ce()):t!==0&&(S.seekTo(0),Ze.update(0,0))}function Ot(){let e=l.element.nextElementSibling?.id;e!==void 0&&(ae(e,f()),H())}function F(e){e?A(l.element,"paused","playing"):A(l.element,"playing","paused")}function xa(){f()===!1&&l.autoplayValue!==null&&(te.add(c.ULTRAFUNK,d.RESUME_AUTOPLAY,null),te.add(c.YOUTUBE,-1,l.element.nextElementSibling?.id)),f()===!1&&Yt(!0)}function Ka(){l.trackId=null,F(!1)}function Va(){$.log("initYouTubeAPI()"),window.onYouTubeIframeAPIReady=function(){$.log("onYouTubeIframeAPIReady()");let n=new YT.Player("youtube-player",{events:{onReady:$a,onStateChange:Fa,onError:ja}});S=new Ra(n),pe(_.user,S,r=>{S.seekTo(r)}),$.log(S)};let e=document.createElement("script");e.id="youtube-iframe-api",e.src="https://www.youtube.com/iframe_api";let t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}function $a(){l.element.classList.add("current"),l.autoplayValue!==null&&te.add(c.ULTRAFUNK,d.RESUME_AUTOPLAY,null),Te(Ut,Bt,Ot,Nt),Rt(l.autoplayValue!==null)}function Fa(e){switch($.log(`onYouTubePlayerStateChange(): ${e.data} - trackId: ${l.trackId}`),te.add(c.YOUTUBE,e.data,l.trackId),e.data!==YT.PlayerState.PLAYING&&U(),e.data){case YT.PlayerState.UNSTARTED:te.ytAutoplayBlocked(l.trackId,3e3)&&(F(!1),l.snackbarId=P("Autoplay blocked, Play to continue",0,"play",()=>S.embedded.playVideo()));break;case YT.PlayerState.ENDED:Ze.stop(!0),Yt(_.user.autoplay);break;case YT.PlayerState.PLAYING:qa(e),Ze.start(),ue(),F(!0);break;case YT.PlayerState.PAUSED:F(!1);break}}function qa(e){Ke(l.snackbarId),S.setDuration(Math.round(e.target.getDuration())),Ct&&(Ct=!1,l.autoplayValue=null,setTimeout(()=>{_.user.autoplay&&f()&&window.pageYOffset<1&&Ue()},5e3))}function ja(e){$.log(`onYouTubePlayerError(): ${e.data} - trackId: ${l.trackId}`),l.element.querySelector(".track-duration").innerText="Error",l.element.querySelector(".track-duration").style.display="block",te.add(c.YOUTUBE,d.PLAYER_ERROR,l.trackId),P("Unable to play track, skipping to next",5,"Stop",Ka,xa)}var Ze=(()=>{let e=-1,t=!0;return document.addEventListener("visibilitychange",()=>{t=document.visibilityState==="visible"}),{start:n,stop:r,update:u};function n(){r(),e=setInterval(()=>{t&&f()&&u(S.embedded.getCurrentTime()*1e3,S.getDuration())},250)}function r(E=!1){e!==-1&&(clearInterval(e),e=-1),E&&u(0,0)}function u(E,q){Se(E,q),W(Math.round(E/1e3),q)}})();var ne=k("playback-interaction"),oe=new Me(10),m={},Re=!1,wt=!1,M={autoplayToggleId:"footer-autoplay-toggle",crossfadeToggleId:"footer-crossfade-toggle",allowKeyboardShortcutsEvent:"allowKeyboardShortcuts",denyKeyboardShortcutsEvent:"denyKeyboardShortcuts",doubleClickDelay:500},p={playbackControls:{details:null,thumbnail:null,timer:null,statePlaying:!1},autoplayToggle:null,crossfadeToggle:null};document.addEventListener("DOMContentLoaded",()=>{ne.log("DOMContentLoaded"),Ha(),bt()?(Xa(),za(),Je(m.user.autoplay),_t(m.user.autoCrossfade)):document.getElementById("player-playlist")&&(p.autoplayToggle=document.getElementById(M.autoplayToggleId),p.crossfadeToggle=document.getElementById(M.crossfadeToggleId),Je(m.user.autoplay),vt(m,Be))});function Ha(){ne.log("readSettings()"),m=Wa(V.UF_PLAYBACK_SETTINGS,Ga,!0),ne.log(m)}function Xa(){ne.log("initInteraction()"),K.init(),Re=m.user.keyboardShortcuts,p.playbackControls.details=document.getElementById("playback-controls").querySelector(".details-control"),p.playbackControls.thumbnail=document.getElementById("playback-controls").querySelector(".thumbnail-control"),p.playbackControls.timer=document.getElementById("playback-controls").querySelector(".timer-control"),p.autoplayToggle=document.getElementById(M.autoplayToggleId),p.crossfadeToggle=document.getElementById(M.crossfadeToggleId),Oe("i.nav-bar-arrow-back","click",re,navigationUrls.prev),Oe("i.nav-bar-arrow-fwd","click",re,navigationUrls.next),Oe("nav.post-navigation .nav-previous a","click",re,navigationUrls.prev),Oe("nav.post-navigation .nav-next a","click",re,navigationUrls.next),document.addEventListener(M.allowKeyboardShortcutsEvent,()=>{m.user.keyboardShortcuts&&(Re=!0)}),document.addEventListener(M.denyKeyboardShortcutsEvent,()=>{m.user.keyboardShortcuts&&(Re=!1)}),document.addEventListener("keydown",Za),window.addEventListener("blur",Ja)}function za(){kt(m),x(s.READY,Qa),x(s.MEDIA_SHOW,Mt),x(s.MEDIA_ENDED,Mt),x(s.MEDIA_TIME_REMAINING,en)}function Za(e){if(wt&&Re&&e.repeat===!1&&e.ctrlKey===!1&&e.altKey===!1){switch(e.code){case"Backquote":Vt(e);break}switch(e.key){case" ":e.preventDefault(),Q();break;case"ArrowLeft":tn(e);break;case"ArrowRight":an(e);break;case"A":Be(e);break;case"f":case"F":e.preventDefault(),K.toggle(document.getElementById(h().iframeId));break;case"m":case"M":e.preventDefault(),ze(),P(m.user.masterMute?"Volume is muted (<b>m</b> to unmute)":"Volume is unmuted (<b>m</b> to mute)",3);break;case"x":case"X":p.crossfadeToggle.classList.contains("disabled")===!1&&xt(e);break}}}function tn(e){e.preventDefault(),e.shiftKey===!0?re(e,navigationUrls.prev):(oe.add(c.KEYBOARD,d.KEY_ARROW_LEFT,null),nn(navigationUrls.prev,h())||Xe(e))}function nn(e,t){return e!==null&&t.currentTrack===1&&t.isPlaying===!1&&(Ye("showLeftArrowHint","<b>Tip:</b> Double click the Left Arrow key to go to the previous page"),oe.doubleClicked(c.KEYBOARD,d.KEY_ARROW_LEFT,M.doubleClickDelay))?(z(e,!1),!0):!1}function an(e){e.preventDefault(),e.shiftKey===!0?re(e,navigationUrls.next):(oe.add(c.KEYBOARD,d.KEY_ARROW_RIGHT,null),on(navigationUrls.next,h())||Ce(e))}function on(e,t){return e!==null&&t.currentTrack===t.numTracks&&(Ye("showRightArrowHint","<b>Tip:</b> Double click the Right Arrow key to go to the next page"),oe.doubleClicked(c.KEYBOARD,d.KEY_ARROW_RIGHT,M.doubleClickDelay))?(z(e,t.isPlaying),!0):!1}function Ye(e,t,n=0){m.priv.tips[e]&&(P(t,n),m.priv.tips[e]=!1)}function Qa(){p.playbackControls.details.addEventListener("click",Kt),p.playbackControls.thumbnail.addEventListener("click",Kt),p.playbackControls.timer.addEventListener("click",Be),p.autoplayToggle.addEventListener("click",Be),p.crossfadeToggle.addEventListener("click",xt),document.addEventListener("visibilitychange",rn),m.user.keepMobileScreenOn&&It(m),wt=!0}function Mt(){m.user.autoExitFullscreen&&K.exit()}function en(e){m.user.autoExitFsOnWarning&&e.data.timeRemainingSeconds<=m.user.timeRemainingSeconds&&K.exit()}function Ja(){setTimeout(()=>{document.activeElement instanceof HTMLIFrameElement&&setTimeout(()=>{document.activeElement.blur(),document.activeElement instanceof HTMLIFrameElement&&document.activeElement.blur()},250)},0)}function rn(){document.visibilityState==="visible"?(m.user.autoResumePlayback&&p.playbackControls.statePlaying&&h().isPlaying===!1&&Q(),m.user.keepMobileScreenOn&&Dt()):document.visibilityState==="hidden"&&(m.user.autoResumePlayback&&h().isPlaying?p.playbackControls.statePlaying=!0:p.playbackControls.statePlaying=!1)}function Kt(e){Vt(e),oe.add(c.MOUSE,d.MOUSE_CLICK,null),e.target.tagName.toLowerCase()==="img"?Ye("showTrackImageHint","<b>Tip:</b> Double click or tap on the Track Thumbnail for full screen"):Ye("showDetailsHint","<b>Tip:</b> Double click or tap on Artist &amp; Title for full screen"),oe.doubleClicked(c.MOUSE,d.MOUSE_CLICK,M.doubleClickDelay)&&K.enter(document.getElementById(h().iframeId))}function re(e,t){e!==null&&t!==null&&(e.preventDefault(),z(t,h().isPlaying))}function Vt(e){e.preventDefault(),je(h().trackId)}function Be(e){e.preventDefault(),m.user.autoplay=m.user.autoplay!==!0,P(m.user.autoplay?"Autoplay enabled (<b>Shift</b> + <b>A</b> to disable)":"Autoplay disabled (<b>Shift</b> + <b>A</b> to enable)",5),Je(m.user.autoplay)}function Je(e){ne.log(`updateAutoplayDOM() - autoplay: ${e}`),p.autoplayToggle.querySelector(".autoplay-on-off").textContent=e?"ON":"OFF",e?A(document.body,"autoplay-off","autoplay-on"):A(document.body,"autoplay-on","autoplay-off"),e?p.crossfadeToggle.classList.remove("disabled"):p.crossfadeToggle.classList.add("disabled")}function xt(e){e.preventDefault(),m.user.autoCrossfade=m.user.autoCrossfade!==!0,P(m.user.autoCrossfade?"Auto Crossfade enabled (<b>x</b> to disable)":"Auto Crossfade disabled (<b>x</b> to enable)",5),_t(m.user.autoCrossfade)}function _t(e){ne.log(`updateCrossfadeDOM() - autoCrossfade: ${e}`),p.crossfadeToggle.querySelector(".crossfade-on-off").textContent=e?"ON":"OFF"}
//# sourceMappingURL=interaction.js.map
