import{A as rt,B as Ra,C as la,E as Ca,a as k,b as Wt,c as za,e as Ge,f as x,i as Za,j as Ze,l as w,m as z,o as P,p as F,q as me,r as A,s as xe,x as wa,y as Et,z as sa}from"../chunk-P4SX2QYP.js";var Re=k("eventlogger"),c={UNKNOWN:1e3,KEYBOARD:100,MOUSE:110,YOUTUBE:1,SOUNDCLOUD:2,ULTRAFUNK:50},d={UNKNOWN:-2e3,KEY_ARROW_LEFT:80,KEY_ARROW_RIGHT:81,MOUSE_CLICK:82,STATE_ERROR:-5,STATE_UNSTARTED:-1,STATE_ENDED:0,STATE_PLAYING:1,STATE_PAUSED:2,STATE_BUFFERING:3,STATE_CUED:5,RESUME_AUTOPLAY:50,PLAYER_ERROR:60,CROSSFADE_START:70},Kt={eventSource:c.UNKNOWN,eventType:d.UNKNOWN,uId:null,timeStamp:0},we=class{constructor(t=10){this.log=[],this.maxEntries=t,this.lastPos=0,this.matchCount=0}add(t,n,l,u=Date.now()){let E=Object.create(Kt);E.eventSource=t,E.eventType=n,E.uId=l,E.timeStamp=u,this.log.length<this.maxEntries?this.log.push(E):(this.log.shift(),this.log.push(E))}clear(){this.log=[]}initMatch(){this.lastPos=this.log.length-1,this.matchCount=0}matchesEvent(t,n,l,u=null){this.log[this.lastPos-t].eventSource===n&&this.log[this.lastPos-t].eventType===l&&this.log[this.lastPos-t].uId===u&&this.matchCount++}matchesDelta(t,n){this.log[this.lastPos].timeStamp-this.log[this.lastPos-t].timeStamp<=n&&this.matchCount++}isPatternMatch(t,n){return this.matchCount===t?(Re.log(`MATCH for: ${n}`),Re.logEventLog(this.log,c,d),!0):!1}},Me=class extends we{constructor(t){super(t)}doubleClicked(t,n,l){return this.initMatch(),this.lastPos>=1&&(this.matchesEvent(1,t,n),this.matchesEvent(0,t,n),this.matchesDelta(1,l)),this.isPatternMatch(3,`${Re.getObjectKeyForValue(c,t)} Double Clicked`)}},re=class extends we{constructor(t){super(t)}ytAutoplayBlocked(t,n){return this.initMatch(),this.lastPos>=3&&(this.matchesEvent(3,c.ULTRAFUNK,d.RESUME_AUTOPLAY,null),this.matchesEvent(2,c.YOUTUBE,d.STATE_UNSTARTED,t),this.matchesEvent(1,c.YOUTUBE,d.STATE_BUFFERING,t),this.matchesEvent(0,c.YOUTUBE,d.STATE_UNSTARTED,t),this.matchesDelta(3,n)),this.isPatternMatch(5,"YouTube Autoplay Blocked")}scAutoplayBlocked(t,n){return this.initMatch(),this.lastPos>=3&&(this.matchesEvent(3,c.ULTRAFUNK,d.RESUME_AUTOPLAY,null),this.matchesEvent(2,c.SOUNDCLOUD,d.STATE_PLAYING,t),this.matchesEvent(1,c.SOUNDCLOUD,d.STATE_PAUSED,t),this.matchesEvent(0,c.SOUNDCLOUD,d.STATE_PAUSED,t),this.matchesDelta(3,n)),this.isPatternMatch(5,"SoundCloud Autoplay Blocked")}scWidgetPlayBlocked(t,n){return this.initMatch(),this.lastPos>=2&&(this.matchesEvent(2,c.SOUNDCLOUD,d.STATE_PLAYING,t),this.matchesEvent(1,c.SOUNDCLOUD,d.STATE_PAUSED,t),this.matchesEvent(0,c.SOUNDCLOUD,d.STATE_PAUSED,t),this.matchesDelta(2,n)),this.isPatternMatch(4,"SoundCloud WidgetPlay Blocked")}scPlayDoubleTrigger(t,n){return this.initMatch(),this.lastPos>=2&&(this.matchesEvent(2,c.ULTRAFUNK,d.CROSSFADE_START,null),this.matchesEvent(1,c.SOUNDCLOUD,d.STATE_PLAYING,t),this.matchesEvent(0,c.SOUNDCLOUD,d.STATE_PLAYING,t),this.matchesDelta(1,n)),this.isPatternMatch(4,"SoundCloud Play Double Trigger")}};var ye=k("playback-controls"),W={},se={},pe={progressControlsId:"progress-controls",playbackControlsId:"playback-controls"},i={DISABLED:{CLASS:"state-disabled",ID:1},ENABLED:{CLASS:"state-enabled",ID:2},PLAYING:{CLASS:"state-playing",ID:3},PAUSED:{CLASS:"state-paused",ID:4}},a={progressSeek:{element:null,STATE:i.DISABLED,click:null},progressBar:{element:null,STATE:i.DISABLED},details:{element:null,STATE:i.DISABLED,artistElement:null,titleElement:null},thumbnail:{element:null,STATE:i.DISABLED,img:null},timer:{element:null,STATE:i.DISABLED,positionElement:null,durationElement:null,positionSeconds:-1,durationSeconds:-1},prevTrack:{element:null,STATE:i.DISABLED},playPause:{element:null,STATE:i.DISABLED,iconElement:null},nextTrack:{element:null,STATE:i.DISABLED},shuffle:{element:null,STATE:i.DISABLED},mute:{element:null,STATE:i.DISABLED,iconElement:null}};function Te(e,t,n){ye.log("init()"),W=e,se=t;let l=document.getElementById(pe.progressControlsId);l!==null?(a.progressSeek.element=l.querySelector(".seek-control"),a.progressSeek.click=n,a.progressBar.element=l.querySelector(".bar-control")):ye.error(`init(): Unable to getElementById() for '#${pe.progressControlsId}'`);let u=document.getElementById(pe.playbackControlsId);u!==null?(a.details.element=u.querySelector(".details-control"),a.details.artistElement=a.details.element.querySelector(".details-artist"),a.details.titleElement=a.details.element.querySelector(".details-title"),a.thumbnail.element=u.querySelector(".thumbnail-control"),a.thumbnail.img=a.thumbnail.element.querySelector("img"),a.timer.element=u.querySelector(".timer-control"),a.timer.positionElement=a.timer.element.querySelector(".timer-position"),a.timer.durationElement=a.timer.element.querySelector(".timer-duration"),a.prevTrack.element=u.querySelector(".prev-control"),a.playPause.element=u.querySelector(".play-pause-control"),a.playPause.iconElement=a.playPause.element.querySelector("i"),a.nextTrack.element=u.querySelector(".next-control"),a.shuffle.element=u.querySelector(".shuffle-control"),a.mute.element=u.querySelector(".mute-control"),a.mute.iconElement=a.mute.element.querySelector("i")):ye.error(`init(): Unable to getElementById() for '#${pe.playbackControlsId}'`)}function Se(e,t,n,l){ye.log("ready()"),b(a.progressSeek,i.ENABLED),a.progressSeek.element.addEventListener("click",jt),b(a.progressBar,i.ENABLED),b(a.details,i.ENABLED),b(a.thumbnail,i.ENABLED),b(a.timer,i.ENABLED),W.trackThumbnailOnMobile&&a.thumbnail.element.classList.add("show-on-mobile"),W.trackTimesOnMobile&&a.timer.element.classList.add("show-on-mobile"),b(a.prevTrack,i.DISABLED),a.prevTrack.element.addEventListener("click",e),b(a.playPause,i.PAUSED),a.playPause.element.addEventListener("click",t),b(a.nextTrack,se.getNumTracks()>1?i.ENABLED:i.DISABLED),a.nextTrack.element.addEventListener("click",n),b(a.shuffle,i.ENABLED),b(a.mute,i.ENABLED),a.mute.element.addEventListener("click",l),Je(),Ze("autoplay",qt),Ze("masterMute",Je)}function b(e,t=t.DISABLED){P(e.element,e.STATE.CLASS,t.CLASS),e.STATE=t}function ke(e,t){_e(t===0?0:e/(t*1e3))}function le(e){_e(e/100)}function _e(e){a.progressBar.element.style.transform=`scaleX(${e})`}function jt(e){if(a.timer.durationSeconds>0){let t=e.clientX/document.documentElement.clientWidth*100,n=Math.round(a.timer.durationSeconds*t/100);a.progressSeek.click(n),f()===!1&&(le(t),H(n,a.timer.durationSeconds))}}function Ve(e){a.details.artistElement.textContent=e.artist||"",a.details.titleElement.textContent=e.title||"",Gt(e.thumbnail),H(-1,-1)}function Gt(e){e.src!==a.thumbnail.img.src&&(a.thumbnail.element.classList.remove("type-default","type-youtube","type-soundcloud"),a.thumbnail.element.classList.add("loading",e.class),a.thumbnail.img.src=e.src,a.thumbnail.img.decode().then(()=>a.thumbnail.element.classList.remove("loading")))}function H(e,t){e!==-1&&a.timer.positionSeconds!==e?(a.timer.positionSeconds=e,W.autoplay===!1&&(e=t-e),be(a.timer.positionElement,e)):e===-1&&a.timer.positionSeconds===-1&&(a.timer.positionElement.textContent="00:00"),t!==-1&&a.timer.durationSeconds!==t?(a.timer.durationSeconds=t,be(a.timer.durationElement,t)):t===-1&&a.timer.durationSeconds===-1&&(a.timer.durationElement.textContent="00:00")}function be(e,t){let n=new Date(t*1e3).toISOString();e.textContent=t>60*60?n.substr(11,8):n.substr(14,5)}function Qe(){a.timer.positionElement.textContent="00:00",a.timer.durationElement.textContent="00:00",a.timer.positionSeconds=0,a.timer.durationSeconds=0}function f(){return a.playPause.STATE.ID===i.PLAYING.ID}function ie(){let e=se.getStatus();Qe(),Ve(e),f()===!1&&e.currentTrack<=1&&b(a.prevTrack,i.DISABLED),e.currentTrack<e.numTracks&&b(a.nextTrack,i.ENABLED)}function ue(){let e=se.getStatus();b(a.playPause,i.PLAYING),a.playPause.iconElement.textContent="pause_circle_filled",b(a.prevTrack,i.ENABLED),Ve(e)}function O(){b(a.playPause,i.PAUSED),a.playPause.iconElement.textContent="play_circle_filled"}function Ae(e){e?a.playPause.element.classList.toggle("time-remaining-warning"):a.playPause.element.classList.remove("time-remaining-warning")}function X(){let e=se.getStatus();Qe(),Ve(e),b(a.prevTrack,i.ENABLED),e.currentTrack>=e.numTracks&&b(a.nextTrack,i.DISABLED)}function Je(){a.mute.iconElement.textContent=W.masterMute?"volume_off":"volume_up"}function qt(){f()===!1&&a.timer.positionSeconds!==-1&&a.timer.durationSeconds!==-1&&(be(a.timer.positionElement,W.autoplay?a.timer.positionSeconds:a.timer.durationSeconds-a.timer.positionSeconds),be(a.timer.durationElement,a.timer.durationSeconds))}var ce=k("playback-events"),Pe={},$e={nowPlayingIconsSelector:"h2.entry-title"},he={nowPlayingIcons:null,snackbarId:0},r={LOADING:"loading",READY:"ready",MEDIA_PLAYING:"mediaPlaying",MEDIA_PAUSED:"mediaPaused",MEDIA_ENDED:"mediaEnded",MEDIA_TIME_REMAINING:"mediaTimeRemaining",MEDIA_SHOW:"mediaShow",MEDIA_UNAVAILABLE:"mediaUnavailable",CONTINUE_AUTOPLAY:"continueAutoplay",RESUME_AUTOPLAY:"resumeAutoplay",AUTOPLAY_BLOCKED:"autoplayBlocked",PLAYBACK_BLOCKED:"playbackBlocked"},Fe={[r.LOADING]:[Ht],[r.READY]:[Xt],[r.MEDIA_PLAYING]:[zt],[r.MEDIA_PAUSED]:[Zt],[r.MEDIA_ENDED]:[et],[r.MEDIA_TIME_REMAINING]:[Jt],[r.MEDIA_SHOW]:[Qt],[r.CONTINUE_AUTOPLAY]:[ea],[r.RESUME_AUTOPLAY]:[ta],[r.AUTOPLAY_BLOCKED]:[aa],[r.PLAYBACK_BLOCKED]:[na],[r.MEDIA_UNAVAILABLE]:[oa]};function tt(e){ce.log("init()"),Pe=e,he.nowPlayingIcons=document.querySelectorAll($e.nowPlayingIconsSelector)}function $(e,t){e in Fe&&Fe[e].push(t)}function h(e,t=null,n=null){Fe[e].forEach(l=>{l({event:e,data:t,callback:n})})}function Ht(e){le(e.data.loadingPercent)}function Xt(e){B(e),le(0)}function zt(e){if(B(e),xe(he.snackbarId),e.data.numTracks>1){let t=document.querySelector(`#${e.data.trackId} ${$e.nowPlayingIconsSelector}`);at(t),P(t,"playing-paused","now-playing-icon"),Pe.user.animateNowPlayingIcon&&t.classList.add("playing-animate")}}function Zt(e){B(e),e.data.numTracks>1&&document.querySelector(`#${e.data.trackId} ${$e.nowPlayingIconsSelector}`).classList.add("playing-paused")}function et(e){B(e),le(0),e!==null&&e.data.numTracks>1&&at()}function Jt(){}function Qt(e){B(e),et(null),e.data.scrollToMedia&&Ke(e.data.trackId)}function ea(e){B(e),j(navigationVars.next,!0)}function ta(e){let t=sessionStorage.getItem(x.UF_AUTOPLAY);sessionStorage.removeItem(x.UF_AUTOPLAY),B(e),ce.log(`RESUME_AUTOPLAY: ${t!==null?"true":"false"}`),t!==null&&e.callback.resumeAutoplay()}function aa(e){B(e),he.snackbarId=A("Autoplay blocked, Play to continue",0,"play",()=>{e.data.isPlaying===!1&&e.callback.togglePlayPause()})}function na(e){B(e),A("Unable to play track, skipping to next",5,"Stop",()=>{},()=>je(e))}function oa(e){B(e),ra(e.data.trackId)?A("YouTube Premium track, skipping",5,"help",()=>{window.location.href="/channel/premium/"},()=>je(e)):(A("Unable to play track, skipping to next",5,"Stop",()=>{},()=>je(e)),Wt("EVENT_MEDIA_UNAVAILABLE",e.data))}function B(e=null){ce.isDebug()&&e!==null&&ce.log(e)}function at(e){he.nowPlayingIcons.forEach(t=>{t!==e&&t.classList.remove("now-playing-icon","playing-animate","playing-paused")})}function je(e){e.data.currentTrack<e.data.numTracks?e.callback.skipToTrack(e.data.currentTrack+1,!0):navigationVars.next!==null&&j(navigationVars.next,!0)}function ra(e){let t=document.getElementById(e);return t!==null?t.classList.contains("category-premium"):!1}function j(e,t=!1){ce.log(`navigateTo(): ${e} - continueAutoplay: ${t}`),e!=null&&e.length>0&&(t&&sessionStorage.setItem(x.UF_AUTOPLAY,"true"),window.location.href=e)}function Ke(e){if(Pe.user.autoScroll){let t=Math.round(window.scrollY+document.getElementById(e).getBoundingClientRect().top),n=Math.round(window.pageYOffset),l=nt(t>n);n+l+ot()>t&&(l=nt(!1)),window.scroll({top:t-(l+ot()),left:0,behavior:Pe.user.smoothScrolling?"smooth":"auto"})}}function nt(e){return e?z("--site-header-height-down"):z("--site-header-height-up")}function ot(){return z("--site-content-margin-top")-1}var T=k("embedded-players"),Y=new re(10),L=null,qe=0,st=1,de,g,D,V,Z={trackCountData:"data-track-count",youTubeIframeIdRegEx:/youtube-uid/i,soundCloudIframeIdRegEx:/soundcloud-uid/i,entriesSelector:"single-track",artistTrackTitleData:"data-artist-track-title",maxPlaybackStartDelay:3};function lt(e){({settings:de=null,players:g=null,playbackState:D=null,playbackTimer:V=null}=e),ia(),ua()}function it(e){let t=parseInt(document.body.getAttribute(Z.trackCountData));return T.log(`getTrackCount(): ${t}`),qe=t+3,L=e,t}function Le(){return{loadingPercent:100*(st++/qe)}}function ut(){st>=qe?L(r.READY):L(r.LOADING,Le())}function Ta(){document.querySelectorAll(Z.entriesSelector).forEach(t=>{let n=t.querySelector("iframe"),l={};if(Z.youTubeIframeIdRegEx.test(n.id)){let u=new YT.Player(n.id,{events:{onReady:ca,onStateChange:da,onError:ga}});l=new sa(t.id,n.id,u,n.src)}else if(Z.soundCloudIframeIdRegEx.test(n.id)){let u=SC.Widget(n.id);l=new rt(t.id,n.id,u,n.src),u.bind(SC.Widget.Events.READY,()=>{l.setThumbnail(),ma()}),u.bind(SC.Widget.Events.PLAY,fa),u.bind(SC.Widget.Events.PAUSE,Ea),u.bind(SC.Widget.Events.FINISH,ya),u.bind(SC.Widget.Events.ERROR,pa)}la(t.getAttribute(Z.artistTrackTitleData),l),g.add(l)})}function Ie(e,t){T.log("onPlayerError()"),T.log(e);let n=e instanceof rt?c.SOUNDCLOUD:c.YOUTUBE;g.isCurrent(e.getUid())===!1&&g.stop(),Y.add(n,d.PLAYER_ERROR,e.getUid()),L(r.MEDIA_UNAVAILABLE,Sa(e,t))}function Sa(e,t){let n=e.getArtist()||"N/A",l=e.getTitle()||"N/A";return{currentTrack:g.trackFromUid(e.getUid()),numTracks:g.getNumTracks(),trackId:e.getTrackId(),mediaTitle:`${n} - ${l}`,mediaUrl:t}}function ia(){T.log("initYouTubeAPI()"),L(r.LOADING,Le()),window.onYouTubeIframeAPIReady=function(){T.log("onYouTubeIframeAPIReady()"),L(r.LOADING,Le()),Ta()};let e=document.createElement("script");e.id="youtube-iframe-api",e.src="https://www.youtube.com/iframe_api";let t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}function ca(){T.log("onYouTubePlayerReady()"),ut()}function da(e){switch(Y.add(c.YOUTUBE,e.data,e.target.h.id),e.data){case YT.PlayerState.UNSTARTED:ka(e);break;case YT.PlayerState.BUFFERING:ba(e);break;case YT.PlayerState.PLAYING:Aa(e);break;case YT.PlayerState.PAUSED:Pa(e);break;case YT.PlayerState.CUED:ha(e);break;case YT.PlayerState.ENDED:La(e);break}}function ka(e){T.log(`onYouTubePlayerStateChange: UNSTARTED (uID: ${e.target.h.id})`),Y.ytAutoplayBlocked(e.target.h.id,3e3)&&L(r.AUTOPLAY_BLOCKED)}function ba(e){if(T.log(`onYouTubePlayerStateChange: BUFFERING (uID: ${e.target.h.id})`),g.crossfade.isFading()===!1){let t=g.playerFromUid(e.target.h.id);t.mute(de.masterMute),t.setVolume(de.masterVolume)}}function Aa(e){T.log(`onYouTubePlayerStateChange: PLAYING   (uID: ${e.target.h.id})`),D.syncAll(e.target.h.id,D.STATE.PLAY),g.current.setDuration(Math.round(e.target.getDuration())),V.start()}function Pa(e){T.log(`onYouTubePlayerStateChange: PAUSED    (uID: ${e.target.h.id})`),g.isCurrent(e.target.h.id)?(D.syncAll(e.target.h.id,D.STATE.PAUSE),V.stop(!1)):g.crossfade.stop()}function ha(e){T.log(`onYouTubePlayerStateChange: CUED      (uID: ${e.target.h.id})`)}function La(e){T.log(`onYouTubePlayerStateChange: ENDED     (uID: ${e.target.h.id})`),g.isCurrent(e.target.h.id)?(V.stop(!0),L(r.MEDIA_ENDED)):g.crossfade.stop()}function ga(e){T.log("onYouTubePlayerError: "+e.data);let t=g.playerFromUid(e.target.h.id);t.setPlayable(!1),Ie(t,e.target.getVideoUrl())}function ua(){T.log("initSoundCloudAPI()"),L(r.LOADING,Le())}function ma(){T.log("onSoundCloudPlayerEventReady()"),ut()}function fa(e){T.log(`onSoundCloudPlayerEvent: PLAY   (uID: ${e.soundId})`),Y.add(c.SOUNDCLOUD,d.STATE_PLAYING,e.soundId),g.crossfade.isFading()&&g.isCurrent(e.soundId)?Y.scPlayDoubleTrigger(e.soundId,Z.maxPlaybackStartDelay*1e3)&&D.syncAll(e.soundId,D.STATE.PLAY):(D.syncAll(e.soundId,D.STATE.PLAY),g.current.mute(de.masterMute),g.current.setVolume(de.masterVolume)),g.current.getEmbeddedPlayer().getDuration(t=>{g.current.setDuration(Math.round(t/1e3)),V.start()})}function Ea(e){T.log(`onSoundCloudPlayerEvent: PAUSE  (uID: ${e.soundId})`),Y.add(c.SOUNDCLOUD,d.STATE_PAUSED,e.soundId),Y.scAutoplayBlocked(e.soundId,3e3)?(V.stop(!1),L(r.AUTOPLAY_BLOCKED)):Y.scWidgetPlayBlocked(e.soundId,3e4)?(V.stop(!1),L(r.PLAYBACK_BLOCKED,{currentTrack:g.trackFromUid(e.soundId),numTracks:g.getNumTracks()})):g.isCurrent(e.soundId)?g.current.getPosition(t=>{t>0&&(D.syncAll(e.soundId,D.STATE.PAUSE),V.stop(!1))}):g.crossfade.stop()}function ya(e){T.log(`onSoundCloudPlayerEvent: FINISH (uID: ${e.soundId})`),g.isCurrent(e.soundId)?(V.stop(!0),L(r.MEDIA_ENDED)):g.crossfade.stop()}function pa(){this.getCurrentSound(e=>{let t=g.playerFromUid(e.id);T.log(`onSoundCloudPlayerEvent: ERROR for track: ${g.trackFromUid(e.id)}. ${t.getArtist()} - ${t.getTitle()} - [${t.getUid()} / ${t.getIframeId()}]`),t.setPlayable(!1)})}var We=k("crossfade-controls"),ct={},De={},J={crossfadePresetSelector:".crossfade-controls .preset-control",crossfadePresetData:"data-crossfade-preset",crossfadeToSelector:".crossfade-controls .fadeto-control"},I={crossfadePreset:{elements:null},crossfadeTo:{elements:null,click:null}};function gt(e,t,n){We.log("init()"),ct=e,De=t,I.crossfadePreset.elements=document.querySelectorAll(J.crossfadePresetSelector),I.crossfadeTo.elements=document.querySelectorAll(J.crossfadeToSelector),I.crossfadePreset.elements.length>1&&I.crossfadeTo.elements.length>1&&(I.crossfadePreset.elements.forEach(l=>dt(l,ct.trackCrossfadeDefPreset)),I.crossfadeTo.click=n)}function ft(){We.log("ready()"),I.crossfadePreset.elements.length>1&&I.crossfadeTo.elements.length>1&&(I.crossfadePreset.elements.forEach(e=>{e.addEventListener("click",Ia),P(e,i.DISABLED.CLASS,i.ENABLED.CLASS)}),I.crossfadeTo.elements.forEach(e=>e.addEventListener("click",Da)),$(r.MEDIA_PLAYING,mt),$(r.MEDIA_PAUSED,mt))}function dt(e,t){e.setAttribute(J.crossfadePresetData,t),e.textContent=`${t+1}`,e.title=`Preset: ${Ge.crossfade[t].name}`}function Ia(e){let t=parseInt(e.target.getAttribute(J.crossfadePresetData));t+1<Ge.crossfade.length?t++:t=0,dt(e.target,t)}function Da(e){if(f()&&De.crossfade.isFading()===!1){let t=e.target.closest("single-track");if(t!==null){let n=t.querySelector("iframe"),l=t.querySelector(J.crossfadePresetSelector).getAttribute(J.crossfadePresetData);P(e.target.closest("div.fadeto-control"),i.ENABLED.CLASS,i.DISABLED.CLASS),I.crossfadeTo.click(De.uIdFromIframeId(n.id),Ge.crossfade[l])}}}function mt(){let e=f(),t=e?De.getStatus().currentTrack:-1;We.log(`updateCrossfadeToState() - playingState: ${e} - currentTrack: ${t}`),I.crossfadeTo.elements.forEach((n,l)=>{t===l+1?P(n,e?i.ENABLED.CLASS:i.DISABLED.CLASS,e?i.DISABLED.CLASS:i.ENABLED.CLASS):P(n,e?i.DISABLED.CLASS:i.ENABLED.CLASS,e?i.ENABLED.CLASS:i.DISABLED.CLASS)})}var R=k("playback"),ge=null,y={},o={},Ce={updateTimerInterval:200,minCrossfadeToTime:5,maxBufferingDelay:3};function Tt(e){ge=Y,y=e.user,tt(e),o=Ca(),o.init(y,Na),Te(y,o,va),gt(y,o,Ua),lt({settings:y,players:o,playbackState:yt,playbackTimer:pt})}function St(){return it(Oa)>0}function Q(){f()?(O(),o.current.pause()):(ue(),o.current.play(Ie))}function Ba(e){R.log(`prevClick() - prevTrack: ${o.getCurrentTrack()-1} - numTracks: ${o.getNumTracks()} - event: ${e!==null?e.type:"null"}`),o.getCurrentTrack()>0&&o.current.getPosition(t=>{t>5e3?(o.current.seekTo(0),pt.updateCallback(0)):(o.getCurrentTrack()>1&&o.stop(),o.prevTrack(f())&&ie())})}function kt(e){R.log(`nextClick() - nextTrack: ${o.getCurrentTrack()+1} - numTracks: ${o.getNumTracks()} - event: ${e!==null?e.type:"null"}`),o.getCurrentTrack()+1<=o.getNumTracks()?(o.stop(),e!==null||y.autoplay?o.nextTrack(f())&&X():O()):e===null&&(O(),y.autoplay?h(r.CONTINUE_AUTOPLAY):o.stop())}function va(e){o.current.seekTo(e)}function He(){y.masterMute=y.masterMute!==!0,o.mute()}function Na(e,t=!0){h(r.MEDIA_SHOW,{scrollToMedia:t,trackId:o.current.getTrackId()}),e&&o.current.play(Ie)}function bt(e,t=!0){R.log(`skipToTrack(): ${e} - ${t}`),t===!0&&f()===!1&&(ge.clear(),ge.add(c.ULTRAFUNK,d.RESUME_AUTOPLAY,null),o.jumpToTrack(e,t)&&X())}function Ya(){R.log("resumeAutoplay()"),ge.add(c.ULTRAFUNK,d.RESUME_AUTOPLAY,null),Q()}function C(){return{isPlaying:f(),currentTrack:o.getCurrentTrack(),numTracks:o.getNumTracks(),trackId:o.current.getTrackId(),iframeId:o.current.getIframeId()}}function Oa(e,t=null){switch(R.isDebug()&&e!==r.LOADING&&(R.log(`embeddedEventHandler(): ${e}`),t!==null&&R.log(t)),e){case r.LOADING:h(r.LOADING,t);break;case r.READY:Se(Ba,Q,kt,He),ft(),h(r.READY),h(r.RESUME_AUTOPLAY,null,{resumeAutoplay:Ya});break;case r.MEDIA_ENDED:kt(null);break;case r.AUTOPLAY_BLOCKED:O(),h(r.AUTOPLAY_BLOCKED,C(),{togglePlayPause:Q});break;case r.PLAYBACK_BLOCKED:O(),h(r.PLAYBACK_BLOCKED,t,{skipToTrack:bt});break;case r.MEDIA_UNAVAILABLE:O(),h(r.MEDIA_UNAVAILABLE,t,{skipToTrack:bt});break}}var yt=(()=>{let e={PLAY:1,PAUSE:2},t=function l(u,E){if(R.log(`playbackState.syncAll() - previousTrack: ${o.getPlayerIndex()+1} - nextTrack: ${o.indexMap.get(u)+1} - syncState: ${R.getObjectKeyForValue(e,E)}`),o.isCurrent(u))E===e.PLAY?(o.crossfade.start(),ue(),h(r.MEDIA_PLAYING,C())):E===e.PAUSE&&(o.crossfade.stop(),O(),h(r.MEDIA_PAUSED,C()));else{let G=o.getPlayerIndex(),Ee=o.indexMap.get(u);o.stop(),o.setPlayerIndex(Ee),n(G,Ee),l(u,E)}};function n(l,u){u>l?X():ie()}return{STATE:e,syncAll:t,syncControls:n}})(),pt=(()=>{let e=-1,t=0,n=!0;return document.addEventListener("visibilitychange",()=>{n=document.visibilityState==="visible"}),{start:l,stop:u,updateCallback:E};function l(){u(!1),e=setInterval(()=>{n&&o.current.getPosition(E)},Ce.updateTimerInterval)}function u(U=!1){e!==-1&&(clearInterval(e),e=-1),U&&(E(0),h(r.MEDIA_ENDED,C())),t=0,Ae(!1)}function E(U,_=0){let K=Math.round(U/1e3);ke(U,_),H(K,_),K>0&&_>0&&(G(K,_),Ee(K,_))}function G(U,_){if(y.autoplay===!1&&y.timeRemainingWarning&&t!==U){let K=_-U;t=U,K<=y.timeRemainingSeconds?(Ae(!0),h(r.MEDIA_TIME_REMAINING,{timeRemainingSeconds:K})):Ae(!1)}}function Ee(U,_){y.masterMute===!1&&y.autoplay&&y.autoCrossfade&&_-U===y.autoCrossfadeLength+Ce.maxBufferingDelay&&o.getCurrentTrack()+1<=o.getNumTracks()&&At(Et.AUTO,{name:"Auto Crossfade",length:y.autoCrossfadeLength,curve:y.autoCrossfadeCurve})}})();function Ua(e,t){o.isCurrent(e)===!1&&o.current.getDuration()>0&&(R.log(`crossfadeToClick():
fadeOut: ${o.current.getArtist()} - "${o.current.getTitle()}" (${o.current.getUid()})
fadeIn.: ${o.playerFromUid(e).getArtist()} - "${o.playerFromUid(e).getTitle()}" (${e})`),y.masterMute===!1&&y.autoplay===!1&&o.current.getPosition(n=>{o.current.getDuration()-n/1e3>=Ce.minCrossfadeToTime+Ce.maxBufferingDelay&&At(Et.TRACK,t,e)}))}function At(e,t,n=null){ge.add(c.ULTRAFUNK,d.CROSSFADE_START,null);let l=o.crossfade.init(e,t,n);l!==null&&yt.syncControls(l.fadeOutPlayer,l.fadeInPlayer)}var ee=k("screen-wakelock"),ve=null;function Pt(){return"wakeLock"in navigator&&"request"in navigator.wakeLock}async function Lt(e){Pt()?document.visibilityState==="visible"&&await ht()!==!0&&ee.log("enable(): Screen Wake Lock request failed"):(ee.log("enable(): Screen Wake Lock is not supported"),A("Keep Screen On is not supported",5,"Turn Off",()=>e.user.keepMobileScreenOn=!1))}function It(){ee.log("stateVisible()"),Pt()&&ve===null&&ht()}async function ht(){try{return ve=await navigator.wakeLock.request("screen"),ee.log("request(): Screen Wake Lock is Enabled"),ve.addEventListener("release",()=>{ee.log("request(): Screen Wake Lock was Released"),ve=null}),!0}catch(e){ee.error(`request(): ${e.name} - ${e.message}`)}return!1}var M=k("player-playlist"),te=new re(10),v={},S=null,Ne=null,Dt=!0,N={container:null,observer:null},s={trackId:null,element:null,snackbarId:0,autoplayValue:null};function Ct(e,t){M.log("init"),v=e,Ne=t,N.container=document.getElementById("tracklist-container"),N.observer=new IntersectionObserver(xa,{root:N.container}),Va()!==null?($a(),F.init(),me.init(v.user),document.addEventListener("keydown",_a),w("#playback-controls .details-control","click",Ue),w("#playback-controls .thumbnail-control","click",Ue),w("#playback-controls .timer-control","click",n=>Ne(n))):A("No playable YouTube tracks!",0,"help",()=>{window.location.href="/help/#compact-player"}),document.getElementById("footer-autoplay-toggle").addEventListener("click",n=>Ne(n)),w("i.nav-bar-arrow-back","click",Oe,navigationVars.prev),w("i.nav-bar-arrow-fwd","click",Oe,navigationVars.next),Ma()}function Ma(){N.container.addEventListener("click",e=>{let t=e.target.closest("div.thumbnail");if(t!==null)return ae(t.closest("div.track-entry").id,!0,!0);let n=e.target.closest("div.share-playon-button");if(n!==null)return Fa(n)})}function _a(e){if(me.allow()&&e.repeat===!1&&e.ctrlKey===!1&&e.altKey===!1){switch(e.code){case"Backquote":e.preventDefault(),Ue(e);break}switch(e.key){case" ":e.preventDefault(),s.trackId!==null?ae(s.trackId):ae(N.container.querySelector(".track-entry.current").id);break;case"ArrowLeft":e.preventDefault(),e.shiftKey===!1?Nt():Oe(e,navigationVars.prev);break;case"ArrowRight":e.preventDefault(),e.shiftKey===!1?Ut():Oe(e,navigationVars.next);break;case"A":Ne(e);break;case"f":case"F":e.preventDefault(),F.toggle(document.getElementById("youtube-player"));break;case"m":case"M":e.preventDefault(),vt(),A(v.user.masterMute?"Volume is muted (<b>m</b> to unmute)":"Volume is unmuted (<b>m</b> to mute)",3);break}}}function Fa(e){let t=e.closest("div.track-entry"),n=t.getAttribute("data-artist-track-title"),l=t.getAttribute("data-track-url");wa.show({string:n,filterString:!0,url:l})}function Ue(){let e=0;window.pageYOffset<1&&(e=z("--site-header-height")-z("--site-header-height-down")),window.scroll({top:e,left:0,behavior:v.user.smoothScrolling?"smooth":"auto"})}function vt(){v.user.masterMute?v.user.masterMute=!1:v.user.masterMute=!0,v.user.masterMute?S.embedded.mute():S.embedded.unMute()}function Va(){if(s.trackId=Be(),s.trackId!==null){if(s.autoplayValue=sessionStorage.getItem(x.UF_AUTOPLAY),sessionStorage.removeItem(x.UF_AUTOPLAY),s.autoplayValue!==null){let e=s.autoplayValue.match(/^[a-zA-Z0-9-_]{11}$/);e!==null&&(s.trackId=e[0])}M.log(`setCurrentIdAndElement() - autoplayValue: ${s.autoplayValue!==null?s.autoplayValue:"N/A"} - current.trackId: ${s.trackId}`),s.element=document.getElementById(s.trackId),N.observer.observe(s.element)}return s.trackId}function xa(e){N.observer.unobserve(s.element),Math.ceil(e[0].intersectionRatio*100)/100!=1&&(N.container.scrollTop=s.element.offsetTop-N.container.offsetHeight+s.element.offsetHeight)}function Oe(e,t){e.preventDefault(),j(t,f())}function Ka(){let e=s.element!==null?s.element.previousElementSibling:null;for(;e!==null&&e.id==="";)e=e.previousElementSibling;return M.log(`getPrevPlayableId(): ${e!==null?e.id:"null"}`),e!==null?e.id:null}function Be(){let e=s.element!==null?s.element.nextElementSibling:N.container.querySelector(".track-entry");for(;e!==null&&e.id==="";)e=e.nextElementSibling;return M.log(`getNextPlayableId(): ${e!==null?e.id:"null"}`),e!==null?e.id:null}function ae(e,t=!0,n=!1){M.log(`setCurrentTrack(): ${e} - playNextTrack: ${t} - isPointerClick: ${n}`),e===s.trackId?Bt():(f()&&S.embedded.stopVideo(),s.element.classList.remove("current","playing","paused"),s.trackId=e,s.element=document.getElementById(s.trackId),n===!1&&N.observer.observe(s.element),s.element.classList.add("current"),Ot(t))}function Ot(e){S.setArtistTitleThumbnail(s.element.getAttribute("data-artist-track-title"),s.trackId),e?(S.embedded.loadVideoById(s.trackId),q(!0)):(S.embedded.cueVideoById(s.trackId),q(!1))}function Bt(){f()?S.embedded.pauseVideo():S.embedded.playVideo()}function Yt(e=!1){let t=Be();t===null?j(navigationVars.next,e):e?ae(t):q(!1)}function Nt(){let e=Ka(),t=S.embeddedPlayer.getCurrentTime();e!==null&&t<=5?(ae(e,f()),ie()):t!==0&&(S.seekTo(0),Xe.update(0,0))}function Ut(){let e=Be();e!==null&&(ae(e,f()),X())}function q(e){e?P(s.element,"paused","playing"):P(s.element,"playing","paused")}function ja(){f()===!1&&s.autoplayValue!==null&&(te.add(c.ULTRAFUNK,d.RESUME_AUTOPLAY,null),te.add(c.YOUTUBE,-1,Be())),f()===!1&&Yt(!0)}function qa(){s.trackId=null,q(!1)}function $a(){M.log("initYouTubeAPI()"),window.onYouTubeIframeAPIReady=function(){M.log("onYouTubeIframeAPIReady()");let n=new YT.Player("youtube-player",{events:{onReady:Ga,onStateChange:Wa,onError:Ha}});S=new Ra(n),Te(v.user,S,l=>{S.seekTo(l)}),M.log(S)};let e=document.createElement("script");e.id="youtube-iframe-api",e.src="https://www.youtube.com/iframe_api";let t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}function Ga(){s.element.classList.add("current"),s.autoplayValue!==null&&te.add(c.ULTRAFUNK,d.RESUME_AUTOPLAY,null),Se(Nt,Bt,Ut,vt),Ot(s.autoplayValue!==null)}function Wa(e){switch(M.log(`onYouTubePlayerStateChange(): ${e.data} - trackId: ${s.trackId}`),te.add(c.YOUTUBE,e.data,s.trackId),e.data!==YT.PlayerState.PLAYING&&O(),e.data){case YT.PlayerState.UNSTARTED:te.ytAutoplayBlocked(s.trackId,3e3)&&(q(!1),s.snackbarId=A("Autoplay blocked, Play to continue",0,"play",()=>S.embedded.playVideo()));break;case YT.PlayerState.ENDED:Xe.stop(!0),Yt(v.user.autoplay);break;case YT.PlayerState.PLAYING:Xa(e),Xe.start(),ue(),q(!0);break;case YT.PlayerState.PAUSED:q(!1);break}}function Xa(e){xe(s.snackbarId),S.setDuration(Math.round(e.target.getDuration())),Dt&&(Dt=!1,s.autoplayValue=null,setTimeout(()=>{v.user.autoplay&&f()&&window.pageYOffset<1&&Ue()},6e3))}function Ha(e){M.log(`onYouTubePlayerError(): ${e.data} - trackId: ${s.trackId}`),s.element.querySelector(".track-duration").innerText="Error",s.element.querySelector(".track-duration").style.display="block",te.add(c.YOUTUBE,d.PLAYER_ERROR,s.trackId),A("Unable to play track, skipping to next",5,"Stop",qa,ja)}var Xe=(()=>{let e=-1,t=!0;return document.addEventListener("visibilitychange",()=>{t=document.visibilityState==="visible"}),{start:n,stop:l,update:u};function n(){l(),e=setInterval(()=>{t&&f()&&u(S.embedded.getCurrentTime()*1e3,S.getDuration())},250)}function l(E=!1){e!==-1&&(clearInterval(e),e=-1),E&&u(0,0)}function u(E,G){Number.isNaN(E)===!1&&(ke(E,G),H(Math.round(E/1e3),G))}})();var ne=k("playback-interaction"),Rt=new Me(10),m={},wt=!1,fe={autoplayToggleId:"footer-autoplay-toggle",crossfadeToggleId:"footer-crossfade-toggle",doubleClickDelay:500},p={playbackControls:{details:null,thumbnail:null,timer:null,statePlaying:!1},autoplayToggle:null,crossfadeToggle:null};document.addEventListener("DOMContentLoaded",()=>{ne.log("DOMContentLoaded"),Ja(),St()?(Qa(),en(),ze(m.user.autoplay),Mt(m.user.autoCrossfade)):document.getElementById("player-playlist")&&(p.autoplayToggle=document.getElementById(fe.autoplayToggleId),p.crossfadeToggle=document.getElementById(fe.crossfadeToggleId),ze(m.user.autoplay),Ct(m,Ye))});function Ja(){ne.log("readSettings()"),m=Za(x.UF_PLAYBACK_SETTINGS,za,!0),ne.log(m)}function Qa(){ne.log("initInteraction()"),F.init(),me.init(m.user),p.playbackControls.details=document.getElementById("playback-controls").querySelector(".details-control"),p.playbackControls.thumbnail=document.getElementById("playback-controls").querySelector(".thumbnail-control"),p.playbackControls.timer=document.getElementById("playback-controls").querySelector(".timer-control"),p.autoplayToggle=document.getElementById(fe.autoplayToggleId),p.crossfadeToggle=document.getElementById(fe.crossfadeToggleId),w("i.nav-bar-arrow-back","click",oe,navigationVars.prev),w("i.nav-bar-arrow-fwd","click",oe,navigationVars.next),w("nav.post-navigation .nav-previous a","click",oe,navigationVars.prev),w("nav.post-navigation .nav-next a","click",oe,navigationVars.next),document.addEventListener("keydown",tn),window.addEventListener("blur",an)}function en(){Tt(m),$(r.READY,nn),$(r.MEDIA_SHOW,_t),$(r.MEDIA_ENDED,_t),$(r.MEDIA_TIME_REMAINING,on)}function tn(e){if(wt&&me.allow()&&e.repeat===!1&&e.ctrlKey===!1&&e.altKey===!1){switch(e.code){case"Backquote":Vt(e);break}switch(e.key){case" ":e.preventDefault(),Q();break;case"ArrowLeft":e.shiftKey===!0&&oe(e,navigationVars.prev);break;case"ArrowRight":e.shiftKey===!0&&oe(e,navigationVars.next);break;case"A":Ye(e);break;case"f":case"F":e.preventDefault(),F.toggle(document.getElementById(C().iframeId));break;case"m":case"M":e.preventDefault(),He(),A(m.user.masterMute?"Volume is muted (<b>m</b> to unmute)":"Volume is unmuted (<b>m</b> to mute)",3);break;case"x":case"X":p.crossfadeToggle.classList.contains("disabled")===!1&&xt(e);break}}}function nn(){p.playbackControls.details.addEventListener("click",$t),p.playbackControls.thumbnail.addEventListener("click",$t),p.playbackControls.timer.addEventListener("click",Ye),p.autoplayToggle.addEventListener("click",Ye),p.crossfadeToggle.addEventListener("click",xt),document.addEventListener("visibilitychange",rn),m.user.keepMobileScreenOn&&Lt(m),wt=!0}function _t(){m.user.autoExitFullscreen&&F.exit()}function on(e){m.user.autoExitFsOnWarning&&e.data.timeRemainingSeconds<=m.user.timeRemainingSeconds&&F.exit()}function an(){setTimeout(()=>{document.activeElement instanceof HTMLIFrameElement&&setTimeout(()=>{document.activeElement.blur(),document.activeElement instanceof HTMLIFrameElement&&document.activeElement.blur()},250)},0)}function rn(){document.visibilityState==="visible"?(m.user.autoResumePlayback&&p.playbackControls.statePlaying&&C().isPlaying===!1&&Q(),m.user.keepMobileScreenOn&&It()):document.visibilityState==="hidden"&&(m.user.autoResumePlayback&&C().isPlaying?p.playbackControls.statePlaying=!0:p.playbackControls.statePlaying=!1)}function $t(e){Vt(e),Rt.add(c.MOUSE,d.MOUSE_CLICK,null),e.target.tagName.toLowerCase()==="img"?Ft("showTrackImageHint","<b>Tip:</b> Double click or tap on the Track Thumbnail for full screen"):Ft("showDetailsHint","<b>Tip:</b> Double click or tap on Artist &amp; Title for full screen"),Rt.doubleClicked(c.MOUSE,d.MOUSE_CLICK,fe.doubleClickDelay)&&F.enter(document.getElementById(C().iframeId))}function Ft(e,t,n=0){m.priv.tips[e]&&(A(t,n),m.priv.tips[e]=!1)}function oe(e,t){e!==null&&t!==null&&(e.preventDefault(),j(t,C().isPlaying))}function Vt(e){e.preventDefault(),Ke(C().trackId)}function Ye(e){e.preventDefault(),m.user.autoplay=m.user.autoplay!==!0,A(m.user.autoplay?"Autoplay enabled (<b>Shift</b> + <b>A</b> to disable)":"Autoplay disabled (<b>Shift</b> + <b>A</b> to enable)",5),ze(m.user.autoplay)}function ze(e){ne.log(`updateAutoplayDOM() - autoplay: ${e}`),p.autoplayToggle.querySelector(".autoplay-on-off").textContent=e?"ON":"OFF",e?P(document.body,"autoplay-off","autoplay-on"):P(document.body,"autoplay-on","autoplay-off"),e?p.crossfadeToggle.classList.remove("disabled"):p.crossfadeToggle.classList.add("disabled")}function xt(e){e.preventDefault(),m.user.autoCrossfade=m.user.autoCrossfade!==!0,A(m.user.autoCrossfade?"Auto Crossfade enabled (<b>x</b> to disable)":"Auto Crossfade disabled (<b>x</b> to enable)",5),Mt(m.user.autoCrossfade)}function Mt(e){ne.log(`updateCrossfadeDOM() - autoCrossfade: ${e}`),p.crossfadeToggle.querySelector(".crossfade-on-off").textContent=e?"ON":"OFF"}
//# sourceMappingURL=interaction.js.map
