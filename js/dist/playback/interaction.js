import{a as Xt,b as zn,c as vn,d as ot,e as le,g as Ve,h as Ie,i as _,k as oe,l as zt,m as Qt,n as M,o as k,p as Un}from"../chunk.IEH5MCKE.js";function tt(e,t){let r=t.mediaUrl+" | "+t.mediaTitle;console.log(`DEBUGLOGGER.........: logErrorOnServer(): ${e} - ${r}`),gtag("event",r,{event_category:e,event_label:"Ultrafunk Client Error"})}var Oe=k("eventlogger"),d={UNKNOWN:1e3,KEYBOARD:100,MOUSE:110,YOUTUBE:1,SOUNDCLOUD:2,ULTRAFUNK:50},g={UNKNOWN:-2e3,KEY_ARROW_LEFT:80,KEY_ARROW_RIGHT:81,MOUSE_CLICK:82,STATE_ERROR:-5,STATE_UNSTARTED:-1,STATE_ENDED:0,STATE_PLAYING:1,STATE_PAUSED:2,STATE_BUFFERING:3,STATE_CUED:5,RESUME_AUTOPLAY:50,PLAYER_ERROR:60,CROSSFADE_START:70},Kt={eventSource:d.UNKNOWN,eventType:g.UNKNOWN,uId:null,timeStamp:0},_e=class{constructor(t=10){this.log=[],this.maxEntries=t,this.lastPos=0,this.matchCount=0}add(t,r,a,i=Date.now()){let l=Object.create(Kt);l.eventSource=t,l.eventType=r,l.uId=a,l.timeStamp=i,this.log.length<this.maxEntries?this.log.push(l):(this.log.shift(),this.log.push(l))}clear(){this.log=[]}initMatch(){this.lastPos=this.log.length-1,this.matchCount=0}matchesEvent(t,r,a,i=null){this.log[this.lastPos-t].eventSource===r&&this.log[this.lastPos-t].eventType===a&&this.log[this.lastPos-t].uId===i&&this.matchCount++}matchesDelta(t,r){this.log[this.lastPos].timeStamp-this.log[this.lastPos-t].timeStamp<=r&&this.matchCount++}isPatternMatch(t,r){return this.matchCount===t?(Oe.log(`MATCH for: ${r}`),Oe.logEventLog(this.log,d,g),!0):!1}},Re=class extends _e{constructor(t){super(t)}doubleClicked(t,r,a){return this.initMatch(),this.lastPos>=1&&(this.matchesEvent(1,t,r),this.matchesEvent(0,t,r),this.matchesDelta(1,a)),this.isPatternMatch(3,`${Oe.getObjectKeyForValue(d,t)} Double Clicked`)}},Me=class extends _e{constructor(t){super(t)}ytAutoplayBlocked(t,r){return this.initMatch(),this.lastPos>=3&&(this.matchesEvent(3,d.ULTRAFUNK,g.RESUME_AUTOPLAY,null),this.matchesEvent(2,d.YOUTUBE,g.STATE_UNSTARTED,t),this.matchesEvent(1,d.YOUTUBE,g.STATE_BUFFERING,t),this.matchesEvent(0,d.YOUTUBE,g.STATE_UNSTARTED,t),this.matchesDelta(3,r)),this.isPatternMatch(5,"YouTube Autoplay Blocked")}scAutoplayBlocked(t,r){return this.initMatch(),this.lastPos>=3&&(this.matchesEvent(3,d.ULTRAFUNK,g.RESUME_AUTOPLAY,null),this.matchesEvent(2,d.SOUNDCLOUD,g.STATE_PLAYING,t),this.matchesEvent(1,d.SOUNDCLOUD,g.STATE_PAUSED,t),this.matchesEvent(0,d.SOUNDCLOUD,g.STATE_PAUSED,t),this.matchesDelta(3,r)),this.isPatternMatch(5,"SoundCloud Autoplay Blocked")}scWidgetPlayBlocked(t,r){return this.initMatch(),this.lastPos>=2&&(this.matchesEvent(2,d.SOUNDCLOUD,g.STATE_PLAYING,t),this.matchesEvent(1,d.SOUNDCLOUD,g.STATE_PAUSED,t),this.matchesEvent(0,d.SOUNDCLOUD,g.STATE_PAUSED,t),this.matchesDelta(2,r)),this.isPatternMatch(4,"SoundCloud WidgetPlay Blocked")}scPlayDoubleTrigger(t,r){return this.initMatch(),this.lastPos>=2&&(this.matchesEvent(2,d.ULTRAFUNK,g.CROSSFADE_START,null),this.matchesEvent(1,d.SOUNDCLOUD,g.STATE_PLAYING,t),this.matchesEvent(0,d.SOUNDCLOUD,g.STATE_PLAYING,t),this.matchesDelta(1,r)),this.isPatternMatch(4,"SoundCloud Play Double Trigger")}},ae=k("crossfade"),j={MIN:0,MAX:100},q={NONE:-1,AUTO:0,TRACK:1},Be={NONE:-1,EQUAL_POWER:0,LINEAR:1},nt={intervalEqPow:33,intervalLinear:100},rt=(e,t)=>{let r=e,a=t,i=!1,l=-1,c=null,m=null,E=0,b=0,h=q.NONE,A=null,L=0;return{isFading(){return i},init:Ce,start:ve,stop:p,mute:H};function Ce(v,D,C=null){return i===!1&&Ue(C)===!0?(ae.log(`init() - type: ${ae.getObjectKeyForValue(q,v)} - fadeInUid: ${C} - preset: ${D.length} sec ${ae.getObjectKeyForValue(Be,D.curve)} (Name: ${D.name})`),i=!0,b=r.masterVolume,h=v,A=D,m.setVolume(0),C===null?a.nextTrack(!0):a.jumpToTrack(a.trackFromUid(C),!0,!1),{fadeOutPlayer:a.indexMap.get(c.getUid()),fadeInPlayer:a.indexMap.get(m.getUid())}):null}function ve(){i&&c.getPosition(v=>{let D=A.curve===Be.EQUAL_POWER?nt.intervalEqPow:nt.intervalLinear;L=(v+D)/1e3;let C=c.getDuration()-L,K=C-D/1e3;h===q.AUTO?E=K:h===q.TRACK&&(E=C>A.length?A.length:K),ae.log(`start() - fadeStartTime: ${L.toFixed(2)} sec - timeRemaining: ${C.toFixed(2)} sec - fadeLength: ${E.toFixed(2)} sec - updateInterval: ${D} ms`),l=setInterval(A.curve===Be.EQUAL_POWER?Vt:$t,D)})}function p(){ae.log(`stop() - isFading: ${i}`),i&&(l!==-1&&(clearInterval(l),l=-1),c!==null&&(c.pause(),c.seekTo(0),setTimeout(()=>{c.setVolume(r.masterVolume),c=null},200)),m!==null&&(m=null),i=!1,E=0,b=0,h=q.NONE,A=null,L=0)}function H(v){c!==null&&c.mute(v)}function Ue(v){return c=a.current,m=v===null?a.next:a.playerFromUid(v),!!(c.getPlayable()&&m.getPlayable())}function Vt(){c.getPosition(v=>{let D=v/1e3-L,C=D>=0?D:0,K=b-b*(C/E),Ne=K>=j.MIN?K:j.MIN,Ft=Math.round(Math.sqrt(b*Ne)),et=Math.round(Math.sqrt(b*(b-Ne)));C>=E&&Ne<=j.MIN&&et>=b?(c.setVolume(j.MIN),m.setVolume(b),p()):(c.setVolume(Ft),m.setVolume(et))})}function $t(){c.getPosition(v=>{let D=v/1e3-L,C=Math.round(b*(D/E)),K=b-C;D>E&&K<j.MIN&&C>b?(c.setVolume(j.MIN),m.setVolume(b),p()):(c.setVolume(K),m.setVolume(C))})}},X=k("mediaplayers"),jt=/\s{1,}[–·-]\s{1,}/i,Ye=class{constructor(t,r,a){this.trackId=t,this.iframeId=r,this.embeddedPlayer=a,this.playable=!0,this.duration=0,this.artist=null,this.title=null,this.thumbnailSrc=null,this.thumbnail=new Image,this.thumbnail.decoding="async"}getTrackId(){return this.trackId}getIframeId(){return this.iframeId}getUid(){return this.iframeId}getEmbeddedPlayer(){return this.embeddedPlayer}getPlayable(){return this.playable}setPlayable(t){this.playable=t}getDuration(){return this.duration}setDuration(t){this.duration=t}getArtist(){return this.artist}setArtist(t){this.artist=t}getTitle(){return this.title}setTitle(t){this.title=t}getThumbnailSrc(){return this.thumbnailSrc}seekTo(t){this.embeddedPlayer.seekTo(t)}setVolume(t){this.embeddedPlayer.setVolume(t)}setThumbnail(t){this.thumbnailSrc=t,this.thumbnail.src=t}},we=class extends Ye{constructor(t,r,a,i){super(t,r,a);this.previousPlayerState=-1,this.setThumbnail(i)}setThumbnail(t){let a=new URL(decodeURIComponent(t)).pathname.split("/embed/");a.length===2&&a[1].length===11?super.setThumbnail(`https://img.youtube.com/vi/${a[1]}/mqdefault.jpg`):X.warn(`MediaPlayer.YouTube.setThumbnail() failed for: ${this.iframeId}`)}pause(){this.embeddedPlayer.pauseVideo()}stop(){this.embeddedPlayer.stopVideo()}isPlaybackError(t){return X.log(`YouTube.play() - current playerState: ${this.embeddedPlayer.getPlayerState()} - previous playerState: ${this.previousPlayerState} - playable: ${this.playable}`),this.embeddedPlayer.getPlayerState()===-1&&this.previousPlayerState===-1&&this.playable===!0?(X.warn(`MediaPlayer.YouTube.play() - Unable to play track: ${this.getArtist()} - "${this.getTitle()}" with videoId: ${this.embeddedPlayer.getVideoData().video_id} -- No YouTube API error given!`),this.playable=!1,t(this,this.embeddedPlayer.getVideoUrl()),!0):(this.previousPlayerState=this.embeddedPlayer.getPlayerState(),!1)}play(t){this.isPlaybackError(t)===!1&&(this.playable===!0?this.embeddedPlayer.playVideo():t(this,this.embeddedPlayer.getVideoUrl()))}getVolume(t){t(this.embeddedPlayer.getVolume())}mute(t){t?this.embeddedPlayer.mute():this.embeddedPlayer.unMute()}getPosition(t){t(this.embeddedPlayer.getCurrentTime()*1e3,this.duration)}},ge=class extends Ye{constructor(t,r,a,i){super(t,r,a);this.soundId=this.getSoundId(i),this.volume=j.MAX,this.muted=!1}getSoundId(t){if(t!==void 0){let a=new URL(decodeURIComponent(t)).searchParams.get("url");if(a!==null){let i=a.split("/"),l="tracks".toUpperCase();for(let c=0;c<i.length;c++)if(i[c].toUpperCase()===l)return parseInt(i[c+1])}}return X.error(`MediaPlayer.SoundCloud.getSoundId() failed for: ${this.iframeId}`),null}setThumbnail(){this.embeddedPlayer.getCurrentSound(t=>{let r=t.artwork_url!==null?t.artwork_url:t.user.avatar_url;r!=null&&super.setThumbnail(r)})}getUid(){return this.soundId}pause(){this.embeddedPlayer.pause()}play(t){this.playable===!0?this.embeddedPlayer.getCurrentSound(r=>{r.playable===!0?this.embeddedPlayer.play():t(this,r.permalink_url)}):t(this,"https://soundcloud.com")}stop(){this.pause(),super.seekTo(0)}seekTo(t){super.seekTo(t*1e3)}getVolume(t){this.embeddedPlayer.getVolume(r=>t(r))}setVolume(t){t!==0&&(this.volume=t),(this.muted===!1||t===0)&&super.setVolume(t)}mute(t){this.muted=!!t,t?this.setVolume(0):this.setVolume(this.volume)}getPosition(t){this.embeddedPlayer.getPosition(r=>t(r,this.duration))}};function at(e,t){if(t!==null&&t.length>0){let r=t.match(jt);r!==null?(e.artist=t.slice(0,r.index),e.title=t.slice(r.index+r[0].length)):e.artist=t}}var st=()=>{let e=null,t=null,r=null,a=[],i=new Map,l=0;return{indexMap:i,init:c,get crossfade(){return r},add:m,getPlayerIndex(){return l},setPlayerIndex(p){l=p},get current(){return a[l]},get next(){return a[l+1]},getNumTracks(){return a.length},getCurrentTrack(){return l+1},playerFromUid(p){return a[i.get(p)]},trackFromUid(p){return i.get(p)+1},isCurrent(p){return p===this.current.getUid()},uIdFromIframeId:E,stop:b,mute:h,getStatus:A,prevTrack:L,nextTrack:Ce,jumpToTrack:ve};function c(p,H){X.log("init()"),e=p,t=H,r=rt(p,this)}function m(p){X.log(p),a.push(p),i.set(p.getUid(),a.length-1)}function E(p){return a.find(H=>H.iframeId===p).getUid()}function b(){this.current.stop(),r.stop()}function h(){this.current.mute(e.masterMute),r.mute(e.masterMute)}function A(){return{currentTrack:this.getCurrentTrack(),numTracks:this.getNumTracks(),artist:this.current.getArtist(),title:this.current.getTitle(),thumbnailSrc:this.current.getThumbnailSrc()}}function L(p){return l>0?(l--,t(p),!0):!1}function Ce(p){return l++,l<this.getNumTracks()?(t(p),!0):!1}function ve(p,H,Ue=!0){return p>0&&p<=this.getNumTracks()?(l=p-1,t(H,Ue),!0):!1}};function xe(e,t){zn.log(`addSettingsObserver() for property: ${e}`),e in ot===!1&&(ot[e]=[]),ot[e].push(t)}var me=k("playback-controls"),J={},G={},B={progressControlsId:"progress-controls",playbackControlsId:"playback-controls",crossfadePresetSelector:".crossfade-controls .preset-control",crossfadePresetData:"data-crossfade-preset",crossfadeToSelector:".crossfade-controls .fadeto-control"},u={DISABLED:"state-disabled",ENABLED:"state-enabled",PLAY:"state-play",PAUSE:"state-pause"},n={progressSeek:{element:null,state:u.DISABLED,click:null},progressBar:{element:null,state:u.DISABLED},details:{element:null,state:u.DISABLED,artistElement:null,titleElement:null},thumbnail:{element:null,state:u.DISABLED,img:null},timer:{element:null,state:u.DISABLED,positionElement:null,durationElement:null,positionSeconds:-1,durationSeconds:-1},prevTrack:{element:null,state:u.DISABLED},playPause:{element:null,state:u.DISABLED,iconElement:null},nextTrack:{element:null,state:u.DISABLED},shuffle:{element:null,state:u.DISABLED},mute:{element:null,state:u.DISABLED,iconElement:null},crossfadePreset:{elements:null},crossfadeTo:{elements:null,click:null}};function it(e,t,r,a){me.log("init()"),J=e,G=t;let i=document.getElementById(B.progressControlsId);i!==null?(n.progressSeek.element=i.querySelector(".seek-control"),n.progressSeek.click=r,n.progressBar.element=i.querySelector(".bar-control")):me.error(`init(): Unable to getElementById() for '#${B.progressControlsId}'`);let l=document.getElementById(B.playbackControlsId);l!==null?(n.details.element=l.querySelector(".details-control"),n.details.artistElement=n.details.element.querySelector(".details-artist"),n.details.titleElement=n.details.element.querySelector(".details-title"),n.thumbnail.element=l.querySelector(".thumbnail-control"),n.thumbnail.img=n.thumbnail.element.querySelector("img"),n.timer.element=l.querySelector(".timer-control"),n.timer.positionElement=n.timer.element.querySelector(".timer-position"),n.timer.durationElement=n.timer.element.querySelector(".timer-duration"),n.prevTrack.element=l.querySelector(".prev-control"),n.playPause.element=l.querySelector(".play-pause-control"),n.playPause.iconElement=n.playPause.element.querySelector("i"),n.nextTrack.element=l.querySelector(".next-control"),n.shuffle.element=l.querySelector(".shuffle-control"),n.mute.element=l.querySelector(".mute-control"),n.mute.iconElement=n.mute.element.querySelector("i")):me.error(`init(): Unable to getElementById() for '#${B.playbackControlsId}'`),n.crossfadePreset.elements=document.querySelectorAll(B.crossfadePresetSelector),n.crossfadeTo.elements=document.querySelectorAll(B.crossfadeToSelector),n.crossfadePreset.elements.length>1&&n.crossfadeTo.elements.length>1&&(n.crossfadePreset.elements.forEach(c=>lt(c,J.trackCrossfadeDefPreset)),n.crossfadeTo.click=a)}function ct(e,t,r,a){me.log("ready()"),I(n.progressSeek,u.ENABLED),n.progressSeek.element.addEventListener("click",qt),I(n.progressBar,u.ENABLED),I(n.details,u.ENABLED),I(n.thumbnail,u.ENABLED),I(n.timer,u.ENABLED),J.trackThumbnailOnMobile&&n.thumbnail.element.classList.add("show-on-mobile"),J.trackTimesOnMobile&&n.timer.element.classList.add("show-on-mobile"),I(n.prevTrack,u.DISABLED),n.prevTrack.element.addEventListener("click",e),I(n.playPause,u.PLAY),n.playPause.element.addEventListener("click",t),I(n.nextTrack,G.getNumTracks()>1?u.ENABLED:u.DISABLED),n.nextTrack.element.addEventListener("click",r),I(n.shuffle,u.ENABLED),I(n.mute,u.ENABLED),n.mute.element.addEventListener("click",a),ut(),G.getNumTracks()>1&&(n.crossfadePreset.elements.forEach(i=>{i.addEventListener("click",Gt),M(i,u.DISABLED,u.ENABLED)}),n.crossfadeTo.elements.forEach(i=>i.addEventListener("click",Wt))),xe("autoplay",Ht),xe("masterMute",ut)}function I(e,t=u.DISABLED){M(e.element,e.state,t),e.state=t,t===u.PLAY?n.playPause.iconElement.textContent="play_circle_filled":t===u.PAUSE&&(n.playPause.iconElement.textContent="pause_circle_filled")}function dt(e,t){$e(t===0?0:e/(t*1e3))}function se(e){$e(e/100)}function $e(e){n.progressBar.element.style.transform=`scaleX(${e})`}function qt(e){if(n.timer.durationSeconds>0){let t=e.clientX/document.documentElement.clientWidth*100,r=Math.round(n.timer.durationSeconds*t/100);n.progressSeek.click(r),Y()===!1&&(se(t),fe(r,n.timer.durationSeconds))}}function Fe(e){n.details.artistElement.textContent=e.artist||"",n.details.titleElement.textContent=e.title||"",Jt(e.thumbnailSrc),fe(-1,-1)}function Jt(e){e!==n.thumbnail.img.src&&(n.thumbnail.element.classList.add("loading"),e!==null?n.thumbnail.img.src=e:n.thumbnail.img.src="/wp-content/themes/ultrafunk/inc/img/photo_filled_grey.png",n.thumbnail.img.decode().then(()=>{n.thumbnail.element.classList.remove("loading")}))}function fe(e,t){e!==-1&&n.timer.positionSeconds!==e?(n.timer.positionSeconds=e,J.autoplay===!1&&(e=t-e),Ee(n.timer.positionElement,e)):e===-1&&n.timer.positionSeconds===-1&&(n.timer.positionElement.textContent="00:00"),t!==-1&&n.timer.durationSeconds!==t?(n.timer.durationSeconds=t,Ee(n.timer.durationElement,t)):t===-1&&n.timer.durationSeconds===-1&&(n.timer.durationElement.textContent="00:00")}function Ee(e,t){let r=new Date(t*1e3).toISOString();e.textContent=t>60*60?r.substr(11,8):r.substr(14,5)}function gt(){n.timer.positionElement.textContent="00:00",n.timer.durationElement.textContent="00:00"}function Y(){return n.playPause.state===u.PAUSE}function Ke(){let e=G.getStatus();gt(),Fe(e),Y()===!1&&e.currentTrack<=1&&I(n.prevTrack,u.DISABLED),e.currentTrack<e.numTracks&&I(n.nextTrack,u.ENABLED)}function je(){let e=G.getStatus();I(n.playPause,u.PAUSE),I(n.prevTrack,u.ENABLED),Fe(e),mt(!0,e.currentTrack)}function W(){I(n.playPause,u.PLAY),mt(!1)}function pe(e){e?n.playPause.element.classList.toggle("time-remaining-warning"):n.playPause.element.classList.remove("time-remaining-warning")}function Te(){let e=G.getStatus();gt(),Fe(e),I(n.prevTrack,u.ENABLED),e.currentTrack>=e.numTracks&&I(n.nextTrack,u.DISABLED)}function ut(){n.mute.iconElement.textContent=J.masterMute?"volume_off":"volume_up"}function lt(e,t){e.setAttribute(B.crossfadePresetData,t),e.textContent=`${t+1}`,e.title=`Preset: ${Ve.crossfade[t].name}`}function Gt(e){let t=parseInt(e.target.getAttribute(B.crossfadePresetData));t+1<Ve.crossfade.length?t++:t=0,lt(e.target,t)}function Wt(e){if(Y()&&G.crossfade.isFading()===!1){let t=e.target.closest("single-track");if(t!==null){let r=t.querySelector("iframe"),a=t.querySelector(B.crossfadePresetSelector).getAttribute(B.crossfadePresetData);M(e.target.closest("div.fadeto-control"),u.ENABLED,u.DISABLED),n.crossfadeTo.click(G.uIdFromIframeId(r.id),Ve.crossfade[a])}}}function mt(e,t=-1){n.crossfadeTo.elements.forEach((r,a)=>{t===a+1?M(r,e?u.ENABLED:u.DISABLED,e?u.DISABLED:u.ENABLED):M(r,e?u.DISABLED:u.ENABLED,e?u.ENABLED:u.DISABLED)})}function Ht(){Y()===!1&&n.timer.positionSeconds!==-1&&n.timer.durationSeconds!==-1&&(Ee(n.timer.positionElement,J.autoplay?n.timer.positionSeconds:n.timer.durationSeconds-n.timer.positionSeconds),Ee(n.timer.durationElement,n.timer.durationSeconds))}var ie=k("playback-events"),ye={},qe={nowPlayingIconsSelector:"h2.entry-title"},he={nowPlayingIcons:null,snackbarId:0},o={LOADING:"loading",READY:"ready",MEDIA_PLAYING:"mediaPlaying",MEDIA_PAUSED:"mediaPaused",MEDIA_ENDED:"mediaEnded",MEDIA_TIME_REMAINING:"mediaTimeRemaining",MEDIA_SHOW:"mediaShow",MEDIA_UNAVAILABLE:"mediaUnavailable",CONTINUE_AUTOPLAY:"continueAutoplay",RESUME_AUTOPLAY:"resumeAutoplay",AUTOPLAY_BLOCKED:"autoplayBlocked",PLAYBACK_BLOCKED:"playbackBlocked"},Ge={[o.LOADING]:[Zt],[o.READY]:[en],[o.MEDIA_PLAYING]:[tn],[o.MEDIA_PAUSED]:[nn],[o.MEDIA_ENDED]:[ft],[o.MEDIA_TIME_REMAINING]:[rn],[o.MEDIA_SHOW]:[an],[o.CONTINUE_AUTOPLAY]:[sn],[o.RESUME_AUTOPLAY]:[on],[o.AUTOPLAY_BLOCKED]:[ln],[o.PLAYBACK_BLOCKED]:[un],[o.MEDIA_UNAVAILABLE]:[cn]};function Et(e){ie.log("init()"),ye=e,he.nowPlayingIcons=document.querySelectorAll(qe.nowPlayingIconsSelector)}function ue(e,t){e in Ge&&Ge[e].push(t)}function U(e,t=null,r=null){Ge[e].forEach(a=>{a({event:e,data:t,callback:r})})}function Zt(e){se(e.data.loadingPercent)}function en(e){w(e),se(0)}function tn(e){if(w(e),zt(he.snackbarId),e.data.numTracks>1){let t=document.querySelector(`#${e.data.trackId} ${qe.nowPlayingIconsSelector}`);pt(t),M(t,"playing-paused","now-playing-icon"),ye.user.animateNowPlayingIcon&&t.classList.add("playing-animate")}}function nn(e){w(e),e.data.numTracks>1&&document.querySelector(`#${e.data.trackId} ${qe.nowPlayingIconsSelector}`).classList.add("playing-paused")}function ft(e){w(e),se(0),e!==null&&e.data.numTracks>1&&pt()}function rn(){}function an(e){w(e),ft(null),e.data.scrollToMedia&&We.id(e.data.trackId)}function sn(e){w(e),Q(navigationVars.nextUrl,!0)}function on(e){let t=sessionStorage.getItem(le.UF_AUTOPLAY);w(e),ie.log(`RESUME_AUTOPLAY: ${t!==null?"true":"false"}`),t!==null&&(sessionStorage.removeItem(le.UF_AUTOPLAY),e.callback.resumeAutoplay())}function ln(e){w(e),he.snackbarId=_("Autoplay blocked, Play to continue...",0,"play",()=>{e.data.isPlaying===!1&&e.callback.togglePlayPause()})}function un(e){w(e),_("Unable to play track, skipping to next...",5),He(e,5)}function cn(e){w(e),dn(e.data.trackId)?(_("YouTube Premium track, skipping...",5,"help",()=>{window.location.href="/channel/premium/"}),He(e,5)):(_("Unable to play track, skipping to next...",5),tt("EVENT_MEDIA_UNAVAILABLE",e.data),He(e,5))}function w(e=null){ie.isDebug()&&e!==null&&ie.log(e)}function pt(e){he.nowPlayingIcons.forEach(t=>{t!==e&&t.classList.remove("now-playing-icon","playing-animate","playing-paused")})}function He(e,t=5){setTimeout(()=>{e.data.currentTrack<e.data.numTracks?e.callback.skipToTrack(e.data.currentTrack+1,!0):navigationVars.nextUrl!==null&&Q(navigationVars.nextUrl,!0)},t*1e3+250)}function dn(e){let t=document.getElementById(e);return t!==null?t.classList.contains("category-premium"):!1}function Q(e,t=!1){ie.log(`navigateTo(): ${e} - continueAutoplay: ${t}`),e!==null&&e.length>0&&(t&&sessionStorage.setItem(le.UF_AUTOPLAY,"true"),window.location.href=e)}var We=(()=>{let e=oe("--site-header-down"),t=oe("--site-header-down-mobile"),r=oe("--site-header-up"),a=oe("--site-header-up-mobile");return{id:i};function i(m){if(ye.user.autoScroll){let E=Math.round(window.scrollY+document.getElementById(m).getBoundingClientRect().top),b=Math.round(window.pageYOffset),h=l(E>b);b+h+c()>E&&(h=l(!1)),window.scroll({top:E-(h+c()),left:0,behavior:ye.user.smoothScrolling?"smooth":"auto"})}}function l(m){let E=Qt(Xt.SITE_MAX_WIDTH_MOBILE);return m?E?t:e:E?a:r}function c(){return oe("--site-content-margin-top")-1}})(),S=k("embedded-players"),x=new Me(10),N=null,Je=0,Tt=1,ce,f,R,$,z={trackCountData:"data-track-count",youTubeIframeIdRegEx:/youtube-uid/i,soundCloudIframeIdRegEx:/soundcloud-uid/i,entriesSelector:"single-track",artistTrackTitleData:"data-artist-track-title",maxPlaybackStartDelay:3};function yt(e){({settings:ce=null,players:f=null,playbackState:R=null,playbackTimer:$=null}=e),gn(),mn()}function ht(e){let t=parseInt(document.body.getAttribute(z.trackCountData));return S.log(`getTrackCount(): ${t}`),Je=t+3,N=e,t}function be(){return{loadingPercent:100*(Tt++/Je)}}function bt(){Tt>=Je?N(o.READY):N(o.LOADING,be())}function Pn(){document.querySelectorAll(z.entriesSelector).forEach(t=>{let r=t.id,a=t.getAttribute(z.artistTrackTitleData);t.querySelectorAll("iframe").forEach(l=>{let c=l.id,m={};if(z.youTubeIframeIdRegEx.test(c)){let E=new YT.Player(c,{events:{onReady:fn,onStateChange:En,onError:pn}});m=new we(r,c,E,l.src)}else if(z.soundCloudIframeIdRegEx.test(c)){let E=SC.Widget(c);m=new ge(r,c,E,l.src),E.bind(SC.Widget.Events.READY,()=>{m.setThumbnail(),Tn()}),E.bind(SC.Widget.Events.PLAY,yn),E.bind(SC.Widget.Events.PAUSE,hn),E.bind(SC.Widget.Events.FINISH,bn),E.bind(SC.Widget.Events.ERROR,Sn)}at(m,a),f.add(m)})})}function Se(e,t){S.log("onPlayerError()"),S.log(e);let r=e instanceof ge?d.SOUNDCLOUD:d.YOUTUBE;f.isCurrent(e.getUid())===!1&&f.stop(),x.add(r,g.PLAYER_ERROR,e.getUid()),N(o.MEDIA_UNAVAILABLE,An(e,t))}function An(e,t){let r=e.getArtist()||"N/A",a=e.getTitle()||"N/A";return{currentTrack:f.trackFromUid(e.getUid()),numTracks:f.getNumTracks(),trackId:e.getTrackId(),mediaTitle:`${r} - ${a}`,mediaUrl:t}}function gn(){S.log("initYouTubeAPI()"),N(o.LOADING,be());let e=document.createElement("script");e.id="youtube-iframe-api",e.src="https://www.youtube.com/iframe_api";let t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}window.onYouTubeIframeAPIReady=function(){S.log("onYouTubeIframeAPIReady()"),N(o.LOADING,be()),Pn()};function fn(){S.log("onYouTubePlayerReady()"),bt()}function En(e){x.add(d.YOUTUBE,e.data,e.target.h.id);switch(e.data){case YT.PlayerState.BUFFERING:if(S.log(`onYouTubePlayerStateChange: BUFFERING (uID: ${e.target.h.id})`),f.crossfade.isFading()===!1){let t=f.playerFromUid(e.target.h.id);t.mute(ce.masterMute),t.setVolume(ce.masterVolume)}break;case YT.PlayerState.CUED:S.log(`onYouTubePlayerStateChange: CUED      (uID: ${e.target.h.id})`);break;case YT.PlayerState.PLAYING:S.log(`onYouTubePlayerStateChange: PLAYING   (uID: ${e.target.h.id})`),R.syncAll(e.target.h.id,R.STATE.PLAY),f.current.setDuration(Math.round(e.target.getDuration())),$.start();break;case YT.PlayerState.PAUSED:S.log(`onYouTubePlayerStateChange: PAUSED    (uID: ${e.target.h.id})`),f.isCurrent(e.target.h.id)?(R.syncAll(e.target.h.id,R.STATE.PAUSE),$.stop(!1)):f.crossfade.stop();break;case YT.PlayerState.ENDED:S.log(`onYouTubePlayerStateChange: ENDED     (uID: ${e.target.h.id})`),f.isCurrent(e.target.h.id)?($.stop(!0),N(o.MEDIA_ENDED)):f.crossfade.stop();break;case YT.PlayerState.UNSTARTED:S.log(`onYouTubePlayerStateChange: UNSTARTED (uID: ${e.target.h.id})`),x.ytAutoplayBlocked(e.target.h.id,3e3)&&N(o.AUTOPLAY_BLOCKED);break;default:S.log(`onYouTubePlayerStateChange: Unknown state: ${e.data} for ${e.target.h.id}`)}}function pn(e){S.log("onYouTubePlayerError: "+e.data);let t=f.playerFromUid(e.target.h.id);t.setPlayable(!1),Se(t,e.target.getVideoUrl())}function mn(){S.log("initSoundCloudAPI()"),N(o.LOADING,be())}function Tn(){S.log("onSoundCloudPlayerEventReady()"),bt()}function yn(e){S.log(`onSoundCloudPlayerEvent: PLAY   (uID: ${e.soundId})`),x.add(d.SOUNDCLOUD,g.STATE_PLAYING,e.soundId),f.crossfade.isFading()&&f.isCurrent(e.soundId)?x.scPlayDoubleTrigger(e.soundId,z.maxPlaybackStartDelay*1e3)&&R.syncAll(e.soundId,R.STATE.PLAY):(R.syncAll(e.soundId,R.STATE.PLAY),f.current.mute(ce.masterMute),f.current.setVolume(ce.masterVolume)),f.current.getEmbeddedPlayer().getDuration(t=>{f.current.setDuration(Math.round(t/1e3)),$.start()})}function hn(e){S.log(`onSoundCloudPlayerEvent: PAUSE  (uID: ${e.soundId})`),x.add(d.SOUNDCLOUD,g.STATE_PAUSED,e.soundId),x.scAutoplayBlocked(e.soundId,3e3)?($.stop(!1),N(o.AUTOPLAY_BLOCKED)):x.scWidgetPlayBlocked(e.soundId,3e4)?($.stop(!1),N(o.PLAYBACK_BLOCKED,{currentTrack:f.trackFromUid(e.soundId),numTracks:f.getNumTracks()})):f.isCurrent(e.soundId)?f.current.getPosition(t=>{t>0&&(R.syncAll(e.soundId,R.STATE.PAUSE),$.stop(!1))}):f.crossfade.stop()}function bn(e){S.log(`onSoundCloudPlayerEvent: FINISH (uID: ${e.soundId})`),f.isCurrent(e.soundId)?($.stop(!0),N(o.MEDIA_ENDED)):f.crossfade.stop()}function Sn(){this.getCurrentSound(e=>{let t=f.playerFromUid(e.id);S.log(`onSoundCloudPlayerEvent: ERROR for track: ${f.trackFromUid(e.id)}. ${t.getArtist()} - ${t.getTitle()} - [${t.getUid()} / ${t.getIframeId()}]`),t.setPlayable(!1)})}var V=k("playback"),de=null,P={},s={},Pe={updateTimerInterval:200,minCrossfadeToTime:5,maxBufferingDelay:3};function At(e){de=x,P=e.user,Et(e),s=st(),s.init(P,In),it(P,s,kn,Ln),yt({settings:P,players:s,playbackState:St,playbackTimer:Pt})}function kt(){return ht(Dn)>0}function Z(){Y()?(W(),s.current.pause()):(je(),s.current.play(Se))}function Xe(e){V.log(`prevClick() - prevTrack: ${s.getCurrentTrack()-1} - numTracks: ${s.getNumTracks()} - event: ${e!==null?e.type:"null"}`),s.getCurrentTrack()>0&&s.current.getPosition(t=>{t>3e3?(s.current.seekTo(0),Pt.updateCallback(0)):(s.getCurrentTrack()>1&&s.stop(),s.prevTrack(Y())&&Ke())})}function Ae(e){V.log(`nextClick() - nextTrack: ${s.getCurrentTrack()+1} - numTracks: ${s.getNumTracks()} - event: ${e!==null?e.type:"null"}`),s.getCurrentTrack()+1<=s.getNumTracks()?(s.stop(),e!==null||P.autoplay?s.nextTrack(Y())&&Te():W()):e===null&&(W(),P.autoplay?U(o.CONTINUE_AUTOPLAY):s.stop())}function kn(e){s.current.seekTo(e)}function Qe(){P.masterMute=P.masterMute!==!0,s.mute()}function In(e,t=!0){U(o.MEDIA_SHOW,{scrollToMedia:t,trackId:s.current.getTrackId()}),e&&s.current.play(Se)}function It(e,t=!0){V.log(`skipToTrack(): ${e} - ${t}`),t===!0&&Y()===!1&&(de.clear(),de.add(d.ULTRAFUNK,g.RESUME_AUTOPLAY,null),s.jumpToTrack(e,t)&&Te())}function Cn(){V.log("resumeAutoplay()"),de.add(d.ULTRAFUNK,g.RESUME_AUTOPLAY,null),Z()}function O(){return{isPlaying:Y(),currentTrack:s.getCurrentTrack(),numTracks:s.getNumTracks(),trackId:s.current.getTrackId(),iframeId:s.current.getIframeId()}}function Dn(e,t=null){V.isDebug()&&e!==o.LOADING&&(V.log(`embeddedEventHandler(): ${e}`),t!==null&&V.log(t));switch(e){case o.LOADING:U(o.LOADING,t);break;case o.READY:ct(Xe,Z,Ae,Qe),U(o.READY),U(o.RESUME_AUTOPLAY,null,{resumeAutoplay:Cn});break;case o.MEDIA_ENDED:Ae(null);break;case o.AUTOPLAY_BLOCKED:W(),U(o.AUTOPLAY_BLOCKED,O(),{togglePlayPause:Z});break;case o.PLAYBACK_BLOCKED:W(),U(o.PLAYBACK_BLOCKED,t,{skipToTrack:It});break;case o.MEDIA_UNAVAILABLE:W(),U(o.MEDIA_UNAVAILABLE,t,{skipToTrack:It});break}}var St=(()=>{let e={PLAY:1,PAUSE:2},t=function a(i,l){if(V.log(`playbackState.syncAll() - previousTrack: ${s.getPlayerIndex()+1} - nextTrack: ${s.indexMap.get(i)+1} - syncState: ${V.getObjectKeyForValue(e,l)}`),s.isCurrent(i))l===e.PLAY?(s.crossfade.start(),je(),U(o.MEDIA_PLAYING,O())):l===e.PAUSE&&(s.crossfade.stop(),W(),U(o.MEDIA_PAUSED,O()));else{let c=s.getPlayerIndex(),m=s.indexMap.get(i);s.stop(),s.setPlayerIndex(m),r(c,m),a(i,l)}};function r(a,i){i>a?Te():Ke()}return{STATE:e,syncAll:t,syncControls:r}})(),Pt=(()=>{let e=-1,t=0,r=!0;return document.addEventListener("visibilitychange",l),{start:a,stop:i,updateCallback:m};function a(){i(!1),e=setInterval(c,Pe.updateTimerInterval)}function i(h=!1){e!==-1&&(clearInterval(e),e=-1),h&&(m(0),U(o.MEDIA_ENDED,O())),t=0,pe(!1)}function l(){r=document.visibilityState==="visible"}function c(){r&&s.current.getPosition(m)}function m(h,A=0){let L=Math.round(h/1e3);dt(h,A),fe(L,A),L>0&&A>0&&(E(L,A),b(L,A))}function E(h,A){if(P.autoplay===!1&&P.timeRemainingWarning&&t!==h){let L=A-h;t=h,L<=P.timeRemainingSeconds?(pe(!0),U(o.MEDIA_TIME_REMAINING,{timeRemainingSeconds:L})):pe(!1)}}function b(h,A){P.masterMute===!1&&P.autoplay&&P.autoCrossfade&&(A-h===P.autoCrossfadeLength+Pe.maxBufferingDelay&&(s.getCurrentTrack()+1<=s.getNumTracks()&&Lt(q.AUTO,{name:"Auto Crossfade",length:P.autoCrossfadeLength,curve:P.autoCrossfadeCurve})))}})();function Ln(e,t){s.isCurrent(e)===!1&&s.current.getDuration()>0&&(V.log(`crossfadeToClick():
fadeOut: ${s.current.getArtist()} - "${s.current.getTitle()}" (${s.current.getUid()})
fadeIn.: ${s.playerFromUid(e).getArtist()} - "${s.playerFromUid(e).getTitle()}" (${e})`),P.masterMute===!1&&P.autoplay===!1&&s.current.getPosition(r=>{s.current.getDuration()-r/1e3>=Pe.minCrossfadeToTime+Pe.maxBufferingDelay&&Lt(q.TRACK,t,e)}))}function Lt(e,t,r=null){de.add(d.ULTRAFUNK,g.CROSSFADE_START,null);let a=s.crossfade.init(e,t,r);a!==null&&St.syncControls(a.fadeOutPlayer,a.fadeInPlayer)}var ee=k("screen-wakelock"),ke=null;function Dt(){return"wakeLock"in navigator&&"request"in navigator.wakeLock}async function vt(e){Dt()?document.visibilityState==="visible"&&(await Ct()!==!0&&ee.log("enable(): Screen Wake Lock request failed")):(ee.log("enable(): Screen Wake Lock is not supported"),_("Keep Screen On is not supported",5,"Turn Off",()=>e.user.keepMobileScreenOn=!1))}function Ut(){ee.log("stateVisible()"),Dt()&&ke===null&&Ct()}async function Ct(){try{return ke=await navigator.wakeLock.request("screen"),ee.log("request(): Screen Wake Lock is Enabled"),ke.addEventListener("release",()=>{ee.log("request(): Screen Wake Lock was Released"),ke=null}),!0}catch(e){ee.error(`request(): ${e.name} - ${e.message}`)}return!1}var te=k("playback-interaction"),ne=new Re(10),T={},Le=!1,Nt=!1,F={autoplayToggleId:"footer-autoplay-toggle",crossfadeToggleId:"footer-crossfade-toggle",allowKeyboardShortcutsEvent:"allowKeyboardShortcuts",denyKeyboardShortcutsEvent:"denyKeyboardShortcuts",fullscreenTrackEvent:new Event("fullscreenTrack"),doubleClickDelay:500},y={playbackControls:{details:null,thumbnail:null,timer:null,statePlaying:!1},fullscreenTarget:null,autoplayToggle:null,crossfadeToggle:null};document.addEventListener("DOMContentLoaded",()=>{te.log("DOMContentLoaded"),Nn(),kt()&&(On(),_n(),Ot(T.user.autoplay),_t(T.user.autoCrossfade))});document.addEventListener("fullscreenchange",Rt);document.addEventListener("webkitfullscreenchange",Rt);document.addEventListener(F.allowKeyboardShortcutsEvent,()=>{T.user.keyboardShortcuts&&(Le=!0)});document.addEventListener(F.denyKeyboardShortcutsEvent,()=>{T.user.keyboardShortcuts&&(Le=!1)});window.addEventListener("blur",Rn);function Nn(){te.log("readSettings()"),T=Un(le.UF_PLAYBACK_SETTINGS,vn,!0),te.log(T)}function On(){te.log("initInteraction()"),Le=T.user.keyboardShortcuts,y.playbackControls.details=document.getElementById("playback-controls").querySelector(".details-control"),y.playbackControls.thumbnail=document.getElementById("playback-controls").querySelector(".thumbnail-control"),y.playbackControls.timer=document.getElementById("playback-controls").querySelector(".timer-control"),y.autoplayToggle=document.getElementById(F.autoplayToggleId),y.crossfadeToggle=document.getElementById(F.crossfadeToggleId),Ie("i.nav-bar-arrow-back","click",re,navigationVars.prevUrl),Ie("i.nav-bar-arrow-fwd","click",re,navigationVars.nextUrl),Ie("nav.post-navigation .nav-previous a","click",re,navigationVars.prevUrl),Ie("nav.post-navigation .nav-next a","click",re,navigationVars.nextUrl)}function _n(){At(T),ue(o.READY,Mn),ue(o.MEDIA_SHOW,Mt),ue(o.MEDIA_ENDED,Mt),ue(o.MEDIA_TIME_REMAINING,Bn)}document.addEventListener("keydown",e=>{if(Nt&&Le&&e.ctrlKey===!1&&e.altKey===!1){switch(e.code){case"Backquote":Bt(e);break}switch(e.key){case" ":e.preventDefault(),Z();break;case"ArrowLeft":wn(e);break;case"ArrowRight":xn(e);break;case"A":ze(e);break;case"f":case"F":Yn(e);break;case"m":case"M":e.preventDefault(),Qe(),_(T.user.masterMute?"Volume is muted (<b>m</b> to unmute)":"Volume is unmuted (<b>m</b> to mute)",3);break;case"x":case"X":y.crossfadeToggle.classList.contains("disabled")===!1&&Yt(e);break}}});function Yn(e){e.preventDefault(),y.fullscreenTarget===null?wt():Ze()}function wn(e){e.preventDefault(),e.shiftKey===!0?re(e,navigationVars.prevUrl):(ne.add(d.KEYBOARD,g.KEY_ARROW_LEFT,null),Vn(navigationVars.prevUrl,O())||Xe(e))}function Vn(e,t){return e!==null&&(t.currentTrack===1&&t.isPlaying===!1&&(De("showLeftArrowHint","<b>Tip:</b> Double click the Left Arrow key to go to the previous page"),ne.doubleClicked(d.KEYBOARD,g.KEY_ARROW_LEFT,F.doubleClickDelay)))?(Q(e,!1),!0):!1}function xn(e){e.preventDefault(),e.shiftKey===!0?re(e,navigationVars.nextUrl):(ne.add(d.KEYBOARD,g.KEY_ARROW_RIGHT,null),$n(navigationVars.nextUrl,O())||Ae(e))}function $n(e,t){return e!==null&&(t.currentTrack===t.numTracks&&(De("showRightArrowHint","<b>Tip:</b> Double click the Right Arrow key to go to the next page"),ne.doubleClicked(d.KEYBOARD,g.KEY_ARROW_RIGHT,F.doubleClickDelay)))?(Q(e,t.isPlaying),!0):!1}function De(e,t,r=0){T.priv.tips[e]&&(_(t,r),T.priv.tips[e]=!1)}function Mn(){y.playbackControls.details.addEventListener("click",xt),y.playbackControls.thumbnail.addEventListener("click",xt),y.playbackControls.timer.addEventListener("click",ze),y.autoplayToggle.addEventListener("click",ze),y.crossfadeToggle.addEventListener("click",Yt),document.addEventListener("visibilitychange",Fn),T.user.keepMobileScreenOn&&vt(T),Nt=!0}function Mt(){T.user.autoExitFullscreen&&Ze()}function Bn(e){T.user.autoExitFsOnWarning&&e.data.timeRemainingSeconds<=T.user.timeRemainingSeconds&&Ze()}function Rn(){setTimeout(()=>{document.activeElement instanceof HTMLIFrameElement&&setTimeout(()=>{document.activeElement.blur(),document.activeElement instanceof HTMLIFrameElement&&document.activeElement.blur()},250)},0)}function Rt(){y.fullscreenTarget=document.fullscreenElement!==null?document.fullscreenElement.id:null,F.fullscreenTrackEvent.fullscreenTarget=y.fullscreenTarget,document.dispatchEvent(F.fullscreenTrackEvent)}function Fn(){document.visibilityState==="visible"?(T.user.autoResumePlayback&&y.playbackControls.statePlaying&&(O().isPlaying===!1&&Z()),T.user.keepMobileScreenOn&&Ut()):document.visibilityState==="hidden"&&(T.user.autoResumePlayback&&O().isPlaying?y.playbackControls.statePlaying=!0:y.playbackControls.statePlaying=!1)}function xt(e){Bt(e),ne.add(d.MOUSE,g.MOUSE_CLICK,null),e.target.tagName.toLowerCase()==="img"?De("showTrackImageHint","<b>Tip:</b> Double click or double tap on the Track Thumbnail for full screen"):De("showDetailsHint","<b>Tip:</b> Double click or double tap on Artist &amp; Title for full screen"),ne.doubleClicked(d.MOUSE,g.MOUSE_CLICK,F.doubleClickDelay)&&wt()}function re(e,t){e!==null&&t!==null&&(e.preventDefault(),Q(t,O().isPlaying))}function Bt(e){e.preventDefault(),We.id(O().trackId)}function wt(){document.getElementById(O().iframeId).requestFullscreen()}function Ze(){y.fullscreenTarget!==null&&(document.exitFullscreen(),y.fullscreenTarget=null)}function ze(e){e.preventDefault(),T.user.autoplay=T.user.autoplay!==!0,_(T.user.autoplay?"Autoplay enabled (<b>Shift</b> + <b>A</b> to disable)":"Autoplay disabled (<b>Shift</b> + <b>A</b> to enable)",5),Ot(T.user.autoplay)}function Ot(e){te.log(`updateAutoplayDOM() - autoplay: ${e}`),y.autoplayToggle.querySelector(".autoplay-on-off").textContent=e?"ON":"OFF",e?M(document.body,"autoplay-off","autoplay-on"):M(document.body,"autoplay-on","autoplay-off"),e?y.crossfadeToggle.classList.remove("disabled"):y.crossfadeToggle.classList.add("disabled")}function Yt(e){e.preventDefault(),T.user.autoCrossfade=T.user.autoCrossfade!==!0,_(T.user.autoCrossfade?"Auto Crossfade enabled (<b>x</b> to disable)":"Auto Crossfade disabled (<b>x</b> to enable)",5),_t(T.user.autoCrossfade)}function _t(e){te.log(`updateCrossfadeDOM() - autoCrossfade: ${e}`),y.crossfadeToggle.querySelector(".crossfade-on-off").textContent=e?"ON":"OFF"}
//# sourceMappingURL=interaction.js.map
