import{A as K,B as D,G as V,H as N,a as p,c as x,e as U,g,h as q,i as w,j,l as $,m as F,n as T,o as k,p as I,q as E,y as M,z as O}from"./chunk-XQQHF7VN.js";var y=p("term-rest"),d={termCache:{}};function Y(e,t,n,r){t in d.termCache?r(d.termCache[t].posts):(y.log(`fetchPosts() - termType: ${e} - termId: ${t} - maxItems: ${n}`),fetch(`/wp-json/wp/v2/posts?${e}=${t}&per_page=${n}&_fields=title,link,content,tags,categories`).then(s=>s.ok?s.json():(y.error(s),null)).then(s=>{d.termCache[t]={posts:s},r(s)}).catch(s=>{y.warn(s),r(null)}))}function z(e,t,n,r){if("categories"in d.termCache[t]&&"tags"in d.termCache[t])r("categories",d.termCache[t].categories),r("tags",d.termCache[t].tags);else{let s=[],i=[];e.forEach(o=>{s.push.apply(s,o.categories),i.push.apply(i,o.tags)}),i=i.filter(o=>o!==t),J("categories",t,[...new Set(s)],n,r),J("tags",t,[...new Set(i)],n,r)}}function J(e,t,n,r,s){n.length>0?(y.log(`fetchMetadata() - termType: ${e} - termIds: ${n.length>0?n:"Empty"} - maxItems: ${r}`),fetch(`/wp-json/wp/v2/${e}?include=${n.join(",")}&per_page=${r}&_fields=link,name`).then(i=>i.ok?i.json():(y.error(i),null)).then(i=>{d.termCache[t][e]=i,s(e,i)}).catch(i=>{y.warn(i),s(null)})):(d.termCache[t][e]=null,s(e,null))}function W(){d.termCache=JSON.parse(sessionStorage.getItem(g.UF_TERMLIST_CACHE)),d.termCache===null&&(d.termCache={})}function G(){sessionStorage.setItem(g.UF_TERMLIST_CACHE,JSON.stringify(d.termCache))}function X(){sessionStorage.removeItem(g.UF_TERMLIST_CACHE)}function Q(){return Object.keys(d.termCache).length>0}var le=p("termlist"),b={settings:{},termlistContainer:null};function Z(e){le.log("init()"),b.settings=e,b.termlistContainer=document.getElementById("termlist-container"),b.termlistContainer.addEventListener("click",t=>{let n=t.target.closest("div.play-button");if(n!==null)return H(t,n.querySelector("a").href);let r=t.target.closest("div.shuffle-button");if(r!==null)return ue(t,r.querySelector("a").href);let s=t.target.closest("div.share-find-button");if(s!==null)return de(s);if(t.target.closest("div.termlist-header")!==null)return he(t);let o=t.target.closest("div.thumbnail");if(o!==null)return ge(t,o);let l=t.target.closest("a");if(l!==null)return fe(t,l)}),ce()}function ee(){if(Q()){let e={pageUrl:window.location.href,scrollPos:Math.round(window.pageYOffset),openTermIds:[]};document.querySelectorAll(".termlist-entry").forEach(t=>{t.classList.contains("open")&&e.openTermIds.push(t.id)}),sessionStorage.setItem(g.UF_TERMLIST_STATE,JSON.stringify(e)),G()}}function ce(){if(W(),performance.navigation.type!==performance.navigation.TYPE_RELOAD){let e=JSON.parse(sessionStorage.getItem(g.UF_TERMLIST_STATE));e!==null&&e.pageUrl===window.location.href?(history.scrollRestoration="manual",e.openTermIds.forEach(t=>document.getElementById(t).querySelector("div.termlist-header").click()),window.scroll({top:e.scrollPos,left:0,behavior:"auto"})):history.scrollRestoration="auto"}sessionStorage.removeItem(g.UF_TERMLIST_STATE),X()}function L(e){return b.settings.user.preferredPlayer===x.LIST?e.replace(/ultrafunk\.com\//,"ultrafunk.com/list/"):e}function H(e,t,n=null){e.preventDefault(),ee(),sessionStorage.setItem(g.UF_AUTOPLAY,JSON.stringify({autoplay:e.shiftKey===!1,trackId:n,position:0})),window.location.href=L(t)}function ue(e,t){w("UF_RESHUFFLE","true"),H(e,t)}function de(e){let t=e.getAttribute("data-term-path"),n=e.getAttribute("data-term-name"),r=L(e.getAttribute("data-term-url"));D.show({title:`Share / Find ${t}`,string:n,url:r,verb:"Find"})}function ge(e,t){let n=b.termlistContainer.getAttribute("data-term-type")==="categories"?"channel":"artist",r=t.getAttribute("data-term-slug"),s=t.getAttribute("data-term-uid");return s!==null?H(e,`/list/${n}/${r}/`,s):H(e,t.getAttribute("data-term-url"))}function fe(e,t){ee(),t.closest(".permalink")!==null&&(e.preventDefault(),window.location.href=L(t.href))}function he(e){let t=e.target.closest("div.termlist-entry"),n=t.querySelector("div.expand-toggle span"),r=t.querySelector("div.termlist-body"),s=r.style.display.length!==0;E(t,s?"open":"closed",s?"closed":"open"),n.innerText=s?"expand_more":"expand_less",r.style.display=s?"":"flex",s||me(t,r)}function me(e,t){let n=b.termlistContainer.getAttribute("data-term-type"),r=parseInt(e.getAttribute("data-term-id")),s=e.getAttribute("data-term-slug"),i=n==="categories";Y(n,r,i?10:50,o=>{let l=i?"Latest Tracks":"All Tracks",u=t.querySelector(".body-left");o!==null?Se(l,s,o,u):u.innerHTML="<b>Error!</b><br>Unable to fetch track data...",!i&&o!==null&&z(o,r,50,(C,v)=>{l=C==="tags"?"Related Artists":"In Channels",u=C==="tags"?t.querySelector(".artists"):t.querySelector(".channels"),v!==null?Ee(l,v,u):u.innerHTML=`<b>${l}</b><br>None found`})})}var pe=/\s{1,}[–·-]\s{1,}|\s{1,}(&#8211;)\s{1,}/,ye=/(?<=src=").*?(?=[?"])/i;function be(e){return e.includes('id="soundcloud-uid')?{src:"/wp-content/themes/ultrafunk/inc/img/soundcloud_icon.png",class:"type-soundcloud"}:N(e.match(ye))}function Se(e,t,n,r){let s={},i=`<b>${e}</b>`;n.forEach(o=>{V(o.title.rendered,s,pe);let l=be(o.content.rendered),u=l?.uid!==void 0?`data-term-uid="${l.uid}"`:"";i+=`
    <div class="track">
      <div class="thumbnail ${l.class}" data-term-url="${o.link}" data-term-slug="${t}" ${u} title="Play Track">
        <img src="${l.src}">
      </div>
      <div class="artist-title text-nowrap-ellipsis">
        <a href="${o.link}" title="Go to track"><span><b>${s.artist}</b></span><br><span>${s.title}</span></a>
      </div>
    </div>`}),r.innerHTML=i}function Ee(e,t,n){let r=`<b>${e}</b><br>`;t.forEach(s=>r+=`<a href="${L(s.link)}">${s.name}</a>, `),n.innerHTML=r.slice(0,r.length-2)}var P=p("index"),h={settings:{}},a={siteHeader:null,introBanner:null,siteContent:null,siteContentSearch:null,fullscreenTarget:null};document.addEventListener("DOMContentLoaded",()=>{P.log("DOMContentLoaded"),te(),Ce(),a.introBanner!==null&&Te(),document.getElementById("termlist-container")!==null&&Z(h.settings),a.siteContentSearch!==null&&(a.siteContentSearch.focus(),a.siteContentSearch.setSelectionRange(9999,9999)),ke(),document.addEventListener("settingsUpdated",()=>{te(),K(h.settings),w(g.UF_TRACKS_PER_PAGE,h.settings.user.tracksPerPage,60*60*24*365*5)}),document.addEventListener("fullscreenElement",e=>a.fullscreenTarget=e.fullscreenTarget),document.addEventListener("keydown",ve)});function te(){P.log("readSettings()"),h.settings=j(g.UF_SITE_SETTINGS,U,!0),P.log(h.settings)}function Ce(){P.log("initIndex()"),a.siteHeader=document.getElementById("site-header"),a.introBanner=document.getElementById("intro-banner"),a.siteContent=document.getElementById("site-content"),a.siteContentSearch=document.querySelector("#site-content form input.search-field"),O(h.settings),R.init(),m.init(),S.addEventListener(),Le.addEventListener()}function ve(e){if(e.repeat===!1&&e.ctrlKey===!1&&e.altKey===!1)switch(e.key){case"Escape":m.isVisible()&&(e.preventDefault(),m.toggle());return}if(h.settings.user.keyboardShortcuts&&e.repeat===!1&&e.ctrlKey===!1&&e.altKey===!1)switch(e.key){case"c":case"C":A()&&(e.preventDefault(),m.toggle());break;case"L":A()&&ne()&&(M.galleryLayout.toggle(e),S.trigger());break;case"s":case"S":A()&&we()&&(e.preventDefault(),R.toggle());break;case"T":A()&&ne()&&M.siteTheme.toggle(e);break;case"ArrowLeft":e.shiftKey&&_()&&se(navigationVars.prev);break;case"ArrowRight":e.shiftKey&&_()&&se(navigationVars.next);break}}function A(){return R.isVisible()===!1&&a.siteContentSearch!==document.activeElement}function ne(){return document.body.classList.contains("page-settings")===!1}function we(){return a.fullscreenTarget===null}function _(){return document.body.classList.contains("no-playback")}function se(e){e!=null&&e.length>0&&(window.location.href=e)}function Te(){q("localStorage")&&typeof bannerProperty!="undefined"&&bannerProperty!==null&&h.settings.priv.banners[bannerProperty]&&(a.introBanner.style.display="block",S.trigger(),F("#intro-banner .intro-banner-close-button","click",()=>{a.introBanner.style.display="",a.siteContent.style.marginTop="",h.settings.priv.banners[bannerProperty]=!1}))}function ke(){if(document.querySelector(".nav-bar-title .go-back-to")!==null){let e="";if(document.referrer.length===0)e="Previous Page";else{let t=new URL(decodeURIComponent(document.referrer));if(t.search.length!==0)e="Search Results";else if(t.pathname.length>1){let n=t.pathname.slice(-1)==="/"?1:0,r=t.pathname.slice(1,t.pathname.length-n).replace(/-/gi," ").split("/");r.forEach((s,i)=>e+=i+1<r.length?s+" / ":s)}}document.querySelectorAll("#site-navigation .nav-bar-title").forEach(t=>{t.querySelector(".go-back-title").textContent=e.length>0?e:"Ultrafunk (home)",t.querySelector(".go-back-to").style.opacity=1})}}var m=(()=>{let e=new ResizeObserver(o),t=null,n=null,r=!1;return{isVisible(){return r},scrolledTop(){t.style.display=""},init:s,toggle:i};function s(){t=document.querySelector("#site-navigation .nav-menu-outer"),n=document.getElementById("nav-menu-modal-overlay"),T(".nav-menu-toggle","click",i),n.addEventListener("click",i),n.addEventListener("transitionend",l),e.observe(t.querySelector(".menu-primary-menu-container"))}function i(){a.siteHeader.classList.contains("sticky-nav-up")?r?t.style.display="none":t.style.display="flex":a.siteHeader.classList.contains("sticky-nav-down")===!1&&a.siteHeader.classList.toggle("hide-nav-menu")}function o(u){r=u[0].contentRect.height!==0,r?(n.className="",n.classList.add("show"),setTimeout(()=>n.classList.add("fadein"),50)):n.classList.add("fadeout")}function l(){r===!1&&(n.className="",t.style.display="")}})(),R=(()=>{let e=new Event("allowKeyboardShortcuts"),t=new Event("denyKeyboardShortcuts"),n=null,r=null,s=null,i=!1;return{isVisible(){return i},init:o,toggle:l,hide:u};function o(){n=document.getElementById("search-container"),r=n.querySelector(".search-field"),s=a.siteHeader.querySelector("div.site-branding-container"),T(".nav-search-toggle","click",l),T(".nav-search-toggle","mousedown",c=>c.preventDefault()),r.addEventListener("blur",u),r.addEventListener("keydown",c=>{c.key==="Escape"&&(c.stopPropagation(),u())})}function l(){C()?v():u()}function u(){i&&B(!1,e,"","search")}function C(){return n.style.display.length===0?!(a.siteHeader.offsetHeight===0||I($.SITE_MAX_WIDTH_MOBILE)&&a.siteHeader.querySelector(".nav-bar-container-mobile-top").offsetHeight===0&&a.siteHeader.querySelector(".nav-bar-container-mobile-up").offsetHeight===0):!1}function v(){re(),B(!0,t,"flex","clear"),r.focus(),r.setSelectionRange(9999,9999)}function B(c,f,ie,ae){i=c,document.dispatchEvent(f),n.style.display=ie,document.querySelectorAll("div.nav-search-toggle span").forEach(oe=>oe.textContent=ae),i?document.getElementById("playback-controls").classList.add("hide"):document.getElementById("playback-controls").classList.remove("hide")}function re(){let c={};if(I($.SITE_MAX_WIDTH_MOBILE))s.offsetHeight!==0?c.top=s.offsetTop:c.top=a.siteHeader.querySelector(".nav-bar-container-mobile-up").offsetTop,c=new DOMRect(63,c.top+3,document.body.clientWidth-63,30);else if(s.offsetHeight!==0){let f=s.getBoundingClientRect();c=new DOMRect(f.left,f.top+10,f.right,f.height-20)}else{let f=a.siteHeader.querySelector(".nav-bar-container").getBoundingClientRect();c=new DOMRect(f.left+105,f.top+2,f.right-105,f.height-4)}n.style.left=`${c.left}px`,n.style.top=`${c.top}px`,n.style.width=`${c.width-c.left}px`,n.style.height=`${c.height}px`}})(),S=(()=>{let e=0;return{getHeaderHeight(){return e},addEventListener:t,trigger:n};function t(){n(),window.addEventListener("resize",n)}function n(){_()?e=k("--site-header-height-no-playback"):e=k("--site-header-height"),a.introBanner!==null&&a.introBanner.style.display.length!==0&&(a.introBanner.style.marginTop=`${e}px`,a.siteContent.style.marginTop=`${k("--site-content-margin-top")}px`)}})(),Le=(()=>{let e=0,t=!1;return{addEventListener:n};function n(){r(),window.addEventListener("scroll",r)}function r(){let l=window.pageYOffset,u=Math.round(S.getHeaderHeight()>150?S.getHeaderHeight()/2:S.getHeaderHeight()/3);l<1?s():l>u&&l>e?i():o(),R.hide(),e=l}function s(){a.siteHeader.classList.remove("sticky-nav-down","sticky-nav-up"),a.siteHeader.classList.add("hide-nav-menu"),m.scrolledTop()}function i(){t===!1&&(t=!0,E(a.siteHeader,"sticky-nav-up","sticky-nav-down"))}function o(){t===!0&&(t=!1,E(a.siteHeader,"sticky-nav-down","sticky-nav-up")),m.isVisible()&&m.toggle()}})();
//# sourceMappingURL=index.js.map
