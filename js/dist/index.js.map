{
  "version": 3,
  "sources": ["../src/shared/storage.js", "../src/shared/modal.js", "../src/site/interaction.js", "../src/site/term-rest.js", "../src/site/termlist.js", "../src/index.js"],
  "sourcesContent": ["//\r\n// Set and get storage values\r\n// Read, write and parse storage JSON data\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from './debuglogger.js';\r\n\r\nimport {\r\n  playbackSchema,\r\n  siteSchema,\r\n  validateSettings as validateSettingsDeep,\r\n} from  './settings.js';\r\n\r\n\r\nexport {\r\n  KEY,\r\n  isAvailable,\r\n  setCookie,\r\n  deleteCookie,\r\n  getValue,\r\n  setValue,\r\n  readJson,\r\n  writeJson,\r\n  readWriteSettingsProxy,\r\n  addSettingsObserver,\r\n};\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug     = debugLogger.newInstance('storage');\r\nconst observers = {};\r\n\r\nconst KEY = {\r\n//sessionStorage keys\r\n  UF_AUTOPLAY:          'UF_AUTOPLAY',\r\n  UF_TERMLIST_CACHE:    'UF_TERMLIST_CACHE',\r\n  UF_TERMLIST_STATE:    'UF_TERMLIST_STATE',\r\n//localStorage keys\r\n  UF_PLAYBACK_SETTINGS: 'UF_PLAYBACK_SETTINGS',\r\n  UF_SITE_SETTINGS:     'UF_SITE_SETTINGS',\r\n  UF_PRESET_LIST:       'UF_PRESET_LIST',\r\n  UF_SITE_THEME:        'UF_SITE_THEME',\r\n  UF_TRACK_LAYOUT:      'UF_TRACK_LAYOUT',\r\n//document.cookie keys\r\n  UF_TRACKS_PER_PAGE:   'UF_TRACKS_PER_PAGE',\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API/Using_the_Web_Storage_API\r\n// ************************************************************************************************\r\n\r\nfunction isAvailable(storageType)\r\n{\r\n  let storage;\r\n\r\n  try\r\n  {\r\n    storage = window[storageType];\r\n    const test = '__storage_test__';\r\n    storage.setItem(test, test);\r\n    storage.removeItem(test);\r\n    return true;\r\n  }\r\n  catch(exception)\r\n  {\r\n    return exception instanceof DOMException && (\r\n      // everything except Firefox\r\n      exception.code === 22 ||\r\n      // Firefox\r\n      exception.code === 1014 ||\r\n      // test name field too, because code might not be present\r\n      // everything except Firefox\r\n      exception.name === 'QuotaExceededError' ||\r\n      // Firefox\r\n      exception.name === 'NS_ERROR_DOM_QUOTA_REACHED') &&\r\n      // acknowledge QuotaExceededError only if there's something already stored\r\n      (storage && storage.length !== 0);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Set and delete cookie key => value pairs\r\n// ************************************************************************************************\r\n\r\nfunction setCookie(keyName, keyValue = '', maxAge = (60 * 60 * 24 * 365), path = '/')\r\n{\r\n  document.cookie = `${keyName}=${keyValue}; Max-Age=${maxAge}; Path=${path}; Secure; SameSite=Strict`;\r\n}\r\n\r\nfunction deleteCookie(keyName, path = '/')\r\n{\r\n  document.cookie = `${keyName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=${path}`;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// get / set local storage key => value pairs\r\n// ************************************************************************************************\r\n\r\nfunction getValue(keyName, defaultValue = null, setDefault = false)\r\n{\r\n  const keyValue = localStorage.getItem(keyName);\r\n\r\n  if (keyValue === null)\r\n  {\r\n    if (setDefault && (defaultValue !== null))\r\n      setValue(keyName, defaultValue);\r\n\r\n    return defaultValue;\r\n  }\r\n  \r\n  return keyValue;\r\n}\r\n\r\nfunction setValue(keyName, keyValue)\r\n{\r\n  try\r\n  {\r\n    localStorage.setItem(keyName, keyValue);\r\n  }\r\n  catch(exception)\r\n  {\r\n    debug.error(exception);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Read (parse) and write (stringify) JSON data from local storage\r\n// ************************************************************************************************\r\n\r\nfunction readJson(keyName, defaultValue = null, setDefault = false)\r\n{\r\n  debug.log(`readJson(): ${keyName} - ${defaultValue} - ${setDefault}`);\r\n  \r\n  const keyValue     = localStorage.getItem(keyName);\r\n  let parsedKeyValue = null;\r\n\r\n  if (keyValue === null)\r\n  {\r\n    if (setDefault && (defaultValue !== null))\r\n      writeJson(keyName, defaultValue);\r\n\r\n    return defaultValue;\r\n  }\r\n  else\r\n  {\r\n    try\r\n    {\r\n      parsedKeyValue = JSON.parse(keyValue);\r\n    }\r\n    catch(exception)\r\n    {\r\n      debug.error(exception);\r\n\r\n      // ToDo: Return error state to specify (for the user) that default settings are used??\r\n      if (defaultValue !== null)\r\n        parsedKeyValue = defaultValue;\r\n    }\r\n  }\r\n\r\n  return parsedKeyValue;\r\n}\r\n\r\nfunction writeJson(keyName, keyData)\r\n{\r\n  debug.log(`writeJson(): ${keyName} - ${keyData}`);\r\n\r\n  try\r\n  {\r\n    localStorage.setItem(keyName, JSON.stringify(keyData));\r\n  }\r\n  catch(exception)\r\n  {\r\n    debug.error(exception);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Recursive merge and cleanup for settings objects on new version\r\n// ************************************************************************************************\r\n\r\nfunction mergeSettings(oldSettings, newSettings, settingsKey)\r\n{\r\n  debug.log(`mergeSettings(): Merging ${settingsKey} from version ${oldSettings.version} to version ${newSettings.version}`);\r\n\r\n  const mergedSettings = { version: newSettings.version };\r\n\r\n  mergeDeep(oldSettings, newSettings, mergedSettings);\r\n  cleanDeep(mergedSettings, newSettings);\r\n\r\n  return mergedSettings;\r\n}\r\n\r\nfunction mergeDeep(oldSettings, newSettings, destination)\r\n{\r\n  for (const key in newSettings)\r\n  {\r\n    if (typeof newSettings[key] === 'object')\r\n    {\r\n      if (oldSettings && (typeof oldSettings[key] === 'object'))\r\n      {\r\n        debug.log(`mergeDeep() - Merging: ${key}`);\r\n        destination[key] = { ...newSettings[key], ...oldSettings[key] };\r\n        mergeDeep(oldSettings[key], newSettings[key], destination[key]);\r\n      }\r\n      else\r\n      {\r\n        debug.log(`mergeDeep() - Copying: ${key}`);\r\n        destination[key] = { ...newSettings[key] };\r\n        mergeDeep({}, newSettings[key], destination[key]);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// Delete all orphaned Settings properties / objects that are no longer in use after merge\r\nfunction cleanDeep(mergedSettings, newSettings)\r\n{\r\n  for (const key in mergedSettings)\r\n  {\r\n    if ((key in newSettings) === false)\r\n    {\r\n      debug.log(`cleanDeep() - Deleting: ${key} (${(typeof mergedSettings[key] === 'object') ? 'object' : 'property'})`);\r\n      delete mergedSettings[key];\r\n    }\r\n    \r\n    if (typeof mergedSettings[key] === 'object')\r\n      cleanDeep(mergedSettings[key], newSettings[key]);\r\n  }\r\n}\r\n\r\nfunction validateSettings(settingsKey, settingsObject, defaultSettings)\r\n{\r\n  try\r\n  {\r\n    let invalidSettingsCount = 0;\r\n\r\n    switch(settingsKey)\r\n    {\r\n      case KEY.UF_PLAYBACK_SETTINGS:\r\n        invalidSettingsCount = validateSettingsDeep(settingsObject, playbackSchema);\r\n        break;\r\n\r\n      case KEY.UF_SITE_SETTINGS:\r\n        invalidSettingsCount = validateSettingsDeep(settingsObject, siteSchema);\r\n        break;\r\n    }\r\n\r\n    if (invalidSettingsCount > 0)\r\n      writeJson(settingsKey, settingsObject);\r\n  }\r\n  catch(exception)\r\n  {\r\n    debug.error(`validateSettings() exception: ${exception} -- using default settings`);\r\n\r\n    writeJson(settingsKey, defaultSettings);\r\n\r\n    return defaultSettings;\r\n  }\r\n\r\n  return settingsObject;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Read and write settings proxy\r\n// ************************************************************************************************\r\n\r\nfunction readWriteSettingsProxy(settingsKey, defaultSettings = null, setDefault = false)\r\n{\r\n  const parsedJson = readJson(settingsKey, defaultSettings, setDefault);\r\n\r\n  if ((parsedJson !== null) && (defaultSettings !== null) && (parsedJson.version !== undefined))\r\n  {\r\n    let settingsObject = parsedJson;\r\n    \r\n    // If version is new, perform settings merge and cleanup\r\n    if (parsedJson.version < defaultSettings.version)\r\n    {\r\n      debug.log(parsedJson);\r\n\r\n      settingsObject = mergeSettings(parsedJson, defaultSettings, settingsKey);\r\n      writeJson(settingsKey, settingsObject);\r\n\r\n      debug.log(settingsObject);\r\n    }\r\n\r\n    return onSettingsChange(settingsKey, validateSettings(settingsKey, settingsObject, defaultSettings));\r\n  }\r\n\r\n  if (defaultSettings !== null)\r\n  {\r\n    debug.warn(`readWriteSettingsProxy() - Failed for: ${settingsKey} -- using default settings`);\r\n\r\n    writeJson(settingsKey, defaultSettings);\r\n\r\n    return onSettingsChange(settingsKey, defaultSettings);\r\n  }\r\n\r\n  debug.error(`readWriteSettingsProxy() - Fatal error for: ${settingsKey} -- unable to read settings!`);\r\n\r\n  return null;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Proxy traps (handlers) for settings get and set\r\n// ************************************************************************************************\r\n\r\nconst onSettingsChange = (settingsKey, settingsObject) =>\r\n{ \r\n  const handler =\r\n  {\r\n    get(target, property, receiver)\r\n    {\r\n    //debug.log(`onSettingsChange(): Get property: ${property}`);\r\n      \r\n      if (property in target)\r\n      {      \r\n        const value = Reflect.get(target, property, receiver);\r\n        \r\n        if (typeof value === 'object')\r\n          return new Proxy(value, handler);\r\n\r\n        return value;\r\n      }\r\n\r\n      debug.error(`onSettingsChange(): Get unknown property: ${property}`);\r\n    },\r\n    \r\n    set(target, property, newValue, receiver)\r\n    {\r\n    //debug.log(`onSettingsChange(): Set property: ${property}`);\r\n\r\n      if (property in target)\r\n      {\r\n        const oldValue = Reflect.get(target, property, receiver);\r\n\r\n        // Only update and write data if it has changed\r\n        if (newValue !== oldValue)\r\n        {\r\n          Reflect.set(target, property, newValue);\r\n          writeJson(settingsKey, settingsObject);\r\n          callSettingsObservers(property, oldValue, newValue);\r\n        }\r\n\r\n        return true;\r\n      }\r\n\r\n      debug.error(`onSettingsChange(): Set unknown property: ${property}`);\r\n      return true;\r\n    },\r\n  };\r\n\r\n  return new Proxy(settingsObject, handler);\r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Add and call settings observers on property changes\r\n// ************************************************************************************************\r\n\r\nfunction addSettingsObserver(property, observer)\r\n{\r\n  debug.log(`addSettingsObserver() for property: ${property}`);\r\n\r\n  if ((property in observers) === false)\r\n    observers[property] = [];\r\n\r\n  observers[property].push(observer);\r\n}\r\n\r\nfunction callSettingsObservers(property, oldValue, newValue)\r\n{\r\n  if (property in observers)\r\n  {\r\n    debug.log(`callSettingsObserver() for property: ${property} - oldValue: ${oldValue} - newValue: ${newValue}`);\r\n    observers[property].forEach((observer) => observer(oldValue, newValue));\r\n  }\r\n}\r\n", "//\r\n// Modal dialog UI module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from './debuglogger.js';\r\n\r\n\r\nexport {\r\n  showModal,\r\n};\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug = debugLogger.newInstance('modal');\r\n\r\nconst mConfig = {\r\n  id: 'modal',\r\n};\r\n\r\nconst mTemplate = `\r\n  <div id=\"${mConfig.id}-dialog\" tabindex=\"-1\">\r\n    <div class=\"${mConfig.id}-container\">\r\n      <div class=\"${mConfig.id}-header\">\r\n        <div class=\"${mConfig.id}-title\"></div>\r\n        <div class=\"${mConfig.id}-close-button\"><span class=\"material-icons\" title=\"Dismiss\">close</span></div>\r\n      </div>\r\n      <div class=\"${mConfig.id}-body\"></div>\r\n    </div>\r\n  </div>\r\n`;\r\n\r\nconst mElements = {\r\n  overlay:   null,\r\n  container: null,\r\n  body:      null,\r\n};\r\n\r\nlet selectedClick = null;\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction showModal(title, singleChoiceList, selectedClickCallback)\r\n{\r\n  debug.log(`showModal(): ${title}`);\r\n\r\n  init();\r\n  \r\n  selectedClick = selectedClickCallback;\r\n  setSingleChoiceList(singleChoiceList);\r\n\r\n  mElements.container.querySelector(`.${mConfig.id}-title`).innerHTML = title;\r\n  mElements.overlay.classList.add('show');\r\n  mElements.overlay.addEventListener('keydown', keyDown);\r\n  mElements.overlay.focus();\r\n  disablePageScrolling(true);\r\n}\r\n\r\nfunction init()\r\n{\r\n  if (mElements.container === null)\r\n  {\r\n    document.body.insertAdjacentHTML('beforeend', mTemplate);\r\n    \r\n    mElements.overlay   = document.getElementById(`${mConfig.id}-dialog`);\r\n    mElements.container = mElements.overlay.querySelector(`.${mConfig.id}-container`);\r\n    mElements.body      = mElements.overlay.querySelector(`.${mConfig.id}-body`);\r\n\r\n    mElements.overlay.addEventListener('click', (event) =>\r\n    {\r\n      if (event.target === mElements.overlay)\r\n        close();\r\n    });\r\n\r\n    mElements.overlay.addEventListener('animationend', () =>\r\n    {\r\n      if (mElements.overlay.classList.contains('hide'))\r\n      {\r\n        mElements.overlay.className = '';\r\n        disablePageScrolling(false);\r\n      }\r\n    });\r\n\r\n    mElements.overlay.querySelector(`.${mConfig.id}-close-button`).addEventListener('click', close);\r\n  }\r\n}\r\n\r\nfunction setSingleChoiceList(singleChoiceList)\r\n{\r\n  let listHtml = '';\r\n\r\n  singleChoiceList.forEach(entry => listHtml += `<div id=\"${entry.id}\" class=\"${mConfig.id}-single-choice\">${entry.description}</div>`);\r\n  mElements.body.innerHTML = listHtml;\r\n\r\n  singleChoiceList.forEach(entry => mElements.body.querySelector(`#${entry.id}`).addEventListener('click', singleChoiceListClick));\r\n}\r\n\r\nfunction singleChoiceListClick()\r\n{\r\n  close();\r\n  setTimeout(() => selectedClick(this.id), 150);\r\n}\r\n\r\nfunction keyDown(event)\r\n{\r\n  event.stopPropagation();\r\n\r\n  if (event.key === 'Escape')\r\n    close();\r\n}\r\n\r\nfunction close()\r\n{\r\n  mElements.overlay.removeEventListener('keydown', keyDown);\r\n  mElements.overlay.classList.replace('show', 'hide');\r\n}\r\n\r\nfunction disablePageScrolling(disable)\r\n{\r\n  const scrollbarWidth = window.innerWidth - document.documentElement.clientWidth;\r\n//document.body.style.touchAction  = disable ? 'none'   : '';\r\n  document.body.style.overflow     = disable ? 'hidden' : '';\r\n  document.body.style.paddingRight = disable ? `${scrollbarWidth}px` : '';\r\n  document.getElementById('site-header').style.paddingRight = disable ? `${scrollbarWidth}px` : '';\r\n}\r\n", "//\r\n// Ultrafunk site interaction\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger  from '../shared/debuglogger.js';\r\nimport * as utils        from '../shared/utils.js';\r\nimport { showModal }     from '../shared/modal.js';\r\nimport { showSnackbar }  from '../shared/snackbar.js';\r\nimport { KEY, setValue } from '../shared/storage.js';\r\n\r\n\r\nexport {\r\n  init,\r\n  settingsUpdated,\r\n  siteTheme,\r\n  trackLayout,\r\n  shareModal,\r\n};\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug         = debugLogger.newInstance('site-interaction');\r\nconst htmlClassList = document.documentElement.classList;\r\nlet settings        = {};\r\n\r\n\r\n// ************************************************************************************************\r\n//\r\n// ************************************************************************************************\r\n\r\nfunction init(siteSettings)\r\n{\r\n  debug.log('init()');\r\n\r\n  settings = siteSettings;\r\n\r\n  siteTheme.init();\r\n  trackLayout.init();\r\n\r\n  utils.addEventListeners('.entry-meta-controls .track-share-control', 'click', trackShareControlClick);\r\n}\r\n\r\nfunction settingsUpdated(updatedSettings)\r\n{\r\n  settings = updatedSettings;\r\n  siteTheme.setCurrent();\r\n  trackLayout.setCurrent();\r\n}\r\n\r\nfunction trackShareControlClick(event)\r\n{\r\n  const artistTrackTitle = event.target.getAttribute('data-artist-track-title');\r\n  const trackUrl         = event.target.getAttribute('data-track-url');\r\n \r\n  shareModal.show({ string: artistTrackTitle, filterString: true, url: trackUrl });\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Site theme and layout settings helpers\r\n// ************************************************************************************************\r\n\r\nfunction getCurrentSetting(settings, currentId, defaultSetting)\r\n{\r\n  const setting = Object.values(settings).find(value => value.id === currentId);\r\n  return ((setting !== undefined) ? setting : defaultSetting);\r\n}\r\n\r\nfunction getNextSetting(settings, currentSetting)\r\n{\r\n  const index = Object.values(settings).findIndex(value => value.id === currentSetting.id);\r\n  const keys  = Object.keys(settings);\r\n  return (((index + 1) < keys.length) ? settings[keys[index + 1]] : settings[keys[0]]);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Site theme handling\r\n// ************************************************************************************************\r\n\r\nconst siteTheme = (() =>\r\n{\r\n  let currentTheme = {};\r\n  const elements   = { toggle: null };\r\n\r\n  const config = {\r\n    toggleId:       '#footer-site-theme-toggle',\r\n    prefDarkScheme: '(prefers-color-scheme: dark)',\r\n  };\r\n  \r\n  const themes = {\r\n    light: { id: 'light', text: 'light', class: 'site-theme-light' },\r\n    dark:  { id: 'dark',  text: 'dark',  class: 'site-theme-dark'  },\r\n    auto:  { id: 'auto',  text: 'auto'                             }, // This has no CSS class since auto is always light or dark\r\n  };\r\n\r\n  return {\r\n    init,\r\n    setCurrent,\r\n    toggle,\r\n  };\r\n\r\n  function init()\r\n  {\r\n    elements.toggle = document.querySelector(config.toggleId);\r\n    const mediaQueryList = window.matchMedia(config.prefDarkScheme);\r\n    mediaQueryList.addEventListener('change', matchMediaPrefColorScheme);\r\n    utils.addEventListeners(config.toggleId, 'click', toggle);\r\n    setCurrent();\r\n  }\r\n  \r\n  function setCurrent()\r\n  {\r\n    currentTheme = getCurrentSetting(themes, settings.user.theme, themes.auto);\r\n    updateData();\r\n  }\r\n  \r\n  function matchMediaPrefColorScheme()\r\n  {\r\n    if (currentTheme.id === themes.auto.id)\r\n      updateData();\r\n  }\r\n  \r\n  function toggle(event)\r\n  {\r\n    event.preventDefault();\r\n    currentTheme = getNextSetting(themes, currentTheme);\r\n    settings.user.theme = currentTheme.id;\r\n    updateData();  \r\n  }\r\n  \r\n  function updateData()\r\n  {\r\n    let newTheme = currentTheme;\r\n  \r\n    if (currentTheme.id === themes.auto.id)\r\n      newTheme = window.matchMedia(config.prefDarkScheme).matches ? themes.dark : themes.light;\r\n  \r\n    setValue(KEY.UF_SITE_THEME, newTheme.id);\r\n    updateDOM(newTheme);\r\n  }\r\n  \r\n  function updateDOM(newTheme)\r\n  {\r\n    // Only update DOM if something has actually changed...\r\n    if (htmlClassList.contains(newTheme.class) === false)\r\n    {\r\n      debug.log(`updateDOM() - newSiteTheme: ${newTheme.id}`);\r\n    \r\n      htmlClassList.remove(themes.light.class, themes.dark.class);\r\n      htmlClassList.add(newTheme.class);\r\n    }\r\n\r\n    // Always update this because AUTO is not a separate class (only DARK + LIGHT are classes)\r\n    elements.toggle.querySelector('span').textContent = currentTheme.text;\r\n  }\r\n})();\r\n\r\n\r\n// ************************************************************************************************\r\n// Track layout handling\r\n// ************************************************************************************************\r\n\r\nconst trackLayout = (() =>\r\n{\r\n  let currentLayout = {};\r\n  const elements    = { toggle: null };\r\n\r\n  const config = {\r\n    toggleId: '#footer-track-layout-toggle',\r\n    minWidth: `(max-width: ${utils.getCssPropString('--site-track-layout-min-width')})`,\r\n  };\r\n\r\n  const layouts = {\r\n    list:        { id: 'list',     text: 'list',         class: 'track-layout-list'     },\r\n    twoColumn:   { id: '2-column', text: '2 column',     class: 'track-layout-2-column' },\r\n    threeColumn: { id: '3-column', text: '3 / 4 column', class: 'track-layout-3-column' },\r\n  };\r\n\r\n  return {\r\n    init,\r\n    setCurrent,\r\n    toggle,\r\n  };\r\n\r\n  function init()\r\n  {\r\n    elements.toggle = document.querySelector(config.toggleId);\r\n    const mediaQueryList = window.matchMedia(config.minWidth);\r\n    mediaQueryList.addEventListener('change', matchMediaMinWidth);\r\n    utils.addEventListeners(config.toggleId, 'click', toggle);\r\n    setCurrent();\r\n  }\r\n\r\n  function setCurrent()\r\n  {\r\n    currentLayout = getCurrentSetting(layouts, settings.user.trackLayout, layouts.threeColumn);\r\n    elements.toggle.querySelector('span').textContent = currentLayout.text;\r\n    updateData();\r\n  }\r\n  \r\n  function matchMediaMinWidth(event)\r\n  {\r\n    if (htmlClassList.contains('user-layout'))\r\n      event.matches ? htmlClassList.remove(currentLayout.class) : htmlClassList.add(currentLayout.class);\r\n  }\r\n  \r\n  function toggle(event)\r\n  {\r\n    event.preventDefault();\r\n    currentLayout = getNextSetting(layouts, currentLayout);\r\n    settings.user.trackLayout = currentLayout.id;\r\n    updateData();\r\n\r\n    if (event.type === 'click')\r\n      elements.toggle.scrollIntoView();\r\n  }\r\n  \r\n  function updateData()\r\n  {\r\n    setValue(KEY.UF_TRACK_LAYOUT, currentLayout.id);\r\n    updateDOM();\r\n  }\r\n  \r\n  function updateDOM()\r\n  {\r\n    // Only update DOM if needed and when something has actually changed\r\n    if ((htmlClassList.contains('user-layout')) && (htmlClassList.contains(currentLayout.class) === false))\r\n    {\r\n      debug.log(`updateDOM() - newTrackLayout: ${currentLayout.id}`);\r\n\r\n      htmlClassList.remove(layouts.list.class, layouts.twoColumn.class, layouts.threeColumn.class);\r\n\r\n      if (window.matchMedia(config.minWidth).matches === false)\r\n        htmlClassList.add(currentLayout.class);\r\n    }\r\n\r\n    elements.toggle.querySelector('span').textContent = currentLayout.text;\r\n  }\r\n})();\r\n\r\n\r\n// ************************************************************************************************\r\n// Share Dialog module\r\n// ************************************************************************************************\r\n\r\nconst shareModal = (() =>\r\n{\r\n  const filterStringRegEx = /\\s{1,}[\u2013\u00B7-]\\s{1,}/i;\r\n  let title, string, filterString, url, verb;\r\n\r\n  return {\r\n    show,\r\n  };\r\n  \r\n  function show(args)\r\n  {\r\n    ({\r\n      title        = 'Share / Play Track',\r\n      string       = null,\r\n      filterString = false,\r\n      url          = null,\r\n      verb         = 'Play'\r\n    } = args);\r\n\r\n    showModal(title, getSingleChoiceList(verb), singleChoiceListClick);\r\n  }\r\n\r\n  function getSingleChoiceList(verb)\r\n  {\r\n    return [\r\n      { id: 'copyToClipboardId', description: '<b>Copy Link</b> to Clipboard'   },\r\n      { id: 'shareOnEmailId',    description: '<b>Share</b> on Email'           },\r\n      { id: 'amazonMusicId',     description: `<b>${verb}</b> on Amazon Music`  },\r\n      { id: 'appleMusicId',      description: `<b>${verb}</b> on Apple Music`   },\r\n      { id: 'spotifyId',         description: `<b>${verb}</b> on Spotify`       },\r\n      { id: 'tidalId',           description: `<b>${verb}</b> on Tidal`         },\r\n      { id: 'youTubeMusicId',    description: `<b>${verb}</b> on YouTube Music` },\r\n    ];\r\n  }\r\n\r\n  function singleChoiceListClick(clickId)\r\n  {\r\n    debug.log(`singleChoiceListClick(): ${clickId} - title: \"${title}\" - string: \"${string}\" - filterString: ${filterString} - url: ${url} - verb: ${verb}`);\r\n\r\n    const searchString = filterString ? encodeURIComponent(string.replace(filterStringRegEx, ' ')) : encodeURIComponent(string);\r\n\r\n    switch (clickId)\r\n    {\r\n      case 'copyToClipboardId':\r\n        navigator.clipboard.writeText(url).then(() =>\r\n        {\r\n          showSnackbar('Track link copied to clipboard', 3);\r\n        },\r\n        (reason) =>\r\n        {\r\n          debug.error(`shareModal.copyToClipboard() failed because ${reason}`);\r\n          showSnackbar('Unable to copy Track link to clipboard', 5);\r\n        });\r\n        break;\r\n\r\n      case 'shareOnEmailId':\r\n        window.location.href = `mailto:?subject=${encodeURIComponent(string)}&body=${url}%0d%0a`;\r\n        break;\r\n\r\n      case 'amazonMusicId':\r\n        window.open(`https://music.amazon.com/search/${searchString}`, \"_blank\");\r\n        break;\r\n\r\n      case 'appleMusicId':\r\n        window.open(`https://music.apple.com/ca/search?term=${searchString}`, \"_blank\");\r\n        break;\r\n\r\n      case 'spotifyId':\r\n        window.open(`https://open.spotify.com/search/${searchString}`, \"_blank\");\r\n        break;\r\n\r\n      case 'tidalId':\r\n        window.open(`https://google.com/search?q=${searchString}%20site:tidal.com`, \"_blank\");\r\n        break;\r\n\r\n      case 'youTubeMusicId':\r\n        window.open(`https://music.youtube.com/search?q=${searchString}`, \"_blank\");\r\n        break;\r\n    }\r\n  }\r\n})();\r\n", "//\r\n// Term REST data fetch and caching\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../shared/debuglogger.js';\r\nimport { KEY }          from '../shared/storage.js';\r\n\r\n\r\nexport {\r\n  fetchPosts,\r\n  fetchMeta,\r\n  readCache,\r\n  writeCache,\r\n  deleteCache,\r\n  hasCache,\r\n};\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug   = debugLogger.newInstance('term-rest');\r\nlet termCache = {};\r\n\r\n\r\n// ************************************************************************************************\r\n// Fetch tracks (posts) for a given termType with termId (taxonomy: category or tag)\r\n// ************************************************************************************************\r\n\r\nfunction fetchPosts(termType, termId, maxItems, callback)\r\n{ \r\n  if (termId in termCache)\r\n  {\r\n    callback(termCache[termId].posts);\r\n  }\r\n  else\r\n  {\r\n    debug.log(`fetchPosts() - termType: ${termType} - termId: ${termId} - maxItems: ${maxItems}`);\r\n\r\n    fetch(`/wp-json/wp/v2/posts?${termType}=${termId}&per_page=${maxItems}&_fields=title,link,content,tags,categories`)\r\n    .then(response => \r\n    {\r\n      if (!response.ok)\r\n      {\r\n        debug.error(response);\r\n        return null;\r\n      }\r\n      \r\n      return response.json();\r\n    })\r\n    .then(data =>\r\n    {\r\n      termCache[termId] = { posts: data };\r\n      callback(data);\r\n    })\r\n    .catch(reason =>\r\n    {\r\n      debug.warn(reason);\r\n      callback(null);\r\n    });\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Merge then fetch metadata for a given termType with termIds (taxonomy: category or tag)\r\n// ************************************************************************************************\r\n\r\nfunction fetchMeta(termData, termId, maxItems, callback)\r\n{\r\n  if (('categories' in termCache[termId]) && ('tags' in termCache[termId]))\r\n  {\r\n    callback('categories', termCache[termId].categories);\r\n    callback('tags',       termCache[termId].tags);\r\n  }\r\n  else\r\n  {\r\n    const categories = [];\r\n    let   tags       = [];\r\n  \r\n    termData.forEach(item =>\r\n    {\r\n      categories.push.apply(categories, item.categories);\r\n      tags.push.apply(tags, item.tags);\r\n    });\r\n  \r\n    tags = tags.filter(item => item !== termId);\r\n  \r\n    fetchMetadata('categories', termId, [...new Set(categories)], maxItems, callback);\r\n    fetchMetadata('tags',       termId, [...new Set(tags)],       maxItems, callback);\r\n  }\r\n}\r\n\r\nfunction fetchMetadata(termType, termId, termIds, maxItems, callback)\r\n{\r\n  if (termIds.length > 0)\r\n  {\r\n    debug.log(`fetchMetadata() - termType: ${termType} - termIds: ${(termIds.length > 0) ? termIds : 'Empty'} - maxItems: ${maxItems}`);\r\n\r\n    fetch(`/wp-json/wp/v2/${termType}?include=${termIds.join(',')}&per_page=${maxItems}&_fields=link,name`)\r\n    .then(response => \r\n    {\r\n      if (!response.ok)\r\n      {\r\n        debug.error(response);\r\n        return null;\r\n      }\r\n      \r\n      return response.json();\r\n    })\r\n    .then(data =>\r\n    {\r\n      termCache[termId][termType] = data;\r\n      callback(termType, data);\r\n    })\r\n    .catch(reason =>\r\n    {\r\n      debug.warn(reason);\r\n      callback(null);\r\n    });\r\n  }\r\n  else\r\n  {\r\n    termCache[termId][termType] = null;\r\n    callback(termType, null);\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Term cache functions\r\n// ************************************************************************************************\r\n\r\nfunction readCache()\r\n{\r\n  termCache = JSON.parse(sessionStorage.getItem(KEY.UF_TERMLIST_CACHE));\r\n  \r\n  if (termCache === null)\r\n    termCache = {};\r\n}\r\n\r\nfunction writeCache()\r\n{\r\n  sessionStorage.setItem(KEY.UF_TERMLIST_CACHE, JSON.stringify(termCache));\r\n}\r\n\r\nfunction deleteCache()\r\n{\r\n  sessionStorage.removeItem(KEY.UF_TERMLIST_CACHE);\r\n}\r\n\r\nfunction hasCache()\r\n{\r\n  return (Object.keys(termCache).length > 0);\r\n}\r\n", "//\r\n// Termlist UI module\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from '../shared/debuglogger.js';\r\nimport * as termRest    from './term-rest.js';\r\nimport { KEY }          from '../shared/storage.js';\r\nimport { shareModal }   from './interaction.js';\r\nimport { replaceClass } from '../shared/utils.js';\r\n\r\nimport {\r\n  setArtistTitle,\r\n  getYouTubeImgUrl,\r\n} from '../playback/mediaplayers.js';\r\n\r\n\r\nexport {\r\n  init,\r\n};\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug            = debugLogger.newInstance('termlist');\r\nconst artistTitleRegEx = /\\s{1,}[\u2013\u00B7-]\\s{1,}|\\s{1,}(&#8211;)\\s{1,}/i;\r\nconst iframeSrcRegEx   = /(?<=src=\").*?(?=[?\"])/i;\r\n\r\n\r\n// ************************************************************************************************\r\n// Setup module\r\n// ************************************************************************************************\r\n\r\nfunction init()\r\n{\r\n  debug.log('init()');\r\n\r\n  document.getElementById('termlist-container').addEventListener('click', (event) =>\r\n  {\r\n    const playButton = event.target.closest('div.play-button');\r\n    if (playButton !== null ) return playShuffleButtonClick(event, playButton.querySelector('a').href);\r\n\r\n    const shuffleButton = event.target.closest('div.shuffle-button');\r\n    if (shuffleButton !== null ) return playShuffleButtonClick(event, shuffleButton.querySelector('a').href);\r\n\r\n    const shareFindButton = event.target.closest('div.share-find-button');\r\n    if (shareFindButton !== null ) return shareFindButtonClick(shareFindButton);\r\n   \r\n    const termlistHeader = event.target.closest('div.termlist-header');\r\n    if (termlistHeader !== null ) return termlistHeaderClick(event);\r\n\r\n    const thumbnailPlay = event.target.closest('div.thumbnail');\r\n    if (thumbnailPlay !== null ) return playShuffleButtonClick(event, thumbnailPlay.getAttribute('data-track-url'));\r\n\r\n    const linkElement = event.target.closest('a');\r\n    if (linkElement !== null) return saveState();\r\n  });\r\n\r\n  restoreState();\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Save and restore Termlist state\r\n// ************************************************************************************************\r\n\r\nfunction saveState()\r\n{\r\n  if (termRest.hasCache())\r\n  {\r\n    const termlistState = {\r\n      pageUrl:     window.location.href,\r\n      scrollPos:   Math.round(window.pageYOffset),\r\n      openTermIds: [],\r\n    };\r\n\r\n    document.querySelectorAll('.termlist-entry').forEach(element =>\r\n    {\r\n      if (element.classList.contains('open'))\r\n        termlistState.openTermIds.push(element.id);\r\n    });\r\n    \r\n    sessionStorage.setItem(KEY.UF_TERMLIST_STATE, JSON.stringify(termlistState));\r\n    termRest.writeCache();\r\n  }\r\n}\r\n\r\nfunction restoreState()\r\n{\r\n  termRest.readCache();\r\n  \r\n  if (performance.navigation.type !== performance.navigation.TYPE_RELOAD)\r\n  {\r\n    const termlistState = JSON.parse(sessionStorage.getItem(KEY.UF_TERMLIST_STATE));\r\n \r\n    if ((termlistState !== null) && (termlistState.pageUrl === window.location.href))\r\n    {\r\n      history.scrollRestoration = 'manual';\r\n      termlistState.openTermIds.forEach(item => document.getElementById(item).querySelector('div.termlist-header').click());\r\n      window.scroll({ top: termlistState.scrollPos, left: 0, behavior: 'auto' });\r\n    }\r\n    else\r\n    {\r\n      history.scrollRestoration = 'auto';\r\n    }\r\n  }\r\n\r\n  sessionStorage.removeItem(KEY.UF_TERMLIST_STATE);\r\n  termRest.deleteCache();\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Click event functions\r\n// ************************************************************************************************\r\n\r\nfunction playShuffleButtonClick(event, destUrl)\r\n{\r\n  event.preventDefault();\r\n  saveState();\r\n\r\n  // ToDo: Create a playbackSetting for this? Or use SHIFT + click to skip autoplay\r\n  if (event.shiftKey === false)\r\n    sessionStorage.setItem(KEY.UF_AUTOPLAY, 'true');\r\n  \r\n  window.location.href = destUrl;\r\n}\r\n\r\nfunction shareFindButtonClick(shareFindButton)\r\n{\r\n  const termType = shareFindButton.getAttribute('data-term-type');\r\n  const termName = shareFindButton.getAttribute('data-term-name');\r\n  const termUrl  = shareFindButton.getAttribute('data-term-url');\r\n\r\n  shareModal.show({ title: `Share / Find ${termType}`, string: termName, url: termUrl, verb: 'Find' });\r\n}\r\n\r\nfunction termlistHeaderClick(event)\r\n{\r\n  const termlistEntry = event.target.closest('div.termlist-entry');\r\n  const expandToggle  = termlistEntry.querySelector('div.expand-toggle span');\r\n  const termlistBody  = termlistEntry.querySelector('div.termlist-body');\r\n  const isExpanded    = (termlistBody.style.display.length !== 0);\r\n\r\n  replaceClass(termlistEntry, (isExpanded ? 'open' : 'closed'), (isExpanded ? 'closed' : 'open'));\r\n\r\n  expandToggle.innerText     = isExpanded ? 'expand_more' : 'expand_less';\r\n  termlistBody.style.display = isExpanded ? ''            : 'flex';\r\n\r\n  if (!isExpanded)\r\n    fetchDataUpdateDOM(termlistEntry, termlistBody);\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Fetch data via REST API and update DOM with results\r\n// ************************************************************************************************\r\n\r\nfunction fetchDataUpdateDOM(termlistEntry, termlistBody)\r\n{\r\n  const termType      = document.getElementById('termlist-container').getAttribute('data-term-type');\r\n  const termId        = parseInt(termlistEntry.getAttribute('data-term-id'));\r\n  const isAllChannels = (termType === 'categories');\r\n\r\n  termRest.fetchPosts(termType, termId, (isAllChannels ? 10 : 50), (termData) => \r\n  {\r\n    let header  = isAllChannels ? 'Latest Tracks' : 'All Tracks';\r\n    let element = termlistBody.querySelector('.body-left');\r\n\r\n    if (termData !== null)\r\n      insertThumbnailListHtml(header, termData, element);\r\n    else\r\n      element.innerHTML = `<b>Error!</b><br>Unable to fetch track data...`;\r\n\r\n    if (!isAllChannels && (termData !== null))\r\n    {\r\n      termRest.fetchMeta(termData, termId, 50, (metaType, metadata) =>\r\n      {\r\n        header  = (metaType === 'tags') ? 'Related Artists' : 'In Channels';\r\n        element = (metaType === 'tags') ? termlistBody.querySelector('.artists') : termlistBody.querySelector('.channels');\r\n\r\n        if (metadata !== null)\r\n          insertLinksHtml(header, metadata, element);\r\n        else\r\n          element.innerHTML = `<b>${header}</b><br>None found`;\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\nfunction getThumbnail(contentHtml)\r\n{\r\n  if (contentHtml.includes('id=\"soundcloud-uid'))\r\n    return { src: '/wp-content/themes/ultrafunk/inc/img/soundcloud_icon.png', class: 'type-soundcloud' };\r\n  else\r\n    return getYouTubeImgUrl(contentHtml.match(iframeSrcRegEx));\r\n}\r\n\r\nfunction insertThumbnailListHtml(header, termData, destElement)\r\n{\r\n  const artistTitle = {};\r\n  let thumbnail     = {};\r\n  let html          = `<b>${header}</b>`;\r\n\r\n  termData.forEach(item =>\r\n  {\r\n    setArtistTitle(item.title.rendered, artistTitle, artistTitleRegEx);\r\n    thumbnail = getThumbnail(item.content.rendered);\r\n\r\n    html += `\r\n    <div class=\"track\">\r\n      <div class=\"thumbnail ${thumbnail.class}\" data-track-url=\"${item.link}\" title=\"Play Track\">\r\n        <img src=\"${thumbnail.src}\">\r\n        <div class=\"thumbnail-overlay\"><span class=\"material-icons\">play_arrow</span></div>\r\n      </div>\r\n      <div class=\"artist-title text-nowrap-ellipsis\">\r\n        <a href=\"${item.link}\" title=\"Go to track\"><span><b>${artistTitle.artist}</b></span><br><span>${artistTitle.title}</span></a>\r\n      </div>\r\n    </div>`;\r\n  });\r\n  \r\n  destElement.innerHTML = html;\r\n}\r\n\r\nfunction insertLinksHtml(header, termData, destElement)\r\n{\r\n  let html = `<b>${header}</b><br>`;\r\n  termData.forEach(item => html += `<a href=\"${item.link}\">${item.name}</a>, `);\r\n  destElement.innerHTML = html.slice(0, (html.length - 2));\r\n}\r\n", "//\r\n// Ultrafunk theme JavaScript\r\n//\r\n// https://ultrafunk.com\r\n//\r\n\r\n\r\nimport * as debugLogger from './shared/debuglogger.js';\r\nimport * as storage     from './shared/storage.js';\r\nimport * as utils       from './shared/utils.js';\r\nimport * as interaction from './site/interaction.js';\r\nimport * as termlist    from './site/termlist.js';\r\nimport { siteSettings } from './shared/settings.js';\r\n\r\n\r\n/*************************************************************************************************/\r\n\r\n\r\nconst debug   = debugLogger.newInstance('index');\r\nlet mSettings = {};\r\n\r\nconst mConfig = {\r\n  smoothScrolling:      false,\r\n  settingsUpdatedEvent: 'settingsUpdated',\r\n  fullscreenTrackEvent: 'fullscreenTrack',\r\n};\r\n\r\nconst mElements = {\r\n  siteHeader:        null,\r\n  introBanner:       null,\r\n  siteContent:       null,\r\n  siteContentSearch: null,\r\n  fullscreenTarget:  null,  \r\n};\r\n\r\n\r\n// ************************************************************************************************\r\n// Document ready and document / window event listeners\r\n// ************************************************************************************************\r\n\r\ndocument.addEventListener('DOMContentLoaded', () =>\r\n{ \r\n  debug.log('DOMContentLoaded');\r\n\r\n  readSettings();\r\n  initIndex();\r\n  \r\n  if (mElements.introBanner !== null)\r\n    showIntroBanner();\r\n  \r\n  if (document.getElementById('termlist-container') !== null)\r\n    termlist.init();\r\n\r\n  if (mElements.siteContentSearch !== null)\r\n  {\r\n    mElements.siteContentSearch.focus();\r\n    mElements.siteContentSearch.setSelectionRange(9999, 9999);\r\n  }\r\n\r\n  setPreviousPageTitle();\r\n});\r\n\r\ndocument.addEventListener(mConfig.settingsUpdatedEvent, () =>\r\n{\r\n  readSettings();\r\n  interaction.settingsUpdated(mSettings);\r\n  storage.setCookie(storage.KEY.UF_TRACKS_PER_PAGE, mSettings.user.tracksPerPage, (60 * 60 * 24 * 365 * 5));\r\n});\r\n\r\ndocument.addEventListener(mConfig.fullscreenTrackEvent, (event) => mElements.fullscreenTarget = event.fullscreenTarget);\r\n\r\n\r\n// ************************************************************************************************\r\n// Read settings and index init\r\n// ************************************************************************************************\r\n\r\nfunction readSettings()\r\n{\r\n  debug.log('readSettings()');\r\n  mSettings = storage.readWriteSettingsProxy(storage.KEY.UF_SITE_SETTINGS, siteSettings, true);\r\n  debug.log(mSettings);\r\n}\r\n\r\nfunction initIndex()\r\n{\r\n  debug.log('initIndex()');\r\n\r\n  mElements.siteHeader        = document.getElementById('site-header');\r\n  mElements.introBanner       = document.getElementById('intro-banner');\r\n  mElements.siteContent       = document.getElementById('site-content');\r\n  mElements.siteContentSearch = document.querySelector('#site-content form input.search-field');\r\n\r\n  interaction.init(mSettings);\r\n\r\n  navSearch.init();\r\n  navMenu.init();\r\n  \r\n  resize.addEventListener();\r\n  scroll.addEventListener();\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Keyboard events handling\r\n// ************************************************************************************************\r\n\r\ndocument.addEventListener('keydown', (event) =>\r\n{\r\n  // UI keyboard events (cannot be disable by the user)\r\n  if ((event.ctrlKey === false) && (event.altKey === false))\r\n  {\r\n    switch (event.key)\r\n    {\r\n      case 'Escape':\r\n        if (navMenu.isVisible())\r\n        {\r\n          event.preventDefault();\r\n          navMenu.toggle();\r\n        }\r\n        return;\r\n    }\r\n  }\r\n\r\n  // User enabled keyboard shortcuts (on by default)\r\n  if (mSettings.user.keyboardShortcuts && (event.ctrlKey === false) && (event.altKey === false))\r\n  {\r\n    switch (event.key)\r\n    {\r\n      case 'c':\r\n      case 'C':\r\n        if (searchNotFocused())\r\n        {\r\n          event.preventDefault();\r\n          navMenu.toggle();\r\n        }\r\n        break;\r\n\r\n      case 'L':\r\n        if (searchNotFocused() && notSettingsPage())\r\n        {\r\n          interaction.trackLayout.toggle(event);\r\n          resize.trigger();\r\n        }\r\n        break;\r\n\r\n      case 's':\r\n      case 'S':\r\n        if (searchNotFocused() && notFullscreenTrack())\r\n        {\r\n          event.preventDefault();\r\n          navSearch.toggle();\r\n        }\r\n        break;\r\n\r\n      case 'T':\r\n        if (searchNotFocused() && notSettingsPage())\r\n        {\r\n          interaction.siteTheme.toggle(event);\r\n        }\r\n        break;\r\n\r\n      case 'ArrowLeft':\r\n        if (event.shiftKey && noPlayback())\r\n        {\r\n          // eslint-disable-next-line no-undef\r\n          arrowKeyNav(navigationUrls.prev);\r\n        }\r\n        break;\r\n\r\n      case 'ArrowRight':\r\n        if (event.shiftKey && noPlayback())\r\n        {\r\n          // eslint-disable-next-line no-undef\r\n          arrowKeyNav(navigationUrls.next);\r\n        }\r\n        break;\r\n    }\r\n  }\r\n});\r\n\r\nfunction searchNotFocused()\r\n{\r\n  return ((navSearch.isVisible() === false) && (mElements.siteContentSearch !== document.activeElement));\r\n}\r\n\r\nfunction notSettingsPage()\r\n{\r\n  return (document.body.classList.contains('page-settings') === false);\r\n}\r\n\r\nfunction notFullscreenTrack()\r\n{\r\n  return ((mElements.fullscreenTarget === null) ? true : false);\r\n}\r\n\r\nfunction noPlayback()\r\n{\r\n  return (document.body.classList.contains('no-playback'));\r\n}\r\n\r\nfunction arrowKeyNav(destUrl)\r\n{\r\n  if ((destUrl !== undefined) && (destUrl !== null) && (destUrl.length > 0))\r\n    window.location.href = destUrl;\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Misc. support functions\r\n// ************************************************************************************************\r\n\r\nfunction showIntroBanner()\r\n{\r\n  // Only show intro banners if they can be permanently dismissed\r\n  if (storage.isAvailable('localStorage'))\r\n  {\r\n    if ((typeof bannerProperty !== 'undefined') && (bannerProperty !== null)) // eslint-disable-line no-undef\r\n    {\r\n      if (mSettings.priv.banners[bannerProperty]) // eslint-disable-line no-undef\r\n      {\r\n        mElements.introBanner.style.display = 'block';\r\n        resize.trigger();\r\n\r\n        utils.addEventListeners('#intro-banner .intro-banner-close-button', 'click', () =>\r\n        {\r\n          mElements.introBanner.style.display    = '';\r\n          mElements.siteContent.style.marginTop  = '';\r\n          mSettings.priv.banners[bannerProperty] = false; // eslint-disable-line no-undef\r\n        });\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction setPreviousPageTitle()\r\n{\r\n  if (document.querySelector('.nav-bar-title .go-back-to') !== null)\r\n  {\r\n    let pathString = '';\r\n\r\n    if (document.referrer.length === 0)\r\n    {\r\n      pathString = 'Previous Page';\r\n    }\r\n    else\r\n    {\r\n      const referrerUrlParts = new URL(decodeURIComponent(document.referrer));\r\n\r\n      if (referrerUrlParts.search.length !== 0)\r\n      {\r\n        pathString = 'Search Results';\r\n      }\r\n      else if (referrerUrlParts.pathname.length > 1)\r\n      {\r\n        const endSlash  = (referrerUrlParts.pathname.slice(-1) === '/') ? 1 : 0;\r\n        const pathParts = referrerUrlParts.pathname.slice(1, referrerUrlParts.pathname.length - endSlash).replace(/-/gi, ' ').split('/');\r\n        pathParts.forEach((part, index) => pathString += ((index + 1) < pathParts.length) ? part + ' / ' : part);\r\n      }\r\n    }\r\n\r\n    document.querySelectorAll('#site-navigation .nav-bar-title').forEach(element =>\r\n    {\r\n      element.querySelector('.go-back-title').textContent = (pathString.length > 0) ? pathString : 'Ultrafunk (home)';\r\n      element.querySelector('.go-back-to').style.opacity  = 1;\r\n    });\r\n  }\r\n}\r\n\r\n\r\n// ************************************************************************************************\r\n// Main navigation menu handling\r\n// ************************************************************************************************\r\n\r\nconst navMenu = (() =>\r\n{\r\n  const observer  = new ResizeObserver(observerCallback);\r\n  const elements  = { navMenu: null, modalOverlay: null };\r\n  let isVisible   = false;\r\n\r\n  return {\r\n    isVisible()   { return isVisible;                    },\r\n    scrolledTop() { elements.navMenu.style.display = ''; },\r\n    init,\r\n    toggle,\r\n  };\r\n\r\n  function init()\r\n  {\r\n    elements.navMenu      = document.querySelector('#site-navigation .nav-menu-outer');\r\n    elements.modalOverlay = document.getElementById('nav-menu-modal-overlay');\r\n\r\n    utils.addEventListeners('.nav-menu-toggle', 'click', toggle);\r\n    elements.modalOverlay.addEventListener('click', toggle);\r\n    elements.modalOverlay.addEventListener('transitionend', transitionEnd);\r\n    observer.observe(elements.navMenu.querySelector('.menu-primary-menu-container'));\r\n  }\r\n\r\n  function toggle()\r\n  {\r\n    if (mElements.siteHeader.classList.contains('sticky-nav-up'))\r\n    {\r\n      isVisible ? elements.navMenu.style.display = 'none' : elements.navMenu.style.display = 'flex';\r\n    }\r\n    else\r\n    {\r\n      if (mElements.siteHeader.classList.contains('sticky-nav-down') === false)\r\n        mElements.siteHeader.classList.toggle('hide-nav-menu');\r\n    }\r\n  }\r\n\r\n  function observerCallback(entries)\r\n  {\r\n    isVisible = (entries[0].contentRect.height !== 0) ? true : false;\r\n\r\n    if (isVisible)\r\n    {\r\n      elements.modalOverlay.className = '';\r\n      elements.modalOverlay.classList.add('show');\r\n      setTimeout(() => elements.modalOverlay.classList.add('fadein'), 50);\r\n    }\r\n    else\r\n    {\r\n      elements.modalOverlay.classList.add('fadeout');\r\n    }\r\n  }\r\n\r\n  function transitionEnd()\r\n  {\r\n    if (isVisible === false)\r\n    {\r\n      elements.modalOverlay.className = '';\r\n      elements.navMenu.style.display  = '';\r\n    }\r\n  }\r\n})();\r\n\r\n\r\n// ************************************************************************************************\r\n// Main navigation search handling\r\n// ************************************************************************************************\r\n\r\nconst navSearch = (() =>\r\n{\r\n  const allowKeyboardShortcutsEvent = new Event('allowKeyboardShortcuts');\r\n  const denyKeyboardShortcutsEvent  = new Event('denyKeyboardShortcuts');\r\n  const elements = { searchContainer: null, searchField: null, brandingContainer: null };\r\n  let isVisible  = false;\r\n\r\n  return {\r\n    isVisible() { return isVisible; },\r\n    init,\r\n    toggle,\r\n    hide,\r\n  };\r\n\r\n  function init()\r\n  {\r\n    elements.searchContainer   = document.getElementById('search-container');\r\n    elements.searchField       = elements.searchContainer.querySelector('.search-field');\r\n    elements.brandingContainer = mElements.siteHeader.querySelector('div.site-branding-container');\r\n\r\n    utils.addEventListeners('.nav-search-toggle', 'click', toggle);\r\n    // To prevent extra 'blur' event before 'click' event\r\n    utils.addEventListeners('.nav-search-toggle', 'mousedown', (event) => event.preventDefault());\r\n    // Hide nav search bar on focus loss\r\n    elements.searchField.addEventListener('blur', hide);\r\n    \r\n    // Hide nav search bar on ESC\r\n    elements.searchField.addEventListener('keydown', (event) =>\r\n    {\r\n      if (event.key === 'Escape')\r\n      {\r\n        event.stopPropagation();\r\n        hide();\r\n      }\r\n    });\r\n  }\r\n\r\n  function toggle()\r\n  {\r\n    hasVisibleSearchContainer() ? show() : hide();\r\n  }\r\n  \r\n  function hide()\r\n  {\r\n    if (isVisible)\r\n      setProps(false, allowKeyboardShortcutsEvent, '', 'search');\r\n  }\r\n  \r\n  function hasVisibleSearchContainer()\r\n  {\r\n    if (elements.searchContainer.style.display.length === 0)\r\n    {\r\n      // Has no visible site header at all, bail out...\r\n      if (mElements.siteHeader.offsetHeight === 0)\r\n        return false;\r\n\r\n      // Is mobile with no visible nav-bar, bail out...\r\n      if (utils.matchesMedia(utils.MATCH.SITE_MAX_WIDTH_MOBILE))\r\n      {\r\n        if ((mElements.siteHeader.querySelector('.nav-bar-container-mobile-top').offsetHeight === 0) &&\r\n            (mElements.siteHeader.querySelector('.nav-bar-container-mobile-up').offsetHeight  === 0))\r\n        {\r\n          return false;\r\n        }\r\n      }\r\n\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  function show()\r\n  {\r\n    setPosSize();\r\n    setProps(true, denyKeyboardShortcutsEvent, 'flex', 'clear');\r\n    elements.searchField.focus();\r\n    elements.searchField.setSelectionRange(9999, 9999);    \r\n  }\r\n  \r\n  function setProps(visible, keyboardShortcutsEvent, display, icon)\r\n  {\r\n    isVisible = visible;\r\n    document.dispatchEvent(keyboardShortcutsEvent);\r\n    elements.searchContainer.style.display = display;\r\n    document.querySelectorAll('div.nav-search-toggle i').forEach(element => element.textContent = icon);\r\n    isVisible ? document.getElementById('playback-controls').classList.add('hide') : document.getElementById('playback-controls').classList.remove('hide');\r\n  }\r\n\r\n  function setPosSize()\r\n  {\r\n    let position = {};\r\n\r\n    if (utils.matchesMedia(utils.MATCH.SITE_MAX_WIDTH_MOBILE))\r\n    {\r\n      if (elements.brandingContainer.offsetHeight !== 0)\r\n        position.top = elements.brandingContainer.offsetTop;\r\n      else\r\n        position.top = mElements.siteHeader.querySelector('.nav-bar-container-mobile-up').offsetTop;\r\n\r\n      position = new DOMRect(63, (position.top + 3), (document.body.clientWidth - 63), 30);\r\n    }\r\n    else\r\n    {\r\n      if (elements.brandingContainer.offsetHeight !== 0)\r\n      {\r\n        const rect = elements.brandingContainer.getBoundingClientRect();\r\n        position   = new DOMRect(rect.left, (rect.top + 10), rect.right, (rect.height - 20));\r\n      }\r\n      else\r\n      {\r\n        const rect = mElements.siteHeader.querySelector('.nav-bar-container').getBoundingClientRect();\r\n        position   = new DOMRect((rect.left + 105), (rect.top + 2), (rect.right - 105), (rect.height - 4));\r\n      }\r\n    }\r\n  \r\n    elements.searchContainer.style.left   = `${position.left}px`;\r\n    elements.searchContainer.style.top    = `${position.top}px`;\r\n    elements.searchContainer.style.width  = `${position.width - position.left}px`;\r\n    elements.searchContainer.style.height = `${position.height}px`;\r\n  }\r\n})();\r\n\r\n\r\n// ************************************************************************************************\r\n// window.addEventListener('resize') handling\r\n// ************************************************************************************************\r\n\r\nconst resize = (() =>\r\n{\r\n  let headerHeight = 0;\r\n\r\n  return {\r\n    getHeaderHeight() { return headerHeight; },\r\n    addEventListener,\r\n    trigger: resizeEvent,\r\n  };\r\n\r\n  function addEventListener()\r\n  {\r\n    resizeEvent();\r\n    window.addEventListener('resize', resizeEvent);\r\n  }\r\n  \r\n  function resizeEvent()\r\n  {\r\n    noPlayback() ? headerHeight = utils.getCssPropValue('--site-header-height-no-playback') : headerHeight = utils.getCssPropValue('--site-header-height');\r\n\r\n    if ((mElements.introBanner !== null) && (mElements.introBanner.style.display.length !== 0))\r\n    {\r\n      mElements.introBanner.style.marginTop = `${headerHeight}px`;\r\n      mElements.siteContent.style.marginTop = `${utils.getCssPropValue('--site-content-margin-top')}px`;\r\n    }\r\n  }\r\n})();\r\n\r\n  \r\n// ************************************************************************************************\r\n// window.addEventListener('scroll') handling\r\n// ************************************************************************************************\r\n\r\nconst scroll = (() =>\r\n{\r\n  let lastScrollTop  = 0;\r\n  let isScrolledDown = false;\r\n\r\n  return {\r\n    addEventListener,\r\n  };\r\n\r\n  function addEventListener()\r\n  {\r\n    scrollEvent();\r\n    window.addEventListener('scroll', scrollEvent);\r\n  }\r\n\r\n  function scrollEvent()\r\n  {\r\n    const scrollTop          = window.pageYOffset;\r\n    const scrollDownMenuHide = Math.round((resize.getHeaderHeight() > 150) ? (resize.getHeaderHeight() / 2) : (resize.getHeaderHeight() / 3));\r\n\r\n    if (scrollTop < 1)\r\n      scrolledTop();\r\n    else if ((scrollTop > scrollDownMenuHide) && (scrollTop > lastScrollTop))\r\n      scrolledDown();\r\n    else\r\n      scrolledUp();\r\n    \r\n    // Hide navigation search form on any scroll event\r\n    navSearch.hide();\r\n  \r\n    lastScrollTop = scrollTop;\r\n  }\r\n\r\n  function scrolledTop()\r\n  {\r\n    mElements.siteHeader.classList.remove('sticky-nav-down', 'sticky-nav-up');\r\n    mElements.siteHeader.classList.add('hide-nav-menu');\r\n    navMenu.scrolledTop();\r\n  }\r\n\r\n  function scrolledDown()\r\n  {\r\n    if (isScrolledDown === false)\r\n    {\r\n      isScrolledDown = true;\r\n      utils.replaceClass(mElements.siteHeader, 'sticky-nav-up', 'sticky-nav-down');\r\n    }\r\n  }\r\n\r\n  function scrolledUp()\r\n  {\r\n    if (isScrolledDown === true)\r\n    {\r\n      isScrolledDown = false;\r\n      utils.replaceClass(mElements.siteHeader, 'sticky-nav-down', 'sticky-nav-up');\r\n    }\r\n\r\n    if (navMenu.isVisible())\r\n      navMenu.toggle();\r\n  }\r\n})();\r\n"],
  "mappings": "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",
  "names": []
}
